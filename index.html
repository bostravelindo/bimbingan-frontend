<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FEBI UINSI - Bimbingan Proposal dan Repository</title>
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><circle cx='50' cy='50' r='48' fill='%23047857'/><text x='50' y='55' text-anchor='middle' fill='%23fbbf24' font-size='24' font-weight='bold'>F</text></svg>">
<script src="https://cdn.tailwindcss.com"></script>
<script>
tailwind.config = {
theme: {
extend: {
colors: {
'febi-green': '#047857',
'febi-gold': '#fbbf24'
}
}
}
}
</script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
<!-- Firebase SDK - Load first -->
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
<!-- React - Load second -->
<script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
<!-- Babel - Load last -->
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: 'Inter', system-ui, sans-serif; background-color: #f8fafc; min-height: 100vh; }
::-webkit-scrollbar { width: 6px; }
::-webkit-scrollbar-track { background: #f1f5f9; }
::-webkit-scrollbar-thumb { background: #94a3b8; border-radius: 3px; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
@keyframes slideIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }
@keyframes spin { to { transform: rotate(360deg); } }
@keyframes float {
0% { transform: translateY(0px); }
50% { transform: translateY(-10px); }
100% { transform: translateY(0px); }
}
.animate-fadeIn { animation: fadeIn 0.3s ease-out; }
.animate-slideIn { animation: slideIn 0.2s ease-out; }
.animate-float { animation: float 3s ease-in-out infinite; }
.similarity-badge {
display: inline-block; padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 600;
}
.similarity-critical { background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%); color: #b91c1c; border: 2px solid #ef4444; }
.similarity-high { background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); color: #b45309; border: 2px solid #f59e0b; }
.similarity-medium { background: linear-gradient(135deg, #fde68a 0%, #fcd34d 100%); color: #92400e; border: 2px solid #eab308; }
.similarity-low { background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%); color: #064e3b; border: 2px solid #10b981; }
.similarity-safe { background: linear-gradient(135deg, #a7f3d0 0%, #6ee7b7 100%); color: #042f2e; border: 2px solid #14b8a6; }
.metric-card { transition: all 0.3s ease; border: 2px solid transparent; }
.metric-card:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.1); border-color: #10b981; }
.highlight-match { background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); padding: 2px 6px; border-radius: 4px; font-weight: 600; color: #92400e; }
.algorithm-badge { display: inline-block; padding: 2px 8px; border-radius: 12px; font-size: 10px; font-weight: 700; margin: 2px; }
.algo-cosine { background: #dbeafe; color: #1e40af; }
.algo-jaccard { background: #d1fae5; color: #064e3b; }
.algo-levenshtein { background: #fde68a; color: #92400e; }
.algo-semantic { background: #fca5a5; color: #991b1b; }
.loading-screen { position: fixed; inset: 0; background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 1000; }
.loading-spinner { width: 64px; height: 64px; border: 6px solid rgba(251, 191, 36, 0.2); border-top-color: #fbbf24; border-radius: 50%; animation: spin 1s linear infinite; }
.error-boundary { display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); color: white; padding: 2rem; text-align: center; }
.error-boundary h2 { font-size: 2.5rem; margin-bottom: 1rem; background: linear-gradient(to right, #fbbf24, #f59e0b); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
.error-boundary p { max-width: 600px; margin-bottom: 2rem; line-height: 1.6; }
.error-boundary button { background: #047857; color: white; border: none; padding: 12px 24px; font-size: 16px; font-weight: 600; border-radius: 12px; cursor: pointer; transition: all 0.3s; }
.error-boundary button:hover { background: #065f46; transform: scale(1.05); }
.workflow-badge { display: inline-block; padding: 3px 10px; border-radius: 12px; font-size: 11px; font-weight: 600; }
.workflow-proposal { background: #dbeafe; color: #1e40af; }
.workflow-approved { background: #bbf7d0; color: #15803d; }
.workflow-bimbingan { background: #fde68a; color: #854d0e; }
.workflow-selesai { background: #a7f3d0; color: #065f4e; }
.pending-bimbingan-card { border-left: 4px solid #f59e0b; background: linear-gradient(90deg, #fffbeb 0%, #fef3c7 100%); }
.auto-create-alert { background: linear-gradient(135deg, #bbf7d0 0%, #a7f3d0 100%); border-left: 4px solid #16a34a; }
.form-section { border-bottom: 1px solid #e2e8f0; padding-bottom: 1.5rem; margin-bottom: 1.5rem; }
.form-section:last-child { border-bottom: none; margin-bottom: 0; }
.required-star { color: #ef4444; margin-left: 2px; }
.line-clamp-2 { display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
.line-clamp-1 { display: -webkit-box; -webkit-line-clamp: 1; -webkit-box-orient: vertical; overflow: hidden; }
.bimbingan-card { transition: all 0.3s ease; border-left: 4px solid transparent; }
.bimbingan-card:hover { transform: translateY(-2px); box-shadow: 0 10px 25px -5px rgba(0,0,0,0.1); }
.bimbingan-card.berlangsung { border-left-color: #047857; }
.bimbingan-card.selesai { border-left-color: #2563eb; }
.timeline-item { position: relative; padding-left: 28px; }
.timeline-item:before { content: ''; position: absolute; left: 8px; top: 8px; width: 12px; height: 12px; border-radius: 50%; background: #047857; }
.timeline-item:after { content: ''; position: absolute; left: 13px; top: 24px; width: 2px; height: calc(100% - 16px); background: #e5e7eb; }
.timeline-item:last-child:after { display: none; }
.print-laporan { font-family: 'Times New Roman', serif; }
@media print {
.no-print { display: none; }
.print-only { display: block; }
}
.role-badge-operator { background: #fef3c7; color: #92400e; border: 2px solid #fbbf24; }
/* Timeline Pertemuan */
.meeting-timeline {
position: relative;
padding-left: 40px;
}
.meeting-timeline::before {
content: '';
position: absolute;
left: 15px;
top: 0;
bottom: 0;
width: 3px;
background: linear-gradient(to bottom, #047857, #10b981);
border-radius: 3px;
}
.meeting-item {
position: relative;
margin-bottom: 20px;
padding: 15px;
background: white;
border-radius: 12px;
box-shadow: 0 2px 8px rgba(0,0,0,0.05);
border: 1px solid #e2e8f0;
transition: all 0.3s ease;
}
.meeting-item:hover {
transform: translateX(5px);
box-shadow: 0 4px 12px rgba(4,120,87,0.1);
border-color: #047857;
}
.meeting-item::before {
content: '';
position: absolute;
left: -30px;
top: 20px;
width: 16px;
height: 16px;
border-radius: 50%;
background: #047857;
border: 3px solid white;
box-shadow: 0 0 0 2px #047857;
z-index: 1;
}
.meeting-item.completed::before {
background: #10b981;
box-shadow: 0 0 0 2px #10b981;
}
.meeting-item .meeting-number {
position: absolute;
left: -60px;
top: 16px;
font-size: 12px;
font-weight: 600;
color: #047857;
background: #f0fdf4;
padding: 2px 8px;
border-radius: 20px;
}
.progress-step {
display: inline-block;
width: 24px;
height: 24px;
border-radius: 50%;
background: #e2e8f0;
color: #64748b;
text-align: center;
line-height: 24px;
font-size: 12px;
font-weight: 600;
margin-right: 8px;
}
.progress-step.active {
background: #047857;
color: white;
}
.progress-step.completed {
background: #10b981;
color: white;
}
.progress-connector {
height: 2px;
flex: 1;
background: #e2e8f0;
margin: 0 4px;
}
.progress-connector.active {
background: #047857;
}
.progress-connector.completed {
background: #10b981;
}
/* Profile Menu */
.profile-menu {
position: absolute;
right: 0;
top: 100%;
width: 280px;
background: white;
border-radius: 12px;
box-shadow: 0 10px 40px rgba(0,0,0,0.1);
border: 1px solid #e2e8f0;
z-index: 50;
margin-top: 8px;
overflow: hidden;
}
.profile-menu-item {
padding: 12px 16px;
display: flex;
align-items: center;
gap: 12px;
transition: all 0.2s;
cursor: pointer;
}
.profile-menu-item:hover {
background: #f0fdf4;
}
.profile-menu-item:not(:last-child) {
border-bottom: 1px solid #f1f5f9;
}
/* Dual Bimbingan */
.bimbingan-dual {
display: grid;
grid-template-columns: 1fr 1fr;
gap: 16px;
}
.bimbingan-card-pembimbing1 {
border-left: 4px solid #047857;
}
.bimbingan-card-pembimbing2 {
border-left: 4px solid #f59e0b;
}
.pembimbing-badge {
display: inline-block;
padding: 2px 8px;
border-radius: 12px;
font-size: 10px;
font-weight: 600;
}
.pembimbing-badge-1 {
background: #d1fae5;
color: #047857;
}
.pembimbing-badge-2 {
background: #fef3c7;
color: #b45309;
}
/* Pagination */
.pagination {
display: flex;
gap: 5px;
margin-top: 20px;
justify-content: center;
}
.pagination button {
padding: 8px 14px;
border-radius: 8px;
background: white;
border: 1px solid #e2e8f0;
color: #4a5568;
font-weight: 500;
transition: all 0.2s;
cursor: pointer;
}
.pagination button:hover {
background: #047857;
color: white;
border-color: #047857;
}
.pagination button.active {
background: #047857;
color: white;
border-color: #047857;
}
.pagination button:disabled {
opacity: 0.5;
cursor: not-allowed;
}

/* ‚îÄ‚îÄ KALENDER AKADEMIK WIDGET ‚îÄ‚îÄ */
@keyframes tickClock {
  0%   { opacity: 1; }
  50%  { opacity: 0.4; }
  100% { opacity: 1; }
}
@keyframes countdownPulse {
  0%,100% { transform: scale(1); }
  50%      { transform: scale(1.04); }
}
@keyframes shimmer {
  0%   { background-position: -200% center; }
  100% { background-position:  200% center; }
}
@keyframes progressGrow {
  from { width: 0%; }
  to   { width: var(--target-w); }
}
.akademik-card {
  transition: all 0.3s cubic-bezier(0.4,0,0.2,1);
  border: 2px solid transparent;
}
.akademik-card:hover {
  transform: translateY(-3px);
  box-shadow: 0 12px 32px rgba(4,120,87,0.12);
  border-color: #10b981;
}
.tahapan-item {
  transition: all 0.25s ease;
  cursor: default;
}
.tahapan-item:hover {
  transform: translateX(4px);
}
.countdown-digit {
  animation: countdownPulse 1s ease-in-out infinite;
}
.clock-colon {
  animation: tickClock 1s step-start infinite;
}
.shimmer-text {
  background: linear-gradient(90deg, #047857 25%, #10b981 50%, #047857 75%);
  background-size: 200% auto;
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  animation: shimmer 3s linear infinite;
}
.progress-bar-animated {
  animation: progressGrow 1.2s ease-out forwards;
}
.tahapan-now {
  background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
  border-left: 4px solid #047857;
  box-shadow: 0 4px 12px rgba(4,120,87,0.15);
}
.tahapan-done {
  background: #f0fdf4;
  border-left: 4px solid #6ee7b7;
  opacity: 0.85;
}
.tahapan-upcoming {
  background: #fafafa;
  border-left: 4px solid #e5e7eb;
}
.tahapan-urgent {
  background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
  border-left: 4px solid #f59e0b;
  box-shadow: 0 4px 12px rgba(245,158,11,0.12);
}

/* ‚îÄ‚îÄ KALENDER AKADEMIK EDIT MODAL ‚îÄ‚îÄ */
@keyframes modalSlideUp {
  from { opacity:0; transform:translateY(24px) scale(0.97); }
  to   { opacity:1; transform:translateY(0)    scale(1); }
}
.kalender-edit-modal { animation: modalSlideUp 0.22s cubic-bezier(0.4,0,0.2,1); }
.siklus-tab { transition: all 0.2s ease; cursor: pointer; }
.siklus-tab.active { background: #047857; color: white; }
.siklus-tab:not(.active):hover { background: #f0fdf4; color: #047857; }
.tahapan-edit-row { transition: background 0.15s; }
.tahapan-edit-row:hover { background: #f0fdf4; }
.siklus-badge-1 { background: linear-gradient(135deg,#d1fae5,#a7f3d0); color:#065f46; border:1.5px solid #6ee7b7; }
.siklus-badge-2 { background: linear-gradient(135deg,#dbeafe,#bfdbfe); color:#1e3a8a; border:1.5px solid #93c5fd; }
.siklus-badge-3 { background: linear-gradient(135deg,#ede9fe,#ddd6fe); color:#3b0764; border:1.5px solid #c4b5fd; }
.siklus-header-1 { background: linear-gradient(135deg,#047857,#10b981); }
.siklus-header-2 { background: linear-gradient(135deg,#1d4ed8,#3b82f6); }
.siklus-header-3 { background: linear-gradient(135deg,#7c3aed,#a78bfa); }
.kalender-save-btn { transition: all 0.2s; }
.kalender-save-btn:hover { transform: translateY(-1px); box-shadow: 0 6px 20px rgba(4,120,87,0.3); }
</style>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
// ============================================
// ERROR BOUNDARY COMPONENT
// ============================================
class ErrorBoundary extends React.Component {
constructor(props) {
super(props);
this.state = { hasError: false, error: null, errorInfo: null };
}
static getDerivedStateFromError(error) {
return { hasError: true };
}
componentDidCatch(error, errorInfo) {
console.error('React Error:', error);
console.error('Component Stack:', errorInfo.componentStack);
this.setState({
hasError: true,
error: error,
errorInfo: errorInfo
});
}
render() {
if (this.state.hasError) {
return (
<div className="error-boundary">
<h2>‚ö†Ô∏è Terjadi Kesalahan Sistem</h2>
<p>Dashboard tidak dapat dimuat karena error kritis.</p>
<p className="text-sm bg-gray-800/50 p-4 rounded-lg max-w-2xl mx-auto mt-4 text-left text-gray-300 overflow-auto max-h-48">
{this.state.error?.toString()}
</p>
<button onClick={() => window.location.reload()}>
üîÑ Muat Ulang Halaman
</button>
<p className="mt-8 text-gray-400 text-sm">
Error ID: {Date.now().toString(36)}
</p>
</div>
);
}
return this.props.children;
}
}
// ============================================
// FIREBASE CONFIGURATION
// ============================================
const firebaseConfig = {
apiKey: "AIzaSyA2khO5iAvYU5msppJlMjwi9S7kL0LAxaU",
authDomain: "febi-uinsi-dashboard-ca039.firebaseapp.com",
databaseURL: "https://febi-uinsi-dashboard-ca039-default-rtdb.asia-southeast1.firebasedatabase.app",
projectId: "febi-uinsi-dashboard-ca039",
storageBucket: "febi-uinsi-dashboard-ca039.firebasestorage.app",
messagingSenderId: "297923141085",
appId: "1:297923141085:web:1307d98d3518fd61126a34"
};
let db = null;
try {
if (!firebase.apps.length) {
firebase.initializeApp(firebaseConfig);
}
db = firebase.database();
console.log('‚úÖ Firebase initialized successfully');
} catch (error) {
console.error('‚ùå Firebase initialization error:', error);
}
// ============================================
// DATABASE HELPER FUNCTIONS
// ============================================
const DB = {
get: (path) => {
return new Promise((resolve) => {
if (!db) {
console.error('Database not initialized');
resolve(null);
return;
}
db.ref(path).once('value')
.then(snapshot => resolve(snapshot.val()))
.catch(e => {
console.error('‚ùå DB get error:', e);
resolve(null);
});
});
},
set: async (path, data) => {
if (!db) return false;
try {
await db.ref(path).set(data);
console.log('‚úÖ Data saved successfully:', path);
return true;
} catch (e) {
console.error('‚ùå DB set error:', e);
return false;
}
},
push: async (path, data) => {
if (!db) return null;
try {
const newRef = await db.ref(path).push(data);
console.log('‚úÖ Data pushed successfully:', newRef.key);
return newRef.key;
} catch (e) {
console.error('‚ùå DB push error:', e);
return null;
}
},
remove: async (path) => {
if (!db) return false;
try {
await db.ref(path).remove();
console.log('‚úÖ Data removed successfully:', path);
return true;
} catch (e) {
console.error('‚ùå DB remove error:', e);
return false;
}
},
listen: (path, callback) => {
if (!db) return () => {};
const ref = db.ref(path);
ref.on('value', snapshot => callback(snapshot.val()));
return () => ref.off('value');
}
};
// ============================================
// LOGO COMPONENT
// ============================================
const Logo = ({ size = 'md', showText = true }) => {
const sizes = {
sm: 'w-16 h-16 text-xl',
md: 'w-24 h-24 text-2xl',
lg: 'w-32 h-32 text-3xl'
};
return (
<div className="flex flex-col items-center">
<div className={`${sizes[size]} bg-gradient-to-br from-emerald-600 to-teal-700 rounded-2xl flex items-center justify-center text-white font-black shadow-lg mb-3`}>
<span className="text-4xl">üéì</span>
</div>
{showText && (
<div className="text-center">
<div className="text-2xl font-bold text-emerald-900">FEBI</div>
<div className="text-sm text-emerald-700 tracking-wider">FACULTY OF ISLAMIC ECONOMICS AND BUSINESS</div>
<div className="text-xs text-emerald-600 mt-1">UINSI SAMARINDA</div>
</div>
)}
</div>
);
};
// ============================================
// ADVANCED SIMILARITY CHECKER - ACADEMIC VALIDATION
// ============================================
class AcademicSimilarityChecker {
constructor() {
this.stopwords = new Set([
'yang', 'adalah', 'ini', 'itu', 'sebagai', 'oleh', 'dalam', 'melalui',
'antara', 'terkait', 'mengenai', 'tentang', 'atas', 'bawah', 'dalam',
'studi', 'analisis', 'penelitian', 'kajian', 'implementasi', 'pengaruh',
'hubungan', 'peran', 'fungsi', 'strategi', 'model', 'sistem', 'metode',
'dan', 'atau', 'dengan', 'terhadap', 'pada', 'di', 'ke', 'dari', 'untuk'
]);
this.thresholds = {
critical: 85,
high: 70,
medium: 50,
low: 30
};
}
preprocess(text) {
if (!text || typeof text !== 'string') return '';
return text
.toLowerCase()
.normalize('NFD').replace(/[\u0300-\u036f]/g, '')
.replace(/[^\w\s]/g, ' ')
.replace(/\s+/g, ' ')
.trim()
.split(' ')
.filter(word => word.length > 2 && !this.stopwords.has(word))
.join(' ');
}
tokenizeToNgrams(text, n = 2) {
const tokens = this.preprocess(text).split(' ').filter(t => t);
if (tokens.length < n) return tokens;
const ngrams = [];
for (let i = 0; i <= tokens.length - n; i++) {
ngrams.push(tokens.slice(i, i + n).join(' '));
}
return ngrams;
}
cosineSimilarity(text1, text2) {
const tokens1 = this.preprocess(text1).split(' ').filter(t => t);
const tokens2 = this.preprocess(text2).split(' ').filter(t => t);
if (tokens1.length === 0 || tokens2.length === 0) return 0;
const vocab = new Set([...tokens1, ...tokens2]);
const vocabArray = Array.from(vocab);
const vec1 = vocabArray.map(term => tokens1.filter(t => t === term).length / tokens1.length);
const vec2 = vocabArray.map(term => tokens2.filter(t => t === term).length / tokens2.length);
const dotProduct = vec1.reduce((sum, val, i) => sum + val * vec2[i], 0);
const magnitude1 = Math.sqrt(vec1.reduce((sum, val) => sum + val * val, 0));
const magnitude2 = Math.sqrt(vec2.reduce((sum, val) => sum + val * val, 0));
return magnitude1 && magnitude2 ? (dotProduct / (magnitude1 * magnitude2)) * 100 : 0;
}
jaccardSimilarity(text1, text2, n = 2) {
const ngrams1 = new Set(this.tokenizeToNgrams(text1, n));
const ngrams2 = new Set(this.tokenizeToNgrams(text2, n));
if (ngrams1.size === 0 && ngrams2.size === 0) return 100;
if (ngrams1.size === 0 || ngrams2.size === 0) return 0;
const intersection = new Set([...ngrams1].filter(x => ngrams2.has(x)));
const union = new Set([...ngrams1, ...ngrams2]);
return (intersection.size / union.size) * 100;
}
levenshteinSimilarity(text1, text2) {
const s1 = this.preprocess(text1);
const s2 = this.preprocess(text2);
if (!s1 || !s2) return 0;
const len1 = s1.length;
const len2 = s2.length;
if (s1 === s2) return 100;
const matrix = Array(len2 + 1).fill(null).map(() => Array(len1 + 1).fill(0));
for (let i = 0; i <= len1; i++) matrix[0][i] = i;
for (let j = 0; j <= len2; j++) matrix[j][0] = j;
for (let j = 1; j <= len2; j++) {
for (let i = 1; i <= len1; i++) {
const cost = s1[i - 1] === s2[j - 1] ? 0 : 1;
matrix[j][i] = Math.min(
matrix[j - 1][i] + 1,
matrix[j][i - 1] + 1,
matrix[j - 1][i - 1] + cost
);
}
}
const distance = matrix[len2][len1];
const maxLength = Math.max(len1, len2);
return maxLength ? ((maxLength - distance) / maxLength) * 100 : 0;
}
semanticKeywordMatch(text1, text2) {
const tokens1 = this.preprocess(text1).split(' ').filter(t => t.length > 3);
const tokens2 = this.preprocess(text2).split(' ').filter(t => t.length > 3);
if (tokens1.length === 0 || tokens2.length === 0) return 0;
const weightedMatch = tokens1.reduce((score, token, idx) => {
const weight = 1 + (0.5 * (1 - idx / Math.max(tokens1.length, 1)));
return score + (tokens2.includes(token) ? weight : 0);
}, 0);
const maxPossible = tokens1.reduce((sum, _, idx) =>
sum + (1 + (0.5 * (1 - idx / Math.max(tokens1.length, 1)))), 0
);
return (weightedMatch / maxPossible) * 100;
}
calculateHybridSimilarity(newTitle, existingTitle) {
if (!newTitle || !existingTitle) return { score: 0, details: {} };
const cosine = this.cosineSimilarity(newTitle, existingTitle);
const jaccardBigram = this.jaccardSimilarity(newTitle, existingTitle, 2);
const jaccardTrigram = this.jaccardSimilarity(newTitle, existingTitle, 3);
const levenshtein = this.levenshteinSimilarity(newTitle, existingTitle);
const semantic = this.semanticKeywordMatch(newTitle, existingTitle);
const weightedScore = (
cosine * 0.30 +
jaccardBigram * 0.25 +
jaccardTrigram * 0.20 +
levenshtein * 0.15 +
semantic * 0.10
);
return {
score: Math.min(100, Math.max(0, weightedScore.toFixed(1))),
details: {
cosine: cosine.toFixed(1),
jaccardBigram: jaccardBigram.toFixed(1),
jaccardTrigram: jaccardTrigram.toFixed(1),
levenshtein: levenshtein.toFixed(1),
semantic: semantic.toFixed(1),
preprocessedNew: this.preprocess(newTitle),
preprocessedExisting: this.preprocess(existingTitle)
}
};
}
checkAgainstDatabase(newTitle, existingProposals = {}, existingRepository = {}) {
if (!newTitle || newTitle.trim().length < 10) {
return {
status: 'error',
message: 'Judul terlalu pendek (< 10 karakter)',
results: [],
recommendation: 'Perluas judul penelitian dengan variabel dan konteks yang jelas'
};
}
const results = [];
const checker = this;
Object.entries(existingProposals).forEach(([id, proposal]) => {
if (!proposal.judul || proposal.status === 'Ditolak') return;
const similarity = checker.calculateHybridSimilarity(newTitle, proposal.judul);
if (similarity.score >= checker.thresholds.low) {
results.push({
id,
type: 'proposal',
title: proposal.judul,
author: proposal.mahasiswaNama,
prodi: proposal.prodi,
pembimbing1: proposal.pembimbing1,
pembimbing2: proposal.pembimbing2 || '-',
tahun: proposal.tahun || new Date().getFullYear(),
similarityScore: parseFloat(similarity.score),
similarityDetails: similarity.details,
riskLevel: this.getRiskLevel(similarity.score)
});
}
});
Object.entries(existingRepository).forEach(([id, repo]) => {
if (!repo.judul) return;
const similarity = checker.calculateHybridSimilarity(newTitle, repo.judul);
if (similarity.score >= checker.thresholds.low) {
results.push({
id,
type: 'repository',
title: repo.judul,
author: repo.penulis,
prodi: repo.prodi,
pembimbing1: repo.pembimbing,
pembimbing2: '-',
tahun: repo.tahun,
similarityScore: parseFloat(similarity.score),
similarityDetails: similarity.details,
riskLevel: this.getRiskLevel(similarity.score)
});
}
});
results.sort((a, b) => b.similarityScore - a.similarityScore);
const highest = results[0];
let status = 'Diterima';
let recommendation = '‚úÖ Judul unik dan dapat diajukan';
if (highest) {
if (highest.similarityScore >= this.thresholds.critical) {
status = 'Ditolak';
recommendation = `‚ùå TINGKAT KEMIRIPAN KRITIS (${highest.similarityScore}%) - Judul terlalu mirip dengan karya existing. Lakukan reformulasi total.`;
} else if (highest.similarityScore >= this.thresholds.high) {
status = 'Diperbaiki';
recommendation = `‚ö†Ô∏è TINGKAT KEMIRIPAN TINGGI (${highest.similarityScore}%) - Perlu modifikasi signifikan pada variabel.`;
} else if (highest.similarityScore >= this.thresholds.medium) {
status = 'Diperbaiki';
recommendation = `‚ÑπÔ∏è TINGKAT KEMIRIPAN SEDANG (${highest.similarityScore}%) - Disarankan modifikasi frasa kunci.`;
}
}
return {
status,
highestSimilarity: highest ? highest.similarityScore : 0,
totalMatches: results.length,
results: results.slice(0, 5),
recommendation,
thresholds: this.thresholds
};
}
getRiskLevel(score) {
if (score >= this.thresholds.critical) return 'critical';
if (score >= this.thresholds.high) return 'high';
if (score >= this.thresholds.medium) return 'medium';
if (score >= this.thresholds.low) return 'low';
return 'minimal';
}
highlightMatchingTerms(newTitle, existingTitle) {
const prepNew = this.preprocess(newTitle).split(' ');
const prepExist = this.preprocess(existingTitle).split(' ');
const highlightedNew = prepNew.map(word =>
prepExist.includes(word)
? `<span class="highlight-match">${word}</span>`
: word
).join(' ');
return { new: highlightedNew };
}
}
const similarityChecker = new AcademicSimilarityChecker();
const checkProposalSimilarityAdvanced = (newTitle, existingProposals, existingRepository) => {
return similarityChecker.checkAgainstDatabase(newTitle, existingProposals, existingRepository);
};
// ============================================
// CRITICAL FIX: AUTO-CREATE BIMBINGAN ON APPROVAL (UNTUK PEMBIMBING 1 DAN 2)
// ============================================
const createBimbinganFromProposal = async (proposalData, proposalId) => {
const bimbinganSnapshot = await DB.get('bimbingan');
const results = [];

// Buat bimbingan untuk pembimbing 1
const existing1 = Object.values(bimbinganSnapshot || {}).find(b =>
b.nim === proposalData.nim && b.judul === proposalData.judul && b.dosenNama === proposalData.pembimbing1
);

if (!existing1 && proposalData.pembimbing1) {
const bimbinganData1 = {
nim: proposalData.nim,
mahasiswaNama: proposalData.mahasiswaNama,
dosenNama: proposalData.pembimbing1,
pembimbingKe: 1,
judul: proposalData.judul,
prodi: proposalData.prodi,
whatsapp: proposalData.whatsapp,
progress: 0,
status: 'berlangsung',
catatan: `‚úÖ Proposal disetujui pada ${new Date().toLocaleDateString('id-ID')}. Bimbingan dengan Pembimbing 1 dimulai oleh sistem.`,
lastUpdate: new Date().toISOString().split('T')[0],
proposalId: proposalId,
createdAt: new Date().toISOString(),
meetings: []
};
const newId1 = await DB.push('bimbingan', bimbinganData1);
if (newId1) results.push(newId1);
}

// Buat bimbingan untuk pembimbing 2 (jika ada)
if (proposalData.pembimbing2 && proposalData.pembimbing2 !== '-') {
const existing2 = Object.values(bimbinganSnapshot || {}).find(b =>
b.nim === proposalData.nim && b.judul === proposalData.judul && b.dosenNama === proposalData.pembimbing2
);

if (!existing2) {
const bimbinganData2 = {
nim: proposalData.nim,
mahasiswaNama: proposalData.mahasiswaNama,
dosenNama: proposalData.pembimbing2,
pembimbingKe: 2,
judul: proposalData.judul,
prodi: proposalData.prodi,
whatsapp: proposalData.whatsapp,
progress: 0,
status: 'berlangsung',
catatan: `‚úÖ Proposal disetujui pada ${new Date().toLocaleDateString('id-ID')}. Bimbingan dengan Pembimbing 2 dimulai oleh sistem.`,
lastUpdate: new Date().toISOString().split('T')[0],
proposalId: proposalId,
createdAt: new Date().toISOString(),
meetings: []
};
const newId2 = await DB.push('bimbingan', bimbinganData2);
if (newId2) results.push(newId2);
}
}

if (results.length > 0) {
console.log('‚úÖ Bimbingan records created automatically:', results);
return true;
}
return false;
};
// ============================================
// AUTH MODAL COMPONENT - DENGAN ROLE OPERATOR (TIDAK MUNCUL DI REGISTRASI)
// ============================================
const AuthModal = ({ onLogin, onClose, showRegister }) => {
const [isRegister, setIsRegister] = React.useState(showRegister || false);
const [formData, setFormData] = React.useState({
role: 'mahasiswa', nim: '', nama: '', prodi: '', nip: '', keahlian: '', whatsapp: '', password: ''
});
const [loginData, setLoginData] = React.useState({ username: '', password: '' });
const [isLoading, setIsLoading] = React.useState(false);
const [error, setError] = React.useState('');
const [showLoginForm, setShowLoginForm] = React.useState(false);

const handleLogin = async (e) => {
e.preventDefault(); setIsLoading(true); setError('');
const { username, password } = loginData;
try {
// Cek login admin default
if (username === 'admin' && password === 'admin123') {
onLogin({ id: 'admin', nama: 'Administrator FEBI', role: 'admin' }, 'admin');
return;
}

// Cek login operator default
if (username === 'operator' && password === 'operator123') {
onLogin({ 
id: 'operator-default', 
nama: 'Operator FEBI', 
role: 'operator',
username: 'operator'
}, 'operator');
return;
}

// Cek data operator yang tersimpan di database (selain default)
const operatorData = await DB.get('operator');
if (operatorData) {
const op = Object.entries(operatorData).find(([_, o]) => o.username === username && o.password === password);
if (op) {
onLogin({ id: op[0], ...op[1] }, 'operator');
return;
}
}

// Cek data mahasiswa
const mahasiswaData = await DB.get('mahasiswa');
if (mahasiswaData) {
const mhs = Object.entries(mahasiswaData).find(([_, m]) => m.nim === username && m.password === password);
if (mhs) {
onLogin({ id: mhs[0], ...mhs[1] }, 'mahasiswa');
return;
}
}

// Cek data dosen
const dosenData = await DB.get('dosen');
if (dosenData) {
const dsn = Object.entries(dosenData).find(([_, d]) => d.nip === username && d.password === password);
if (dsn) {
onLogin({ id: dsn[0], ...dsn[1] }, 'dosen');
return;
}
}

setError('Username atau password salah!');
} catch (err) {
setError('Terjadi kesalahan: ' + err.message);
} finally {
setIsLoading(false);
}
};

const handleRegister = async (e) => {
e.preventDefault(); setIsLoading(true); setError('');
try {
let success;
if (formData.role === 'mahasiswa') {
success = await DB.push('mahasiswa', {
nim: formData.nim, nama: formData.nama, prodi: formData.prodi,
whatsapp: formData.whatsapp, password: formData.password,
semester: parseInt(formData.nim.substring(0, 2)) || 1, status: 'aktif'
});
} else if (formData.role === 'dosen') {
success = await DB.push('dosen', {
nip: formData.nip, nama: formData.nama, keahlian: formData.keahlian,
whatsapp: formData.whatsapp, password: formData.password, status: 'aktif'
});
}
// Operator tidak bisa registrasi mandiri, hanya bisa ditambah oleh admin
if (success) {
alert('Registrasi berhasil! Silakan login.');
setIsRegister(false);
setFormData({ role: 'mahasiswa', nim: '', nama: '', prodi: '', nip: '', keahlian: '', whatsapp: '', password: '' });
} else {
setError('Gagal registrasi!');
}
} catch (err) {
setError('Error: ' + err.message);
} finally {
setIsLoading(false);
}
};

// Jika belum memilih untuk login, tampilkan halaman selamat datang dengan logo
if (!showLoginForm && !isRegister) {
return (
<div className="fixed inset-0 bg-gradient-to-br from-emerald-50 via-white to-teal-50 flex items-center justify-center z-50 p-4">
<div className="max-w-md w-full">
<div className="bg-white/80 backdrop-blur-lg rounded-3xl shadow-2xl p-8 border border-emerald-100">
<div className="animate-float">
<Logo size="lg" showText={true} />
</div>
<h1 className="text-3xl font-bold text-center text-emerald-900 mt-6 mb-2">
BIMBINGAN PROPOSAL DAN REPOSITORY
</h1>

<div className="space-y-4">
<button
onClick={() => setShowLoginForm(true)}
className="w-full px-6 py-4 bg-gradient-to-r from-emerald-600 to-teal-600 text-white rounded-xl font-semibold hover:from-emerald-700 hover:to-teal-700 transition-all transform hover:scale-105 shadow-lg"
>
<span className="text-xl">üîê</span> Masuk ke Dashboard
</button>
<button
onClick={() => setIsRegister(true)}
className="w-full px-6 py-4 bg-white text-emerald-700 border-2 border-emerald-200 rounded-xl font-semibold hover:bg-emerald-50 transition-all transform hover:scale-105"
>
<span className="text-xl">üìù</span> Daftar Akun Baru (Mahasiswa/Dosen)
</button>
</div>
<div className="mt-8 text-center">
<p className="text-xs text-emerald-400">
Sistem Terintegrasi ‚Ä¢ Bimbingan Skripsi ‚Ä¢ Repository Digital
</p>
</div>
</div>
</div>
</div>
);
}

if (isRegister) {
return (
<div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 overflow-y-auto" onClick={onClose}>
<div className="bg-white rounded-2xl p-6 max-w-md w-full my-8" onClick={(e) => e.stopPropagation()}>
<div className="flex items-center gap-3 mb-6">
<div className="w-12 h-12 bg-gradient-to-br from-emerald-600 to-teal-700 rounded-xl flex items-center justify-center text-white font-bold text-xl">
üéì
</div>
<h2 className="text-2xl font-bold text-emerald-900">Registrasi Akun</h2>
</div>
{error && <div className="bg-red-50 border-2 border-red-200 rounded-xl p-3 text-red-700 text-sm mb-4">{error}</div>}
<select value={formData.role} onChange={(e) => setFormData({...formData, role: e.target.value})} className="w-full px-4 py-2 border-2 border-emerald-200 rounded-xl mb-4">
<option value="mahasiswa">Mahasiswa</option>
<option value="dosen">Dosen</option>
</select>
{formData.role === 'mahasiswa' ? (
<>
<input type="text" placeholder="NIM (2 digit pertama tahun angkatan)" value={formData.nim} onChange={(e) => setFormData({...formData, nim: e.target.value})} className="w-full px-4 py-2 border-2 border-emerald-200 rounded-xl mb-3" required />
<input type="text" placeholder="Nama Lengkap" value={formData.nama} onChange={(e) => setFormData({...formData, nama: e.target.value})} className="w-full px-4 py-2 border-2 border-emerald-200 rounded-xl mb-3" required />
<select value={formData.prodi} onChange={(e) => setFormData({...formData, prodi: e.target.value})} className="w-full px-4 py-2 border-2 border-emerald-200 rounded-xl mb-3" required>
<option value="">Pilih Program Studi</option>
<option value="Ekonomi Syariah">Ekonomi Syariah</option>
<option value="Perbankan Syariah">Perbankan Syariah</option>
<option value="Manajemen Bisnis Syariah">Manajemen Bisnis Syariah</option>
</select>
<input type="tel" placeholder="Nomor WhatsApp" value={formData.whatsapp} onChange={(e) => setFormData({...formData, whatsapp: e.target.value})} className="w-full px-4 py-2 border-2 border-emerald-200 rounded-xl mb-3" required />
<input type="password" placeholder="Password" value={formData.password} onChange={(e) => setFormData({...formData, password: e.target.value})} className="w-full px-4 py-2 border-2 border-emerald-200 rounded-xl mb-3" required />
</>
) : (
<>
<input type="text" placeholder="NIP" value={formData.nip} onChange={(e) => setFormData({...formData, nip: e.target.value})} className="w-full px-4 py-2 border-2 border-emerald-200 rounded-xl mb-3" required />
<input type="text" placeholder="Nama Lengkap" value={formData.nama} onChange={(e) => setFormData({...formData, nama: e.target.value})} className="w-full px-4 py-2 border-2 border-emerald-200 rounded-xl mb-3" required />
<input type="text" placeholder="Bidang Keahlian" value={formData.keahlian} onChange={(e) => setFormData({...formData, keahlian: e.target.value})} className="w-full px-4 py-2 border-2 border-emerald-200 rounded-xl mb-3" required />
<input type="tel" placeholder="Nomor WhatsApp" value={formData.whatsapp} onChange={(e) => setFormData({...formData, whatsapp: e.target.value})} className="w-full px-4 py-2 border-2 border-emerald-200 rounded-xl mb-3" required />
<input type="password" placeholder="Password" value={formData.password} onChange={(e) => setFormData({...formData, password: e.target.value})} className="w-full px-4 py-2 border-2 border-emerald-200 rounded-xl mb-3" required />
</>
)}
<div className="flex gap-3 mt-4">
<button type="submit" disabled={isLoading} onClick={handleRegister} className="flex-1 px-6 py-3 bg-emerald-600 text-white rounded-xl font-semibold hover:bg-emerald-700 disabled:opacity-50">
{isLoading ? 'üîÑ Memproses...' : '‚úÖ Daftar'}
</button>
<button onClick={() => setIsRegister(false)} className="px-6 py-3 bg-gray-200 text-gray-700 rounded-xl font-semibold hover:bg-gray-300">
Batal
</button>
</div>
</div>
</div>
);
}

return (
<div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4" onClick={onClose}>
<div className="bg-white rounded-2xl p-6 max-w-md w-full" onClick={(e) => e.stopPropagation()}>
<div className="flex items-center gap-3 mb-6">
<div className="w-12 h-12 bg-gradient-to-br from-emerald-600 to-teal-700 rounded-xl flex items-center justify-center text-white font-bold text-xl">
üéì
</div>
<h3 className="text-2xl font-bold text-emerald-900">Masuk ke Dashboard</h3>
</div>
{error && <div className="bg-red-50 border-2 border-red-200 rounded-xl p-3 text-red-700 text-sm mb-4">{error}</div>}
<form onSubmit={handleLogin} className="space-y-4">
<input type="text" placeholder="NIM / NIP / Username" value={loginData.username} onChange={(e) => setLoginData({ ...loginData, username: e.target.value })} className="w-full px-4 py-3 border-2 border-emerald-200 rounded-xl focus:outline-none focus:border-emerald-500" required />
<input type="password" placeholder="Password" value={loginData.password} onChange={(e) => setLoginData({ ...loginData, password: e.target.value })} className="w-full px-4 py-3 border-2 border-emerald-200 rounded-xl focus:outline-none focus:border-emerald-500" required />
<button type="submit" disabled={isLoading} className="w-full bg-gradient-to-r from-emerald-600 to-teal-600 text-white py-3 rounded-xl font-bold hover:from-emerald-700 hover:to-teal-700 disabled:opacity-50">
{isLoading ? 'üîÑ Memproses...' : 'üîê Login'}
</button>
</form>
<div className="mt-4 text-center">
<button onClick={() => { setShowLoginForm(false); setIsRegister(false); }} className="text-sm text-emerald-700 hover:text-emerald-900">
‚Üê Kembali ke Beranda
</button>
</div>
<div className="mt-4 text-xs text-gray-400 text-center">

</div>
</div>
</div>
);
};
// ============================================
// PROFILE MODAL COMPONENT - UNTUK EDIT PROFIL
// ============================================
const ProfileModal = ({ user, userRole, onClose, onSave }) => {
const [formData, setFormData] = React.useState(user || {});
const [isSaving, setIsSaving] = React.useState(false);
const [showPassword, setShowPassword] = React.useState(false);

const handleSubmit = async (e) => {
e.preventDefault();
setIsSaving(true);
try {
await onSave(formData);
} finally {
setIsSaving(false);
}
};

return (
<div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4" onClick={onClose}>
<div className="bg-white rounded-2xl p-6 max-w-lg w-full" onClick={(e) => e.stopPropagation()}>
<h2 className="text-2xl font-bold text-emerald-900 mb-4 flex items-center gap-2">
<span className="text-3xl">üë§</span> Edit Profil
</h2>
<form onSubmit={handleSubmit}>
<div className="space-y-4">
{/* Informasi Dasar */}
<div className="bg-emerald-50 p-4 rounded-lg">
<p className="text-sm font-semibold text-emerald-800 mb-2">Informasi Akun</p>
<div className="grid grid-cols-2 gap-3">
<div>
<label className="block text-xs text-gray-600 mb-1">Role</label>
<input type="text" value={userRole} disabled className="w-full px-3 py-2 bg-white border border-gray-200 rounded-lg text-sm" />
</div>
<div>
<label className="block text-xs text-gray-600 mb-1">ID</label>
<input type="text" value={user.id} disabled className="w-full px-3 py-2 bg-white border border-gray-200 rounded-lg text-sm" />
</div>
</div>
</div>

{/* Field berdasarkan role */}
{userRole === 'mahasiswa' && (
<>
<div>
<label className="block text-sm font-semibold text-gray-700 mb-1">NIM</label>
<input
type="text"
value={formData.nim || ''}
onChange={(e) => setFormData({...formData, nim: e.target.value})}
className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500"
required
/>
</div>
<div>
<label className="block text-sm font-semibold text-gray-700 mb-1">Nama Lengkap</label>
<input
type="text"
value={formData.nama || ''}
onChange={(e) => setFormData({...formData, nama: e.target.value})}
className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500"
required
/>
</div>
<div>
<label className="block text-sm font-semibold text-gray-700 mb-1">Program Studi</label>
<select
value={formData.prodi || ''}
onChange={(e) => setFormData({...formData, prodi: e.target.value})}
className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500"
required
>
<option value="">Pilih Program Studi</option>
<option value="Ekonomi Syariah">Ekonomi Syariah</option>
<option value="Perbankan Syariah">Perbankan Syariah</option>
<option value="Manajemen Bisnis Syariah">Manajemen Bisnis Syariah</option>
</select>
</div>
<div>
<label className="block text-sm font-semibold text-gray-700 mb-1">WhatsApp</label>
<input
type="tel"
value={formData.whatsapp || ''}
onChange={(e) => setFormData({...formData, whatsapp: e.target.value})}
className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500"
required
/>
</div>
</>
)}

{userRole === 'dosen' && (
<>
<div>
<label className="block text-sm font-semibold text-gray-700 mb-1">NIP</label>
<input
type="text"
value={formData.nip || ''}
onChange={(e) => setFormData({...formData, nip: e.target.value})}
className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500"
required
/>
</div>
<div>
<label className="block text-sm font-semibold text-gray-700 mb-1">Nama Lengkap</label>
<input
type="text"
value={formData.nama || ''}
onChange={(e) => setFormData({...formData, nama: e.target.value})}
className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500"
required
/>
</div>
<div>
<label className="block text-sm font-semibold text-gray-700 mb-1">Bidang Keahlian</label>
<input
type="text"
value={formData.keahlian || ''}
onChange={(e) => setFormData({...formData, keahlian: e.target.value})}
className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500"
required
/>
</div>
<div>
<label className="block text-sm font-semibold text-gray-700 mb-1">WhatsApp</label>
<input
type="tel"
value={formData.whatsapp || ''}
onChange={(e) => setFormData({...formData, whatsapp: e.target.value})}
className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500"
required
/>
</div>
</>
)}

{userRole === 'operator' && (
<>
<div>
<label className="block text-sm font-semibold text-gray-700 mb-1">Username</label>
<input
type="text"
value={formData.username || ''}
onChange={(e) => setFormData({...formData, username: e.target.value})}
className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500"
required
/>
</div>
<div>
<label className="block text-sm font-semibold text-gray-700 mb-1">Nama Lengkap</label>
<input
type="text"
value={formData.nama || ''}
onChange={(e) => setFormData({...formData, nama: e.target.value})}
className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500"
required
/>
</div>
<div>
<label className="block text-sm font-semibold text-gray-700 mb-1">WhatsApp</label>
<input
type="tel"
value={formData.whatsapp || ''}
onChange={(e) => setFormData({...formData, whatsapp: e.target.value})}
className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500"
/>
</div>
</>
)}

{/* Password Field - Selalu tampil untuk semua role */}
<div className="border-t pt-4 mt-2">
<label className="block text-sm font-semibold text-gray-700 mb-1">Password</label>
<div className="relative">
<input
type={showPassword ? 'text' : 'password'}
value={formData.password || ''}
onChange={(e) => setFormData({...formData, password: e.target.value})}
className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 pr-10"
placeholder="Kosongkan jika tidak ingin mengubah"
/>
<button
type="button"
onClick={() => setShowPassword(!showPassword)}
className="absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-emerald-600"
>
{showPassword ? 'üëÅÔ∏è' : 'üëÅÔ∏è‚Äçüó®Ô∏è'}
</button>
</div>
<p className="text-xs text-gray-500 mt-1">Kosongkan jika tidak ingin mengubah password</p>
</div>

{/* Info untuk admin */}
{userRole === 'admin' && (
<div className="bg-yellow-50 p-3 rounded-lg">
<p className="text-xs text-yellow-700 flex items-start gap-2">
<span>‚ÑπÔ∏è</span>
<span>Anda adalah administrator. Password dapat diubah melalui form ini.</span>
</p>
</div>
)}
</div>

<div className="flex gap-3 mt-6">
<button
type="submit"
disabled={isSaving}
className="flex-1 px-6 py-3 bg-emerald-600 text-white rounded-xl font-semibold hover:bg-emerald-700 disabled:opacity-50"
>
{isSaving ? 'Menyimpan...' : 'üíæ Simpan Perubahan'}
</button>
<button
type="button"
onClick={onClose}
className="px-6 py-3 bg-gray-200 text-gray-700 rounded-xl font-semibold hover:bg-gray-300"
>
Batal
</button>
</div>
</form>
</div>
</div>
);
};
// ============================================
// PAGE COMPONENTS - DIPERBAIKI DENGAN DATA DUMMY UNTUK TESTING
// ============================================
// Data dummy untuk testing - akan ditimpa oleh data real dari Firebase
const dummyProposals = [
{
id: "proposal1",
judul: "Pengaruh Literasi Keuangan Syariah terhadap Minat Menabung di Bank Syariah",
mahasiswaNama: "Ahmad Fauzi",
nim: "210401001",
prodi: "Ekonomi Syariah",
pembimbing1: "Dr. Hj. Siti Aminah, M.Ag",
pembimbing2: "Dr. Ahmad Rizal, M.Si",
whatsapp: "081234567890",
abstrak: "Penelitian ini bertujuan untuk menganalisis pengaruh literasi keuangan syariah terhadap minat menabung mahasiswa di bank syariah. Metode penelitian menggunakan pendekatan kuantitatif dengan sampel 100 responden.",
status: "Menunggu",
tahun: "2025",
catatan: "",
tanggalPengajuan: "2026-02-15"
},
{
id: "proposal2",
judul: "Analisis Strategi Pemasaran Produk Perbankan Syariah di Era Digital",
mahasiswaNama: "Budi Santoso",
nim: "210401002",
prodi: "Perbankan Syariah",
pembimbing1: "Dr. Muhammad Iqbal, M.Ec",
pembimbing2: "Dr. Siti Khadijah, M.Si",
whatsapp: "081234567891",
abstrak: "Penelitian ini menganalisis strategi pemasaran produk perbankan syariah dalam menghadapi era digitalisasi. Studi kasus dilakukan pada Bank Syariah Indonesia KC Samarinda.",
status: "Diterima",
tahun: "2025",
catatan: "Proposal diterima, silakan lanjut ke tahap bimbingan",
tanggalPengajuan: "2026-02-10"
},
{
id: "proposal3",
judul: "Peran Manajemen Bisnis Syariah dalam Meningkatkan Kinerja UMKM",
mahasiswaNama: "Citra Dewi",
nim: "210401003",
prodi: "Manajemen Bisnis Syariah",
pembimbing1: "Dr. Abdul Malik, M.M",
pembimbing2: "Dr. Nurul Huda, M.Si",
whatsapp: "081234567892",
abstrak: "Penelitian ini mengkaji peran manajemen bisnis syariah dalam meningkatkan kinerja UMKM di Kota Samarinda. Pendekatan kualitatif digunakan untuk memahami fenomena secara mendalam.",
status: "Menunggu",
tahun: "2025",
catatan: "",
tanggalPengajuan: "2026-02-18"
},
{
id: "proposal4",
judul: "Analisis Dampak Fintech Syariah terhadap Inklusi Keuangan Masyarakat",
mahasiswaNama: "Dian Permata Sari",
nim: "1813181033",
prodi: "Ekonomi Syariah",
pembimbing1: "Dr. Hj. Siti Aminah, M.Ag",
pembimbing2: "Dr. Ahmad Rizal, M.Si",
whatsapp: "081234567896",
abstrak: "Penelitian ini menganalisis dampak fintech syariah terhadap inklusi keuangan masyarakat di Kalimantan Timur. Menggunakan pendekatan kuantitatif dengan sampel 200 responden pengguna fintech syariah. Hasil menunjukkan fintech syariah berkontribusi positif terhadap inklusi keuangan.",
status: "Diperbaiki",
tahun: "2025",
catatan: "Perlu perbaikan pada metodologi penelitian dan penambahan tinjauan pustaka terkait fintech syariah.",
tanggalPengajuan: "2026-02-05"
},
{
id: "proposal5",
judul: "Strategi Pengembangan Produk Perbankan Syariah untuk Generasi Milenial",
mahasiswaNama: "Eko Prasetyo",
nim: "191401004",
prodi: "Perbankan Syariah",
pembimbing1: "Dr. Muhammad Iqbal, M.Ec",
pembimbing2: "-",
whatsapp: "081234567897",
abstrak: "Penelitian ini bertujuan mengembangkan strategi produk perbankan syariah yang sesuai dengan kebutuhan generasi milenial. Menggunakan metode survey dengan 150 responden dan analisis SWOT. Diharapkan dapat memberikan rekomendasi bagi bank syariah.",
status: "Ditolak",
tahun: "2025",
catatan: "Judul dan topik terlalu umum. Perlu fokus pada aspek spesifik dan data yang lebih mendalam. Silakan ajukan ulang dengan proposal yang lebih terarah.",
tanggalPengajuan: "2026-02-01"
},
{
id: "proposal6",
judul: "Pengaruh Brand Image dan Kualitas Pelayanan terhadap Kepuasan Nasabah Bank Syariah",
mahasiswaNama: "Fajar Nugroho",
nim: "210401005",
prodi: "Perbankan Syariah",
pembimbing1: "Dr. Muhammad Iqbal, M.Ec",
pembimbing2: "Dr. Siti Khadijah, M.Si",
whatsapp: "081234567899",
abstrak: "Penelitian ini bertujuan untuk menganalisis pengaruh brand image dan kualitas pelayanan terhadap kepuasan nasabah Bank Syariah Indonesia di Samarinda. Metode penelitian menggunakan pendekatan kuantitatif dengan sampel 100 responden.",
status: "Menunggu",
tahun: "2025",
catatan: "",
tanggalPengajuan: "2026-02-20"
},
{
id: "proposal7",
judul: "Analisis Faktor-faktor yang Mempengaruhi Minat Berwirausaha Mahasiswa FEBI UINSI",
mahasiswaNama: "Gita Puspita",
nim: "210401006",
prodi: "Ekonomi Syariah",
pembimbing1: "Dr. Abdul Malik, M.M",
pembimbing2: "Dr. Nurul Huda, M.Si",
whatsapp: "081234567900",
abstrak: "Penelitian ini menganalisis faktor-faktor yang mempengaruhi minat berwirausaha mahasiswa FEBI UINSI Samarinda. Menggunakan pendekatan kuantitatif dengan sampel 150 mahasiswa.",
status: "Diterima",
tahun: "2025",
catatan: "Proposal diterima, silakan lanjut ke tahap bimbingan",
tanggalPengajuan: "2026-02-12"
},
{
id: "proposal8",
judul: "Pengaruh Inflasi dan Suku Bunga terhadap Pembiayaan Murabahah pada Bank Syariah",
mahasiswaNama: "Hendra Wijaya",
nim: "210401007",
prodi: "Perbankan Syariah",
pembimbing1: "Dr. Hj. Siti Aminah, M.Ag",
pembimbing2: "-",
whatsapp: "081234567901",
abstrak: "Penelitian ini menganalisis pengaruh inflasi dan suku bunga terhadap pembiayaan murabahah pada bank umum syariah di Indonesia periode 2018-2023.",
status: "Menunggu",
tahun: "2025",
catatan: "",
tanggalPengajuan: "2026-02-22"
},
{
id: "proposal9",
judul: "Peran Zakat Produktif dalam Pemberdayaan Ekonomi Mustahik",
mahasiswaNama: "Indah Sari",
nim: "210401008",
prodi: "Ekonomi Syariah",
pembimbing1: "Dr. Ahmad Rizal, M.Si",
pembimbing2: "Dr. Hj. Siti Aminah, M.Ag",
whatsapp: "081234567902",
abstrak: "Penelitian ini mengkaji peran zakat produktif dalam pemberdayaan ekonomi mustahik di BAZNAS Kota Samarinda. Pendekatan kualitatif digunakan untuk memahami fenomena secara mendalam.",
status: "Diperbaiki",
tahun: "2025",
catatan: "Perlu perbaikan pada analisis data dan kesimpulan",
tanggalPengajuan: "2026-02-08"
},
{
id: "proposal10",
judul: "Analisis Kinerja Keuangan Bank Umum Syariah Sebelum dan Selama Pandemi",
mahasiswaNama: "Joko Susilo",
nim: "210401009",
prodi: "Perbankan Syariah",
pembimbing1: "Dr. Muhammad Iqbal, M.Ec",
pembimbing2: "Dr. Siti Khadijah, M.Si",
whatsapp: "081234567903",
abstrak: "Penelitian ini menganalisis kinerja keuangan bank umum syariah sebelum dan selama pandemi COVID-19 periode 2018-2022.",
status: "Diterima",
tahun: "2025",
catatan: "Proposal diterima, silakan lanjut ke tahap bimbingan",
tanggalPengajuan: "2026-02-14"
},
{
id: "proposal11",
judul: "Pengaruh Literasi Digital dan E-commerce terhadap Pendapatan UMKM",
mahasiswaNama: "Kartika Dewi",
nim: "210401010",
prodi: "Manajemen Bisnis Syariah",
pembimbing1: "Dr. Abdul Malik, M.M",
pembimbing2: "Dr. Nurul Huda, M.Si",
whatsapp: "081234567904",
abstrak: "Penelitian ini menganalisis pengaruh literasi digital dan penggunaan e-commerce terhadap pendapatan UMKM di Kota Samarinda.",
status: "Menunggu",
tahun: "2025",
catatan: "",
tanggalPengajuan: "2026-02-24"
},
{
id: "proposal12",
judul: "Strategi Pemasaran Produk Halal dalam Meningkatkan Daya Saing UMKM",
mahasiswaNama: "Lestari Putri",
nim: "210401011",
prodi: "Manajemen Bisnis Syariah",
pembimbing1: "Dr. Abdul Malik, M.M",
pembimbing2: "Dr. Ahmad Rizal, M.Si",
whatsapp: "081234567905",
abstrak: "Penelitian ini menganalisis strategi pemasaran produk halal dalam meningkatkan daya saing UMKM di Samarinda.",
status: "Ditolak",
tahun: "2025",
catatan: "Topik terlalu luas, perlu fokus pada aspek spesifik",
tanggalPengajuan: "2026-02-03"
},
{
id: "proposal13",
judul: "Pengaruh Kualitas Layanan Mobile Banking terhadap Kepuasan Nasabah",
mahasiswaNama: "Muhammad Rizki",
nim: "210401012",
prodi: "Perbankan Syariah",
pembimbing1: "Dr. Hj. Siti Aminah, M.Ag",
pembimbing2: "-",
whatsapp: "081234567906",
abstrak: "Penelitian ini menganalisis pengaruh kualitas layanan mobile banking terhadap kepuasan nasabah Bank Syariah Indonesia di Samarinda.",
status: "Diterima",
tahun: "2025",
catatan: "Proposal diterima, silakan lanjut ke tahap bimbingan",
tanggalPengajuan: "2026-02-16"
},
{
id: "proposal14",
judul: "Analisis Determinan Non Performing Financing pada Bank Syariah",
mahasiswaNama: "Nur Aini",
nim: "210401013",
prodi: "Perbankan Syariah",
pembimbing1: "Dr. Muhammad Iqbal, M.Ec",
pembimbing2: "Dr. Siti Khadijah, M.Si",
whatsapp: "081234567907",
abstrak: "Penelitian ini menganalisis determinan non performing financing pada bank umum syariah di Indonesia periode 2018-2023.",
status: "Menunggu",
tahun: "2025",
catatan: "",
tanggalPengajuan: "2026-02-25"
},
{
id: "proposal15",
judul: "Pengaruh Gaya Kepemimpinan Islami terhadap Kinerja Karyawan",
mahasiswaNama: "Oktaviani",
nim: "210401014",
prodi: "Manajemen Bisnis Syariah",
pembimbing1: "Dr. Abdul Malik, M.M",
pembimbing2: "Dr. Nurul Huda, M.Si",
whatsapp: "081234567908",
abstrak: "Penelitian ini menganalisis pengaruh gaya kepemimpinan Islami terhadap kinerja karyawan pada perbankan syariah di Samarinda.",
status: "Diperbaiki",
tahun: "2025",
catatan: "Perlu perbaikan pada instrumen penelitian",
tanggalPengajuan: "2026-02-09"
},
{
id: "proposal16",
judul: "Peran Fintech Syariah dalam Meningkatkan Inklusi Keuangan",
mahasiswaNama: "Putri Wulandari",
nim: "210401015",
prodi: "Ekonomi Syariah",
pembimbing1: "Dr. Ahmad Rizal, M.Si",
pembimbing2: "Dr. Hj. Siti Aminah, M.Ag",
whatsapp: "081234567909",
abstrak: "Penelitian ini menganalisis peran fintech syariah dalam meningkatkan inklusi keuangan masyarakat di Kalimantan Timur.",
status: "Menunggu",
tahun: "2025",
catatan: "",
tanggalPengajuan: "2026-02-26"
}
];

const dummyDosen = [
{
id: "dosen1",
nama: "Dr. Hj. Siti Aminah, M.Ag",
nip: "197001012005012001",
keahlian: "Ekonomi Syariah",
whatsapp: "081234567893",
password: "dosen123"
},
{
id: "dosen2",
nama: "Dr. Muhammad Iqbal, M.Ec",
nip: "197502012006021002",
keahlian: "Perbankan Syariah",
whatsapp: "081234567894",
password: "dosen123"
},
{
id: "dosen3",
nama: "Dr. Abdul Malik, M.M",
nip: "198003012007031003",
keahlian: "Manajemen Bisnis",
whatsapp: "081234567895",
password: "dosen123"
},
{
id: "dosen4",
nama: "Dr. Ahmad Rizal, M.Si",
nip: "197503012008041004",
keahlian: "Ekonomi Syariah",
whatsapp: "081234567896",
password: "dosen123"
},
{
id: "dosen5",
nama: "Dr. Siti Khadijah, M.Si",
nip: "197604012009051005",
keahlian: "Perbankan Syariah",
whatsapp: "081234567897",
password: "dosen123"
},
{
id: "dosen6",
nama: "Dr. Nurul Huda, M.Si",
nip: "197705012010061006",
keahlian: "Manajemen Bisnis",
whatsapp: "081234567898",
password: "dosen123"
}
];

const dummyMahasiswa = [
{
id: "mhs1",
nim: "210401001",
nama: "Ahmad Fauzi",
prodi: "Ekonomi Syariah",
whatsapp: "081234567890",
semester: 9,
status: "aktif",
password: "mhs123"
},
{
id: "mhs2",
nim: "210401002",
nama: "Budi Santoso",
prodi: "Perbankan Syariah",
whatsapp: "081234567891",
semester: 9,
status: "aktif",
password: "mhs123"
},
{
id: "mhs3",
nim: "210401003",
nama: "Citra Dewi",
prodi: "Manajemen Bisnis Syariah",
whatsapp: "081234567892",
semester: 9,
status: "aktif",
password: "mhs123"
},
{
id: "mhs4",
nim: "1813181033",
nama: "Dian Permata Sari",
prodi: "Ekonomi Syariah",
whatsapp: "081234567896",
semester: 13,
status: "aktif",
password: "mhs123"
},
{
id: "mhs5",
nim: "191401004",
nama: "Eko Prasetyo",
prodi: "Perbankan Syariah",
whatsapp: "081234567897",
semester: 11,
status: "aktif",
password: "mhs123"
},
{
id: "mhs6",
nim: "210401005",
nama: "Fajar Nugroho",
prodi: "Perbankan Syariah",
whatsapp: "081234567899",
semester: 9,
status: "aktif",
password: "mhs123"
},
{
id: "mhs7",
nim: "210401006",
nama: "Gita Puspita",
prodi: "Ekonomi Syariah",
whatsapp: "081234567900",
semester: 9,
status: "aktif",
password: "mhs123"
},
{
id: "mhs8",
nim: "210401007",
nama: "Hendra Wijaya",
prodi: "Perbankan Syariah",
whatsapp: "081234567901",
semester: 9,
status: "aktif",
password: "mhs123"
},
{
id: "mhs9",
nim: "210401008",
nama: "Indah Sari",
prodi: "Ekonomi Syariah",
whatsapp: "081234567902",
semester: 9,
status: "aktif",
password: "mhs123"
},
{
id: "mhs10",
nim: "210401009",
nama: "Joko Susilo",
prodi: "Perbankan Syariah",
whatsapp: "081234567903",
semester: 9,
status: "aktif",
password: "mhs123"
},
{
id: "mhs11",
nim: "210401010",
nama: "Kartika Dewi",
prodi: "Manajemen Bisnis Syariah",
whatsapp: "081234567904",
semester: 9,
status: "aktif",
password: "mhs123"
},
{
id: "mhs12",
nim: "210401011",
nama: "Lestari Putri",
prodi: "Manajemen Bisnis Syariah",
whatsapp: "081234567905",
semester: 9,
status: "aktif",
password: "mhs123"
},
{
id: "mhs13",
nim: "210401012",
nama: "Muhammad Rizki",
prodi: "Perbankan Syariah",
whatsapp: "081234567906",
semester: 9,
status: "aktif",
password: "mhs123"
},
{
id: "mhs14",
nim: "210401013",
nama: "Nur Aini",
prodi: "Perbankan Syariah",
whatsapp: "081234567907",
semester: 9,
status: "aktif",
password: "mhs123"
},
{
id: "mhs15",
nim: "210401014",
nama: "Oktaviani",
prodi: "Manajemen Bisnis Syariah",
whatsapp: "081234567908",
semester: 9,
status: "aktif",
password: "mhs123"
},
{
id: "mhs16",
nim: "210401015",
nama: "Putri Wulandari",
prodi: "Ekonomi Syariah",
whatsapp: "081234567909",
semester: 9,
status: "aktif",
password: "mhs123"
}
];

// Data dummy bimbingan dengan meetings dan pembimbingKe
const dummyBimbingan = [
{
id: "bimb1",
nim: "210401002",
mahasiswaNama: "Budi Santoso",
dosenNama: "Dr. Muhammad Iqbal, M.Ec",
pembimbingKe: 1,
judul: "Analisis Strategi Pemasaran Produk Perbankan Syariah di Era Digital",
prodi: "Perbankan Syariah",
whatsapp: "081234567891",
progress: 30,
status: "berlangsung",
catatan: "Bab 1-2 sudah direvisi. Lanjut ke bab 3 metodologi.",
lastUpdate: "2026-02-15",
createdAt: "2026-02-01T08:00:00.000Z",
proposalId: "proposal2",
meetings: [
{
id: "m1",
tanggal: "2026-02-01",
progress: 10,
catatan: "Pertemuan 1: Pengajuan judul dan outline bab 1",
dosenNama: "Dr. Muhammad Iqbal, M.Ec"
},
{
id: "m2",
tanggal: "2026-02-08",
progress: 20,
catatan: "Pertemuan 2: Revisi bab 1 dan pembahasan bab 2",
dosenNama: "Dr. Muhammad Iqbal, M.Ec"
},
{
id: "m3",
tanggal: "2026-02-15",
progress: 30,
catatan: "Pertemuan 3: Revisi bab 2 dan mulai bab 3 metodologi",
dosenNama: "Dr. Muhammad Iqbal, M.Ec"
}
]
},
{
id: "bimb2",
nim: "210401002",
mahasiswaNama: "Budi Santoso",
dosenNama: "Dr. Siti Khadijah, M.Si",
pembimbingKe: 2,
judul: "Analisis Strategi Pemasaran Produk Perbankan Syariah di Era Digital",
prodi: "Perbankan Syariah",
whatsapp: "081234567891",
progress: 20,
status: "berlangsung",
catatan: "Review bab 1 dan saran perbaikan metodologi.",
lastUpdate: "2026-02-10",
createdAt: "2026-02-02T09:00:00.000Z",
proposalId: "proposal2",
meetings: [
{
id: "m1",
tanggal: "2026-02-02",
progress: 10,
catatan: "Pertemuan 1: Review judul dan outline",
dosenNama: "Dr. Siti Khadijah, M.Si"
},
{
id: "m2",
tanggal: "2026-02-10",
progress: 20,
catatan: "Pertemuan 2: Revisi bab 1",
dosenNama: "Dr. Siti Khadijah, M.Si"
}
]
},
{
id: "bimb3",
nim: "1813181033",
mahasiswaNama: "Dian Permata Sari",
dosenNama: "Dr. Hj. Siti Aminah, M.Ag",
pembimbingKe: 1,
judul: "Analisis Dampak Fintech Syariah terhadap Inklusi Keuangan Masyarakat",
prodi: "Ekonomi Syariah",
whatsapp: "081234567896",
progress: 80,
status: "berlangsung",
catatan: "Bab 4 sudah selesai, lanjut bab 5 kesimpulan.",
lastUpdate: "2026-02-10",
createdAt: "2025-09-15T10:00:00.000Z",
proposalId: "proposal4",
meetings: [
{
id: "m1",
tanggal: "2025-09-15",
progress: 10,
catatan: "Pertemuan 1: Pengajuan judul dan outline",
dosenNama: "Dr. Hj. Siti Aminah, M.Ag"
},
{
id: "m2",
tanggal: "2025-09-22",
progress: 20,
catatan: "Pertemuan 2: Revisi bab 1",
dosenNama: "Dr. Hj. Siti Aminah, M.Ag"
},
{
id: "m3",
tanggal: "2025-10-06",
progress: 30,
catatan: "Pertemuan 3: Pembahasan bab 2",
dosenNama: "Dr. Hj. Siti Aminah, M.Ag"
},
{
id: "m4",
tanggal: "2025-10-20",
progress: 40,
catatan: "Pertemuan 4: Revisi bab 2",
dosenNama: "Dr. Hj. Siti Aminah, M.Ag"
},
{
id: "m5",
tanggal: "2025-11-03",
progress: 50,
catatan: "Pertemuan 5: Pembahasan bab 3",
dosenNama: "Dr. Hj. Siti Aminah, M.Ag"
},
{
id: "m6",
tanggal: "2025-11-17",
progress: 60,
catatan: "Pertemuan 6: Revisi bab 3",
dosenNama: "Dr. Hj. Siti Aminah, M.Ag"
},
{
id: "m7",
tanggal: "2025-12-01",
progress: 70,
catatan: "Pertemuan 7: Pembahasan bab 4",
dosenNama: "Dr. Hj. Siti Aminah, M.Ag"
},
{
id: "m8",
tanggal: "2025-12-15",
progress: 80,
catatan: "Pertemuan 8: Revisi bab 4",
dosenNama: "Dr. Hj. Siti Aminah, M.Ag"
}
]
},
{
id: "bimb4",
nim: "1813181033",
mahasiswaNama: "Dian Permata Sari",
dosenNama: "Dr. Ahmad Rizal, M.Si",
pembimbingKe: 2,
judul: "Analisis Dampak Fintech Syariah terhadap Inklusi Keuangan Masyarakat",
prodi: "Ekonomi Syariah",
whatsapp: "081234567896",
progress: 70,
status: "berlangsung",
catatan: "Review bab 3 dan 4, saran perbaikan analisis data.",
lastUpdate: "2026-02-05",
createdAt: "2025-09-20T11:00:00.000Z",
proposalId: "proposal4",
meetings: [
{
id: "m1",
tanggal: "2025-09-20",
progress: 10,
catatan: "Pertemuan 1: Review judul",
dosenNama: "Dr. Ahmad Rizal, M.Si"
},
{
id: "m2",
tanggal: "2025-10-05",
progress: 20,
catatan: "Pertemuan 2: Review bab 1",
dosenNama: "Dr. Ahmad Rizal, M.Si"
},
{
id: "m3",
tanggal: "2025-10-25",
progress: 30,
catatan: "Pertemuan 3: Review bab 2",
dosenNama: "Dr. Ahmad Rizal, M.Si"
},
{
id: "m4",
tanggal: "2025-11-10",
progress: 40,
catatan: "Pertemuan 4: Pembahasan metodologi",
dosenNama: "Dr. Ahmad Rizal, M.Si"
},
{
id: "m5",
tanggal: "2025-11-25",
progress: 50,
catatan: "Pertemuan 5: Review bab 3",
dosenNama: "Dr. Ahmad Rizal, M.Si"
},
{
id: "m6",
tanggal: "2025-12-10",
progress: 60,
catatan: "Pertemuan 6: Review analisis data",
dosenNama: "Dr. Ahmad Rizal, M.Si"
},
{
id: "m7",
tanggal: "2026-01-15",
progress: 70,
catatan: "Pertemuan 7: Review bab 4",
dosenNama: "Dr. Ahmad Rizal, M.Si"
}
]
},
{
id: "bimb5",
nim: "210401006",
mahasiswaNama: "Gita Puspita",
dosenNama: "Dr. Abdul Malik, M.M",
pembimbingKe: 1,
judul: "Analisis Faktor-faktor yang Mempengaruhi Minat Berwirausaha Mahasiswa FEBI UINSI",
prodi: "Ekonomi Syariah",
whatsapp: "081234567900",
progress: 10,
status: "berlangsung",
catatan: "Pertemuan 1: Pengajuan judul dan outline",
lastUpdate: "2026-02-12",
createdAt: "2026-02-12T10:00:00.000Z",
proposalId: "proposal7",
meetings: [
{
id: "m1",
tanggal: "2026-02-12",
progress: 10,
catatan: "Pertemuan 1: Pengajuan judul dan outline",
dosenNama: "Dr. Abdul Malik, M.M"
}
]
},
{
id: "bimb6",
nim: "210401009",
mahasiswaNama: "Joko Susilo",
dosenNama: "Dr. Muhammad Iqbal, M.Ec",
pembimbingKe: 1,
judul: "Analisis Kinerja Keuangan Bank Umum Syariah Sebelum dan Selama Pandemi",
prodi: "Perbankan Syariah",
whatsapp: "081234567903",
progress: 20,
status: "berlangsung",
catatan: "Pertemuan 1: Pengajuan judul, Pertemuan 2: Revisi bab 1",
lastUpdate: "2026-02-16",
createdAt: "2026-02-14T09:00:00.000Z",
proposalId: "proposal10",
meetings: [
{
id: "m1",
tanggal: "2026-02-14",
progress: 10,
catatan: "Pertemuan 1: Pengajuan judul dan outline",
dosenNama: "Dr. Muhammad Iqbal, M.Ec"
},
{
id: "m2",
tanggal: "2026-02-16",
progress: 20,
catatan: "Pertemuan 2: Revisi bab 1",
dosenNama: "Dr. Muhammad Iqbal, M.Ec"
}
]
},
{
id: "bimb7",
nim: "210401012",
mahasiswaNama: "Muhammad Rizki",
dosenNama: "Dr. Hj. Siti Aminah, M.Ag",
pembimbingKe: 1,
judul: "Pengaruh Kualitas Layanan Mobile Banking terhadap Kepuasan Nasabah",
prodi: "Perbankan Syariah",
whatsapp: "081234567906",
progress: 10,
status: "berlangsung",
catatan: "Pertemuan 1: Pengajuan judul dan outline",
lastUpdate: "2026-02-16",
createdAt: "2026-02-16T11:00:00.000Z",
proposalId: "proposal13",
meetings: [
{
id: "m1",
tanggal: "2026-02-16",
progress: 10,
catatan: "Pertemuan 1: Pengajuan judul dan outline",
dosenNama: "Dr. Hj. Siti Aminah, M.Ag"
}
]
}
];

const dummyOperator = [
{
id: "op1",
username: "operator",
nama: "Operator FEBI",
password: "operator123",
role: "operator",
status: "aktif"
},
{
id: "op2",
username: "operator2",
nama: "Operator Dua",
password: "operator123",
role: "operator",
status: "aktif"
}
];

const dummyRepository = [
{
id: "repo1",
judul: "Pengaruh Literasi Keuangan Syariah terhadap Minat Menabung di Bank Syariah",
penulis: "Ahmad Fauzi",
nim: "210401001",
prodi: "Ekonomi Syariah",
pembimbing: "Dr. Hj. Siti Aminah, M.Ag",
tahun: "2025",
abstrak: "Penelitian ini bertujuan untuk menganalisis pengaruh literasi keuangan syariah terhadap minat menabung mahasiswa di bank syariah. Metode penelitian menggunakan pendekatan kuantitatif dengan sampel 100 responden.",
fileUrl: "",
sumber: "Skripsi FEBI"
},
{
id: "repo2",
judul: "Analisis Strategi Pemasaran Produk Perbankan Syariah di Era Digital",
penulis: "Budi Santoso",
nim: "210401002",
prodi: "Perbankan Syariah",
pembimbing: "Dr. Muhammad Iqbal, M.Ec",
tahun: "2025",
abstrak: "Penelitian ini menganalisis strategi pemasaran produk perbankan syariah dalam menghadapi era digitalisasi. Studi kasus dilakukan pada Bank Syariah Indonesia KC Samarinda.",
fileUrl: "",
sumber: "Skripsi FEBI"
},
{
id: "repo3",
judul: "Peran Manajemen Bisnis Syariah dalam Meningkatkan Kinerja UMKM",
penulis: "Citra Dewi",
nim: "210401003",
prodi: "Manajemen Bisnis Syariah",
pembimbing: "Dr. Abdul Malik, M.M",
tahun: "2025",
abstrak: "Penelitian ini mengkaji peran manajemen bisnis syariah dalam meningkatkan kinerja UMKM di Kota Samarinda. Pendekatan kualitatif digunakan untuk memahami fenomena secara mendalam.",
fileUrl: "",
sumber: "Skripsi FEBI"
},
{
id: "repo4",
judul: "Analisis Dampak Fintech Syariah terhadap Inklusi Keuangan Masyarakat",
penulis: "Dian Permata Sari",
nim: "1813181033",
prodi: "Ekonomi Syariah",
pembimbing: "Dr. Hj. Siti Aminah, M.Ag",
tahun: "2025",
abstrak: "Penelitian ini menganalisis dampak fintech syariah terhadap inklusi keuangan masyarakat di Kalimantan Timur. Menggunakan pendekatan kuantitatif dengan sampel 200 responden pengguna fintech syariah. Hasil menunjukkan fintech syariah berkontribusi positif terhadap inklusi keuangan.",
fileUrl: "",
sumber: "Skripsi FEBI"
},
{
id: "repo5",
judul: "Strategi Pengembangan Produk Perbankan Syariah untuk Generasi Milenial",
penulis: "Eko Prasetyo",
nim: "191401004",
prodi: "Perbankan Syariah",
pembimbing: "Dr. Muhammad Iqbal, M.Ec",
tahun: "2025",
abstrak: "Penelitian ini bertujuan mengembangkan strategi produk perbankan syariah yang sesuai dengan kebutuhan generasi milenial. Menggunakan metode survey dengan 150 responden dan analisis SWOT. Diharapkan dapat memberikan rekomendasi bagi bank syariah.",
fileUrl: "",
sumber: "Skripsi FEBI"
},
{
id: "repo6",
judul: "Pengaruh Brand Image dan Kualitas Pelayanan terhadap Kepuasan Nasabah Bank Syariah",
penulis: "Fajar Nugroho",
nim: "210401005",
prodi: "Perbankan Syariah",
pembimbing: "Dr. Muhammad Iqbal, M.Ec",
tahun: "2025",
abstrak: "Penelitian ini bertujuan untuk menganalisis pengaruh brand image dan kualitas pelayanan terhadap kepuasan nasabah Bank Syariah Indonesia di Samarinda. Metode penelitian menggunakan pendekatan kuantitatif dengan sampel 100 responden.",
fileUrl: "",
sumber: "Skripsi FEBI"
},
{
id: "repo7",
judul: "Analisis Faktor-faktor yang Mempengaruhi Minat Berwirausaha Mahasiswa FEBI UINSI",
penulis: "Gita Puspita",
nim: "210401006",
prodi: "Ekonomi Syariah",
pembimbing: "Dr. Abdul Malik, M.M",
tahun: "2025",
abstrak: "Penelitian ini menganalisis faktor-faktor yang mempengaruhi minat berwirausaha mahasiswa FEBI UINSI Samarinda. Menggunakan pendekatan kuantitatif dengan sampel 150 mahasiswa.",
fileUrl: "",
sumber: "Skripsi FEBI"
},
{
id: "repo8",
judul: "Pengaruh Inflasi dan Suku Bunga terhadap Pembiayaan Murabahah pada Bank Syariah",
penulis: "Hendra Wijaya",
nim: "210401007",
prodi: "Perbankan Syariah",
pembimbing: "Dr. Hj. Siti Aminah, M.Ag",
tahun: "2025",
abstrak: "Penelitian ini menganalisis pengaruh inflasi dan suku bunga terhadap pembiayaan murabahah pada bank umum syariah di Indonesia periode 2018-2023.",
fileUrl: "",
sumber: "Skripsi FEBI"
},
{
id: "repo9",
judul: "Peran Zakat Produktif dalam Pemberdayaan Ekonomi Mustahik",
penulis: "Indah Sari",
nim: "210401008",
prodi: "Ekonomi Syariah",
pembimbing: "Dr. Ahmad Rizal, M.Si",
tahun: "2025",
abstrak: "Penelitian ini mengkaji peran zakat produktif dalam pemberdayaan ekonomi mustahik di BAZNAS Kota Samarinda. Pendekatan kualitatif digunakan untuk memahami fenomena secara mendalam.",
fileUrl: "",
sumber: "Skripsi FEBI"
},
{
id: "repo10",
judul: "Analisis Kinerja Keuangan Bank Umum Syariah Sebelum dan Selama Pandemi",
penulis: "Joko Susilo",
nim: "210401009",
prodi: "Perbankan Syariah",
pembimbing: "Dr. Muhammad Iqbal, M.Ec",
tahun: "2025",
abstrak: "Penelitian ini menganalisis kinerja keuangan bank umum syariah sebelum dan selama pandemi COVID-19 periode 2018-2022.",
fileUrl: "",
sumber: "Skripsi FEBI"
},
{
id: "repo11",
judul: "Pengaruh Literasi Digital dan E-commerce terhadap Pendapatan UMKM",
penulis: "Kartika Dewi",
nim: "210401010",
prodi: "Manajemen Bisnis Syariah",
pembimbing: "Dr. Abdul Malik, M.M",
tahun: "2025",
abstrak: "Penelitian ini menganalisis pengaruh literasi digital dan penggunaan e-commerce terhadap pendapatan UMKM di Kota Samarinda.",
fileUrl: "",
sumber: "Skripsi FEBI"
},
{
id: "repo12",
judul: "Strategi Pemasaran Produk Halal dalam Meningkatkan Daya Saing UMKM",
penulis: "Lestari Putri",
nim: "210401011",
prodi: "Manajemen Bisnis Syariah",
pembimbing: "Dr. Abdul Malik, M.M",
tahun: "2025",
abstrak: "Penelitian ini menganalisis strategi pemasaran produk halal dalam meningkatkan daya saing UMKM di Samarinda.",
fileUrl: "",
sumber: "Skripsi FEBI"
},
{
id: "repo13",
judul: "Pengaruh Kualitas Layanan Mobile Banking terhadap Kepuasan Nasabah",
penulis: "Muhammad Rizki",
nim: "210401012",
prodi: "Perbankan Syariah",
pembimbing: "Dr. Hj. Siti Aminah, M.Ag",
tahun: "2025",
abstrak: "Penelitian ini menganalisis pengaruh kualitas layanan mobile banking terhadap kepuasan nasabah Bank Syariah Indonesia di Samarinda.",
fileUrl: "",
sumber: "Skripsi FEBI"
},
{
id: "repo14",
judul: "Analisis Determinan Non Performing Financing pada Bank Syariah",
penulis: "Nur Aini",
nim: "210401013",
prodi: "Perbankan Syariah",
pembimbing: "Dr. Muhammad Iqbal, M.Ec",
tahun: "2025",
abstrak: "Penelitian ini menganalisis determinan non performing financing pada bank umum syariah di Indonesia periode 2018-2023.",
fileUrl: "",
sumber: "Skripsi FEBI"
},
{
id: "repo15",
judul: "Pengaruh Gaya Kepemimpinan Islami terhadap Kinerja Karyawan",
penulis: "Oktaviani",
nim: "210401014",
prodi: "Manajemen Bisnis Syariah",
pembimbing: "Dr. Abdul Malik, M.M",
tahun: "2025",
abstrak: "Penelitian ini menganalisis pengaruh gaya kepemimpinan Islami terhadap kinerja karyawan pada perbankan syariah di Samarinda.",
fileUrl: "",
sumber: "Skripsi FEBI"
},
{
id: "repo16",
judul: "Peran Fintech Syariah dalam Meningkatkan Inklusi Keuangan",
penulis: "Putri Wulandari",
nim: "210401015",
prodi: "Ekonomi Syariah",
pembimbing: "Dr. Ahmad Rizal, M.Si",
tahun: "2025",
abstrak: "Penelitian ini menganalisis peran fintech syariah dalam meningkatkan inklusi keuangan masyarakat di Kalimantan Timur.",
fileUrl: "",
sumber: "Skripsi FEBI"
}
];

// ============================================
// PAGINATION COMPONENT
// ============================================
const Pagination = ({ currentPage, totalPages, onPageChange }) => {
if (totalPages <= 1) return null;

const getPageNumbers = () => {
const delta = 2;
const range = [];
const rangeWithDots = [];
let l;

for (let i = 1; i <= totalPages; i++) {
if (i === 1 || i === totalPages || (i >= currentPage - delta && i <= currentPage + delta)) {
range.push(i);
}
}

range.forEach((i) => {
if (l) {
if (i - l === 2) {
rangeWithDots.push(l + 1);
} else if (i - l > 2) {
rangeWithDots.push('...');
}
}
rangeWithDots.push(i);
l = i;
});

return rangeWithDots;
};

return (
<div className="pagination flex justify-center items-center gap-2 mt-6">
<button
onClick={() => onPageChange(currentPage - 1)}
disabled={currentPage === 1}
className="px-4 py-2 bg-white border border-gray-200 rounded-lg hover:bg-emerald-600 hover:text-white disabled:opacity-50 disabled:hover:bg-white disabled:hover:text-gray-400 transition-all"
>
‚Äπ Prev
</button>
  
{getPageNumbers().map((page, index) => (
page === '...' ? (
<span key={`dots-${index}`} className="px-3 py-2 text-gray-500">...</span>
) : (
<button
key={page}
onClick={() => onPageChange(page)}
className={`px-4 py-2 border border-gray-200 rounded-lg transition-all ${
currentPage === page
? 'bg-emerald-600 text-white border-emerald-600'
: 'bg-white text-gray-700 hover:bg-emerald-50 hover:border-emerald-200'
}`}
>
{page}
</button>
)
))}

<button
onClick={() => onPageChange(currentPage + 1)}
disabled={currentPage === totalPages}
className="px-4 py-2 bg-white border border-gray-200 rounded-lg hover:bg-emerald-600 hover:text-white disabled:opacity-50 disabled:hover:bg-white disabled:hover:text-gray-400 transition-all"
>
Next ‚Ä∫
</button>
</div>
);
};

// ============================================
// DASHBOARD PAGE
// ============================================
/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   KALENDER EDIT MODAL ‚Äî Standalone component (di luar DashboardPage)
   Dipindahkan keluar agar tidak di-remount setiap detik akibat clock interval.
   Menerima props: siklus, onSave, onClose, lastUpdate, updatedBy
   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
const KalenderEditModal = React.memo(({ siklus: initialSiklus, onSave, onClose, lastUpdate, updatedBy }) => {
const [editData, setEditData] = React.useState(() => ({
siklus: JSON.parse(JSON.stringify(initialSiklus))
}));
const [editSiklusIdx, setEditSiklusIdx] = React.useState(0);
const [saving, setSaving] = React.useState(false);
const [expandRow, setExpandRow] = React.useState(null);

const cur = editData.siklus[editSiklusIdx] || {};
const curEdit = cur.tahapan || [];

const updateSiklusField = (idx, field, val) => {
setEditData(prev => {
const s = JSON.parse(JSON.stringify(prev.siklus));
s[idx] = { ...s[idx], [field]: val };
return { ...prev, siklus: s };
});
};
const updateWisudaField = (idx, field, val) => {
setEditData(prev => {
const s = JSON.parse(JSON.stringify(prev.siklus));
s[idx].wisuda = { ...s[idx].wisuda, [field]: val };
return { ...prev, siklus: s };
});
};
const updateTahapanField = (siklusIdx, tIdx, field, val) => {
setEditData(prev => {
const s = JSON.parse(JSON.stringify(prev.siklus));
s[siklusIdx].tahapan[tIdx] = { ...s[siklusIdx].tahapan[tIdx], [field]: val };
return { ...prev, siklus: s };
});
};
const addTahapan = (siklusIdx) => {
setEditData(prev => {
const s = JSON.parse(JSON.stringify(prev.siklus));
const newId = `s${siklusIdx+1}-t${Date.now()}`;
s[siklusIdx].tahapan.push({ id:newId, label:'Tahapan Baru', icon:'üìã', mulai:'', selesai:'', color:'emerald', desc:'' });
return { ...prev, siklus: s };
});
};
const removeTahapan = (siklusIdx, tIdx) => {
if (!confirm('Hapus tahapan ini?')) return;
setEditData(prev => {
const s = JSON.parse(JSON.stringify(prev.siklus));
s[siklusIdx].tahapan.splice(tIdx, 1);
return { ...prev, siklus: s };
});
};
const moveTahapan = (siklusIdx, tIdx, dir) => {
setEditData(prev => {
const s = JSON.parse(JSON.stringify(prev.siklus));
const t = s[siklusIdx].tahapan;
const swapIdx = tIdx + dir;
if (swapIdx < 0 || swapIdx >= t.length) return prev;
[t[tIdx], t[swapIdx]] = [t[swapIdx], t[tIdx]];
return { ...prev, siklus: s };
});
};
const handleSave = async () => {
setSaving(true);
const ok = await onSave(editData);
setSaving(false);
if (ok) onClose();
};

return (
<div className="fixed inset-0 bg-black/60 z-50 flex items-start justify-center p-3 overflow-y-auto" onClick={(e)=>{ if(e.target===e.currentTarget) onClose(); }}>
<div className="kalender-edit-modal bg-white rounded-2xl shadow-2xl w-full max-w-3xl my-4" onClick={e=>e.stopPropagation()}>

{/* Modal Header */}
<div className="bg-gradient-to-r from-emerald-700 to-teal-600 rounded-t-2xl px-5 py-4 flex justify-between items-center">
<div>
<h2 className="text-lg font-black text-white flex items-center gap-2">‚úèÔ∏è Edit Kalender Akademik</h2>
<p className="text-emerald-100 text-xs mt-0.5">Data tersimpan ke Firebase ‚Äî berlaku real-time untuk semua pengguna</p>
</div>
<button onClick={onClose} className="w-8 h-8 bg-white/20 hover:bg-white/30 text-white rounded-lg flex items-center justify-center text-lg font-bold transition-all">‚úï</button>
</div>

{/* Siklus tabs */}
<div className="flex border-b border-gray-200 bg-gray-50 px-5 pt-3 gap-2 flex-wrap">
{editData.siklus.map((s, i) => (
<button key={s.id} onClick={()=>{ setEditSiklusIdx(i); setExpandRow(null); }}
className={`siklus-tab px-4 py-2 rounded-t-xl text-xs font-bold border-2 border-b-0 transition-all ${editSiklusIdx===i ? 'bg-emerald-700 text-white border-emerald-700' : 'bg-white text-gray-600 border-gray-200 hover:border-emerald-300'}`}>
{s.icon} {s.nama}
</button>
))}
</div>

<div className="p-5 space-y-4 max-h-[65vh] overflow-y-auto">
{/* Siklus Identity */}
<div className="bg-emerald-50 rounded-xl p-4 border border-emerald-200">
<p className="text-xs font-bold text-emerald-800 mb-3 flex items-center gap-2">üóìÔ∏è Identitas Siklus {editSiklusIdx+1}</p>
<div className="grid grid-cols-2 gap-3">
<div>
<label className="text-xs font-semibold text-gray-600 mb-1 block">Nama Siklus</label>
<input value={cur.nama||''} onChange={e=>updateSiklusField(editSiklusIdx,'nama',e.target.value)}
className="w-full px-3 py-2 border-2 border-gray-200 rounded-lg text-sm focus:border-emerald-500 focus:outline-none" placeholder="Siklus I ‚Äî Wisuda April"/>
</div>
<div>
<label className="text-xs font-semibold text-gray-600 mb-1 block">Ikon Siklus</label>
<select value={cur.icon||'üå±'} onChange={e=>updateSiklusField(editSiklusIdx,'icon',e.target.value)}
className="w-full px-3 py-2 border-2 border-gray-200 rounded-lg text-sm focus:border-emerald-500 focus:outline-none">
{['üå±','‚òÄÔ∏è','‚ùÑÔ∏è','üçÇ','üå∏','‚≠ê','üî•','üíé'].map(ic=><option key={ic} value={ic}>{ic}</option>)}
</select>
</div>
<div>
<label className="text-xs font-semibold text-gray-600 mb-1 block">üìÖ Tanggal Wisuda</label>
<input type="date" value={cur.wisuda?.tanggal||''} onChange={e=>updateWisudaField(editSiklusIdx,'tanggal',e.target.value)}
className="w-full px-3 py-2 border-2 border-gray-200 rounded-lg text-sm focus:border-emerald-500 focus:outline-none"/>
</div>
<div>
<label className="text-xs font-semibold text-gray-600 mb-1 block">Label Wisuda</label>
<input value={cur.wisuda?.label||''} onChange={e=>updateWisudaField(editSiklusIdx,'label',e.target.value)}
className="w-full px-3 py-2 border-2 border-gray-200 rounded-lg text-sm focus:border-emerald-500 focus:outline-none" placeholder="Wisuda I"/>
</div>
</div>
</div>

{/* Tahapan list */}
<div>
<div className="flex justify-between items-center mb-2">
<p className="text-xs font-bold text-gray-700 flex items-center gap-2">üìã Tahapan ({curEdit.length})</p>
<button onClick={()=>addTahapan(editSiklusIdx)}
className="text-xs bg-emerald-600 hover:bg-emerald-700 text-white px-3 py-1.5 rounded-lg font-semibold transition-all flex items-center gap-1">
‚ûï Tambah Tahapan
</button>
</div>
<div className="space-y-2">
{curEdit.map((t, ti) => (
<div key={t.id || ti} className="tahapan-edit-row bg-gray-50 rounded-xl border border-gray-200 overflow-hidden">
{/* Row header */}
<div className="flex items-center gap-2 px-3 py-2.5 cursor-pointer select-none" onClick={()=>setExpandRow(expandRow===ti?null:ti)}>
<span className="text-base">{t.icon}</span>
<span className="flex-1 text-xs font-semibold text-gray-800 truncate">{t.label||'(tanpa nama)'}</span>
<span className="text-[10px] text-gray-400 hidden sm:block">{t.mulai||'‚Äî'} ‚Üí {t.selesai||'‚Äî'}</span>
<div className="flex gap-1 ml-2" onClick={e=>e.stopPropagation()}>
<button onClick={()=>moveTahapan(editSiklusIdx,ti,-1)} className="w-6 h-6 bg-gray-200 hover:bg-gray-300 rounded text-[10px] flex items-center justify-center transition-colors" title="Naik">‚ñ≤</button>
<button onClick={()=>moveTahapan(editSiklusIdx,ti,+1)} className="w-6 h-6 bg-gray-200 hover:bg-gray-300 rounded text-[10px] flex items-center justify-center transition-colors" title="Turun">‚ñº</button>
<button onClick={()=>removeTahapan(editSiklusIdx,ti)} className="w-6 h-6 bg-red-100 hover:bg-red-200 text-red-600 rounded text-[10px] flex items-center justify-center font-bold transition-colors">‚úï</button>
</div>
<span className={`text-gray-400 text-[10px] transition-transform duration-200 ml-1 pointer-events-none ${expandRow===ti?'rotate-180':''}`}>‚ñº</span>
</div>
{/* Expandable fields */}
{expandRow === ti && (
<div className="px-3 pb-3 pt-2 border-t border-gray-200 grid grid-cols-2 gap-2 bg-white">
<div className="col-span-2">
<label className="text-[10px] font-semibold text-gray-500 mb-0.5 block">Nama Tahapan</label>
<input value={t.label||''} onChange={e=>updateTahapanField(editSiklusIdx,ti,'label',e.target.value)}
className="w-full px-2 py-1.5 border-2 border-gray-200 rounded-lg text-xs focus:border-emerald-500 focus:outline-none transition-colors"/>
</div>
<div>
<label className="text-[10px] font-semibold text-gray-500 mb-0.5 block">Ikon</label>
<select value={t.icon||'üìã'} onChange={e=>updateTahapanField(editSiklusIdx,ti,'icon',e.target.value)}
className="w-full px-2 py-1.5 border-2 border-gray-200 rounded-lg text-xs focus:border-emerald-500 focus:outline-none">
{['üîç','üìù','üé§','üî¨','üìä','üèõÔ∏è','üéì','üèÖ','üìã','üìå','‚úèÔ∏è','üìë','üîî','‚úÖ'].map(ic=><option key={ic} value={ic}>{ic}</option>)}
</select>
</div>
<div>
<label className="text-[10px] font-semibold text-gray-500 mb-0.5 block">Warna</label>
<select value={t.color||'emerald'} onChange={e=>updateTahapanField(editSiklusIdx,ti,'color',e.target.value)}
className="w-full px-2 py-1.5 border-2 border-gray-200 rounded-lg text-xs focus:border-emerald-500 focus:outline-none">
{['emerald','blue','violet','amber','orange','rose','teal','purple'].map(c=><option key={c} value={c}>{c}</option>)}
</select>
</div>
<div>
<label className="text-[10px] font-semibold text-gray-500 mb-0.5 block">Tanggal Mulai</label>
<input type="date" value={t.mulai||''} onChange={e=>updateTahapanField(editSiklusIdx,ti,'mulai',e.target.value)}
className="w-full px-2 py-1.5 border-2 border-gray-200 rounded-lg text-xs focus:border-emerald-500 focus:outline-none"/>
</div>
<div>
<label className="text-[10px] font-semibold text-gray-500 mb-0.5 block">Tanggal Selesai</label>
<input type="date" value={t.selesai||''} onChange={e=>updateTahapanField(editSiklusIdx,ti,'selesai',e.target.value)}
className="w-full px-2 py-1.5 border-2 border-gray-200 rounded-lg text-xs focus:border-emerald-500 focus:outline-none"/>
</div>
<div className="col-span-2">
<label className="text-[10px] font-semibold text-gray-500 mb-0.5 block">Deskripsi</label>
<textarea value={t.desc||''} onChange={e=>updateTahapanField(editSiklusIdx,ti,'desc',e.target.value)} rows={2}
className="w-full px-2 py-1.5 border-2 border-gray-200 rounded-lg text-xs focus:border-emerald-500 focus:outline-none resize-none"/>
</div>
</div>
)}
</div>
))}
{curEdit.length === 0 && (
<div className="text-center py-8 text-gray-400 text-sm">
<div className="text-3xl mb-2">üìã</div>
<p>Belum ada tahapan. Klik <strong>‚ûï Tambah Tahapan</strong> untuk mulai.</p>
</div>
)}
</div>
</div>

{/* Info note */}
<div className="bg-blue-50 rounded-xl p-3 border border-blue-200 text-xs text-blue-700 flex items-start gap-2">
<span className="text-base mt-0.5">‚ÑπÔ∏è</span>
<span>Perubahan akan langsung tersimpan ke Firebase dan terlihat oleh <strong>semua pengguna</strong> secara real-time.
{lastUpdate && <span className="ml-2 text-blue-500"> Terakhir diubah: {lastUpdate} oleh {updatedBy||'Admin'}</span>}</span>
</div>
</div>

{/* Modal Footer */}
<div className="px-5 py-4 border-t border-gray-200 flex gap-3 justify-end bg-gray-50 rounded-b-2xl">
<button onClick={onClose}
className="px-5 py-2 text-sm text-gray-600 bg-white border-2 border-gray-200 rounded-xl hover:bg-gray-100 font-semibold transition-all">
Batal
</button>
<button onClick={handleSave} disabled={saving}
className="kalender-save-btn px-6 py-2 text-sm bg-emerald-600 hover:bg-emerald-700 text-white rounded-xl font-bold transition-all flex items-center gap-2 disabled:opacity-60">
{saving ? <><span className="w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin inline-block"></span> Menyimpan...</> : <>üíæ Simpan Kalender</>}
</button>
</div>
</div>
</div>
);
});

const DashboardPage = ({ mahasiswaArr, dosenArr, proposalsArr, repositoryArr, bimbinganArr, pendingBimbingan, userRole, currentUser, onNavigate, kalenderAkademik, onSaveKalender }) => {
// Hitung statistik berdasarkan role
const getMahasiswaCount = () => {
if (userRole === 'mahasiswa') return 1;
return mahasiswaArr.length;
};

const getDosenCount = () => {
if (userRole === 'dosen') return 1;
return dosenArr.length;
};

const getProposalCount = () => {
if (userRole === 'mahasiswa') {
return proposalsArr.filter(p => p.nim === currentUser?.nim).length;
}
if (userRole === 'dosen') {
return proposalsArr.filter(p => p.pembimbing1 === currentUser?.nama || p.pembimbing2 === currentUser?.nama).length;
}
return proposalsArr.length;
};

const getBimbinganCount = () => {
if (userRole === 'mahasiswa') {
return bimbinganArr.filter(b => b.nim === currentUser?.nim).length;
}
if (userRole === 'dosen') {
return bimbinganArr.filter(b => b.dosenNama === currentUser?.nama).length;
}
return bimbinganArr.length;
};

return (
<div className="space-y-6">
<div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
<div className="bg-gradient-to-br from-emerald-500 to-teal-600 rounded-2xl shadow-lg p-6 text-white">
<div className="flex items-center justify-between mb-3">
<span className="text-4xl">üë•</span>
<span className="text-3xl font-black">{getMahasiswaCount()}</span>
</div>
<h3 className="text-sm font-semibold">Total Mahasiswa</h3>
</div>
<div className="bg-gradient-to-br from-blue-500 to-indigo-600 rounded-2xl shadow-lg p-6 text-white">
<div className="flex items-center justify-between mb-3">
<span className="text-4xl">üë®‚Äçüè´</span>
<span className="text-3xl font-black">{getDosenCount()}</span>
</div>
<h3 className="text-sm font-semibold">Total Dosen</h3>
</div>
<div className="bg-gradient-to-br from-purple-500 to-pink-600 rounded-2xl shadow-lg p-6 text-white">
<div className="flex items-center justify-between mb-3">
<span className="text-4xl">üìù</span>
<span className="text-3xl font-black">{getProposalCount()}</span>
</div>
<h3 className="text-sm font-semibold">Total Proposal</h3>
</div>
<div className="bg-gradient-to-br from-amber-500 to-orange-600 rounded-2xl shadow-lg p-6 text-white">
<div className="flex items-center justify-between mb-3">
<span className="text-4xl">üìö</span>
<span className="text-3xl font-black">{repositoryArr.length}</span>
</div>
<h3 className="text-sm font-semibold">Repository</h3>
</div>
</div>
{/* Workflow Status Cards */}
<div className="grid grid-cols-1 md:grid-cols-4 gap-4">
<div className="bg-white rounded-xl shadow-sm p-5 border-l-4 border-blue-500">
<p className="text-sm text-gray-500">Proposal Menunggu</p>
<p className="text-3xl font-bold text-blue-600 mt-1">{proposalsArr.filter(p => !p.status || p.status === 'Menunggu').length}</p>
<div className="mt-2 workflow-badge workflow-proposal">Draft</div>
</div>
<div className="bg-white rounded-xl shadow-sm p-5 border-l-4 border-green-500">
<p className="text-sm text-gray-500">Proposal Disetujui</p>
<p className="text-3xl font-bold text-green-600 mt-1">{proposalsArr.filter(p => p.status === 'Diterima').length}</p>
<div className="mt-2 workflow-badge workflow-approved">Approved</div>
</div>
<div className="bg-white rounded-xl shadow-sm p-5 border-l-4 border-amber-500">
<p className="text-sm text-gray-500">Bimbingan Aktif</p>
<p className="text-3xl font-bold text-amber-600 mt-1">{bimbinganArr.filter(b => b.status === 'berlangsung').length}</p>
<div className="mt-2 workflow-badge workflow-bimbingan">In Progress</div>
</div>
<div className="bg-white rounded-xl shadow-sm p-5 border-l-4 border-emerald-500">
<p className="text-sm text-gray-500">Selesai Bimbingan</p>
<p className="text-3xl font-bold text-emerald-600 mt-1">{bimbinganArr.filter(b => b.status === 'selesai').length}</p>
<div className="mt-2 workflow-badge workflow-selesai">Completed</div>
</div>
</div>
{/* CRITICAL ALERT: Pending Bimbingan */}
{pendingBimbingan.length > 0 && (userRole === 'admin' || userRole === 'operator' || userRole === 'dosen') && (
<div className="pending-bimbingan-card rounded-xl p-5">
<div className="flex items-start gap-3">
<span className="text-3xl mt-1">‚ö†Ô∏è</span>
<div>
<h3 className="font-bold text-lg text-amber-800">Proposal Approved Belum Masuk Bimbingan</h3>
<p className="text-amber-700 mt-1 mb-3">
Terdapat <strong>{pendingBimbingan.length}</strong> proposal yang sudah disetujui admin
{userRole === 'dosen' ? ' dan menunggu Anda memulai proses bimbingan' : ' namun belum memiliki record bimbingan'}.
</p>
<div className="space-y-2 max-h-48 overflow-y-auto pr-2">
{pendingBimbingan.slice(0, 3).map((p, idx) => (
<div key={idx} className="flex justify-between items-start bg-white/60 p-3 rounded-lg">
<div>
<p className="font-medium text-sm">{p.judul?.substring(0, 35)}{p.judul?.length > 35 ? '...' : ''}</p>
<p className="text-xs text-amber-800">{p.mahasiswaNama} ‚Ä¢ {p.prodi}</p>
<p className="text-xs mt-1">Pembimbing 1: <strong>{p.pembimbing1}</strong></p>
{p.pembimbing2 && p.pembimbing2 !== '-' && (
<p className="text-xs mt-1">Pembimbing 2: <strong>{p.pembimbing2}</strong></p>
)}
</div>
{userRole === 'dosen' && (p.pembimbing1 === currentUser.nama || p.pembimbing2 === currentUser.nama) && (
<button
onClick={() => window.handleMulaiBimbingan && window.handleMulaiBimbingan(p, p.pembimbing1 === currentUser.nama ? 1 : 2)}
className="px-3 py-1 bg-amber-600 text-white rounded text-xs hover:bg-amber-700"
>
Mulai Bimbingan
</button>
)}
</div>
))}
</div>
{pendingBimbingan.length > 3 && (
<p className="text-xs text-amber-700 mt-2 italic">
+{pendingBimbingan.length - 3} proposal lainnya menunggu inisiasi bimbingan
</p>
)}
</div>
</div>
</div>
)}


{/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    KALENDER AKADEMIK ‚Äî 3 Siklus Wisuda, Firebase-backed, Editable
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */}
{(() => {

/* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
   DEFAULT DATA: 3 Siklus Wisuda UINSI Samarinda
   Ini dipakai saat Firebase belum punya data kalender_akademik.
   Setelah admin/operator edit & simpan, Firebase akan jadi sumber.
   ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
const DEFAULT_SIKLUS = [
{
  id: 'siklus-1', nama: 'Siklus I ‚Äî Wisuda April', icon: 'üå±',
  wisuda: { label: 'Wisuda I', tanggal: '2026-04-25', color: 'emerald' },
  tahapan: [
    { id:'s1-t1', label:'Seleksi & Persetujuan Judul', icon:'üîç', mulai:'2025-09-01', selesai:'2025-10-31', color:'emerald', desc:'Pengajuan dan persetujuan judul skripsi oleh pembimbing dan kaprodi' },
    { id:'s1-t2', label:'Penulisan & Bimbingan Proposal', icon:'üìù', mulai:'2025-11-01', selesai:'2025-12-15', color:'blue', desc:'Penyusunan Bab I‚ÄìIII dengan minimal 8 pertemuan bimbingan resmi' },
    { id:'s1-t3', label:'Seminar Proposal', icon:'üé§', mulai:'2026-01-05', selesai:'2026-01-23', color:'violet', desc:'Presentasi dan uji kelayakan proposal di hadapan tim penguji' },
    { id:'s1-t4', label:'Penelitian & Penulisan Skripsi', icon:'üî¨', mulai:'2026-01-26', selesai:'2026-02-28', color:'amber', desc:'Pengumpulan data lapangan, analisis, dan penyusunan Bab IV‚ÄìV' },
    { id:'s1-t5', label:'Seminar Hasil Penelitian', icon:'üìä', mulai:'2026-03-02', selesai:'2026-03-13', color:'orange', desc:'Pemaparan temuan dan hasil penelitian kepada dosen penguji' },
    { id:'s1-t6', label:'Ujian Munaqasyah', icon:'üèõÔ∏è', mulai:'2026-03-16', selesai:'2026-03-27', color:'rose', desc:'Ujian komprehensif dan pertanggungjawaban skripsi final' },
    { id:'s1-t7', label:'Yudisium Siklus I', icon:'üéì', mulai:'2026-04-06', selesai:'2026-04-10', color:'teal', desc:'Penetapan kelulusan dan penganugerahan gelar sarjana Siklus I' },
    { id:'s1-t8', label:'Wisuda I', icon:'üèÖ', mulai:'2026-04-25', selesai:'2026-04-25', color:'purple', desc:'Upacara wisuda periode pertama Universitas Islam Negeri Sultan Idad Samarinda' },
  ]
},
{
  id: 'siklus-2', nama: 'Siklus II ‚Äî Wisuda Agustus', icon: '‚òÄÔ∏è',
  wisuda: { label: 'Wisuda II', tanggal: '2026-08-22', color: 'blue' },
  tahapan: [
    { id:'s2-t1', label:'Seleksi & Persetujuan Judul', icon:'üîç', mulai:'2026-01-05', selesai:'2026-02-28', color:'emerald', desc:'Pengajuan dan persetujuan judul skripsi oleh pembimbing dan kaprodi' },
    { id:'s2-t2', label:'Penulisan & Bimbingan Proposal', icon:'üìù', mulai:'2026-03-02', selesai:'2026-04-17', color:'blue', desc:'Penyusunan Bab I‚ÄìIII dengan minimal 8 pertemuan bimbingan resmi' },
    { id:'s2-t3', label:'Seminar Proposal', icon:'üé§', mulai:'2026-04-20', selesai:'2026-05-08', color:'violet', desc:'Presentasi dan uji kelayakan proposal di hadapan tim penguji' },
    { id:'s2-t4', label:'Penelitian & Penulisan Skripsi', icon:'üî¨', mulai:'2026-05-11', selesai:'2026-06-26', color:'amber', desc:'Pengumpulan data lapangan, analisis, dan penyusunan Bab IV‚ÄìV' },
    { id:'s2-t5', label:'Seminar Hasil Penelitian', icon:'üìä', mulai:'2026-06-29', selesai:'2026-07-10', color:'orange', desc:'Pemaparan temuan dan hasil penelitian kepada dosen penguji' },
    { id:'s2-t6', label:'Ujian Munaqasyah', icon:'üèõÔ∏è', mulai:'2026-07-13', selesai:'2026-07-24', color:'rose', desc:'Ujian komprehensif dan pertanggungjawaban skripsi final' },
    { id:'s2-t7', label:'Yudisium Siklus II', icon:'üéì', mulai:'2026-08-03', selesai:'2026-08-07', color:'teal', desc:'Penetapan kelulusan dan penganugerahan gelar sarjana Siklus II' },
    { id:'s2-t8', label:'Wisuda II', icon:'üèÖ', mulai:'2026-08-22', selesai:'2026-08-22', color:'purple', desc:'Upacara wisuda periode kedua Universitas Islam Negeri Sultan Idad Samarinda' },
  ]
},
{
  id: 'siklus-3', nama: 'Siklus III ‚Äî Wisuda Desember', icon: '‚ùÑÔ∏è',
  wisuda: { label: 'Wisuda III', tanggal: '2026-12-12', color: 'purple' },
  tahapan: [
    { id:'s3-t1', label:'Seleksi & Persetujuan Judul', icon:'üîç', mulai:'2026-05-01', selesai:'2026-06-30', color:'emerald', desc:'Pengajuan dan persetujuan judul skripsi oleh pembimbing dan kaprodi' },
    { id:'s3-t2', label:'Penulisan & Bimbingan Proposal', icon:'üìù', mulai:'2026-07-01', selesai:'2026-08-14', color:'blue', desc:'Penyusunan Bab I‚ÄìIII dengan minimal 8 pertemuan bimbingan resmi' },
    { id:'s3-t3', label:'Seminar Proposal', icon:'üé§', mulai:'2026-08-17', selesai:'2026-09-04', color:'violet', desc:'Presentasi dan uji kelayakan proposal di hadapan tim penguji' },
    { id:'s3-t4', label:'Penelitian & Penulisan Skripsi', icon:'üî¨', mulai:'2026-09-07', selesai:'2026-10-16', color:'amber', desc:'Pengumpulan data lapangan, analisis, dan penyusunan Bab IV‚ÄìV' },
    { id:'s3-t5', label:'Seminar Hasil Penelitian', icon:'üìä', mulai:'2026-10-19', selesai:'2026-10-30', color:'orange', desc:'Pemaparan temuan dan hasil penelitian kepada dosen penguji' },
    { id:'s3-t6', label:'Ujian Munaqasyah', icon:'üèõÔ∏è', mulai:'2026-11-02', selesai:'2026-11-13', color:'rose', desc:'Ujian komprehensif dan pertanggungjawaban skripsi final' },
    { id:'s3-t7', label:'Yudisium Siklus III', icon:'üéì', mulai:'2026-11-23', selesai:'2026-11-27', color:'teal', desc:'Penetapan kelulusan dan penganugerahan gelar sarjana Siklus III' },
    { id:'s3-t8', label:'Wisuda III', icon:'üèÖ', mulai:'2026-12-12', selesai:'2026-12-12', color:'purple', desc:'Upacara wisuda periode ketiga Universitas Islam Negeri Sultan Idad Samarinda' },
  ]
},
];

/* ‚îÄ‚îÄ Ambil data dari Firebase atau pakai default ‚îÄ‚îÄ */
const rawData = kalenderAkademik;
const SIKLUS = (rawData && rawData.siklus && rawData.siklus.length > 0)
  ? rawData.siklus
  : DEFAULT_SIKLUS;
const allTahapan = SIKLUS.flatMap(s => s.tahapan || []);

/* ‚îÄ‚îÄ colorMap ‚îÄ‚îÄ */
const colorMap = {
emerald:{ bg:'bg-emerald-500',text:'text-emerald-700',badge:'bg-emerald-100 text-emerald-800',light:'bg-emerald-50',border:'border-emerald-400' },
blue:   { bg:'bg-blue-500',   text:'text-blue-700',   badge:'bg-blue-100 text-blue-800',   light:'bg-blue-50',   border:'border-blue-400' },
violet: { bg:'bg-violet-500', text:'text-violet-700', badge:'bg-violet-100 text-violet-800', light:'bg-violet-50', border:'border-violet-400' },
amber:  { bg:'bg-amber-500',  text:'text-amber-700',  badge:'bg-amber-100 text-amber-800',  light:'bg-amber-50',  border:'border-amber-400' },
orange: { bg:'bg-orange-500', text:'text-orange-700', badge:'bg-orange-100 text-orange-800', light:'bg-orange-50', border:'border-orange-400' },
rose:   { bg:'bg-rose-500',   text:'text-rose-700',   badge:'bg-rose-100 text-rose-800',   light:'bg-rose-50',   border:'border-rose-400' },
teal:   { bg:'bg-teal-500',   text:'text-teal-700',   badge:'bg-teal-100 text-teal-800',   light:'bg-teal-50',   border:'border-teal-400' },
purple: { bg:'bg-purple-500', text:'text-purple-700', badge:'bg-purple-100 text-purple-800', light:'bg-purple-50', border:'border-purple-400' },
};
const siklusHeaderCls = ['siklus-header-1','siklus-header-2','siklus-header-3'];
const siklsBadgeCls   = ['siklus-badge-1','siklus-badge-2','siklus-badge-3'];

/* ‚îÄ‚îÄ State ‚îÄ‚îÄ */
const [now, setNow]               = React.useState(new Date());
const [activeSiklus, setActiveSiklus] = React.useState(0);
const [expandedId, setExpandedId] = React.useState(null);
const [showEditModal, setShowEditModal] = React.useState(false);
const canEdit = userRole === 'admin' || userRole === 'operator';

React.useEffect(() => { const t = setInterval(() => setNow(new Date()), 1000); return () => clearInterval(t); }, []);

/* Auto-select siklus yang sedang aktif */
React.useEffect(() => {
const idx = SIKLUS.findIndex(s => {
if (!s.tahapan || s.tahapan.length === 0) return false;
const firstStart = new Date(s.tahapan[0].mulai + 'T00:00:00');
const lastEnd    = new Date(s.tahapan[s.tahapan.length-1].selesai + 'T23:59:59');
return now >= firstStart && now <= lastEnd;
});
if (idx >= 0) setActiveSiklus(idx);
else {
const futureIdx = SIKLUS.findIndex(s => s.tahapan && s.tahapan.length > 0 && new Date(s.tahapan[0].mulai + 'T00:00:00') > now);
if (futureIdx >= 0) setActiveSiklus(futureIdx);
}
}, []);

/* ‚îÄ‚îÄ Helpers ‚îÄ‚îÄ */
const parseDate    = (s) => new Date(s + 'T00:00:00');
const fmtDate      = (s) => parseDate(s).toLocaleDateString('id-ID', { day:'numeric', month:'short', year:'numeric' });
const fmtDateShort = (s) => parseDate(s).toLocaleDateString('id-ID', { day:'numeric', month:'short' });

const getStatus = (t) => {
const start = parseDate(t.mulai);
const end   = parseDate(t.selesai); end.setHours(23,59,59);
if (now > end)    return 'done';
if (now >= start) return 'now';
const d = Math.ceil((start - now) / 86400000);
return d <= 21 ? 'urgent' : 'upcoming';
};

const getDaysLeft = (t) => {
const st = getStatus(t);
if (st === 'done') return null;
const target = st === 'now' ? parseDate(t.selesai) : parseDate(t.mulai);
target.setHours(23,59,59);
return Math.max(0, Math.ceil((target - now) / 86400000));
};

const getElapsed = (t) => {
const s = parseDate(t.mulai), e = parseDate(t.selesai); e.setHours(23,59,59);
return Math.min(100, Math.max(0, Math.round((now-s)/(e-s)*100)));
};

const getDurasi = (t) => Math.ceil((parseDate(t.selesai)-parseDate(t.mulai))/86400000)+1;

/* ‚îÄ‚îÄ Per-siklus stats ‚îÄ‚îÄ */
const getSiklusStats = (s) => {
const list = s.tahapan || [];
const done = list.filter(t => getStatus(t) === 'done').length;
const active = list.find(t => getStatus(t) === 'now');
const pct = list.length ? Math.round(done/list.length*100) : 0;
return { done, total: list.length, active, pct };
};

/* ‚îÄ‚îÄ All-siklus stats ‚îÄ‚îÄ */
const totalTahapan = allTahapan.length;
const doneTahapan  = allTahapan.filter(t => getStatus(t) === 'done').length;
const overallPct   = totalTahapan ? Math.round(doneTahapan/totalTahapan*100) : 0;

/* ‚îÄ‚îÄ Clock ‚îÄ‚îÄ */
const hh = String(now.getHours()).padStart(2,'0');
const mm = String(now.getMinutes()).padStart(2,'0');
const ss = String(now.getSeconds()).padStart(2,'0');
const DAYS = ['Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu'];
const MONS = ['Januari','Februari','Maret','April','Mei','Juni','Juli','Agustus','September','Oktober','November','Desember'];
const clockStr = `${DAYS[now.getDay()]}, ${now.getDate()} ${MONS[now.getMonth()]} ${now.getFullYear()}`;

/* ‚îÄ‚îÄ Current siklus data ‚îÄ‚îÄ */
const curSiklus   = SIKLUS[activeSiklus] || SIKLUS[0];
const curTahapan  = curSiklus?.tahapan || [];
const curStats    = getSiklusStats(curSiklus);
const focusTahapan = curTahapan.find(t => getStatus(t) === 'now')
|| curTahapan.find(t => getStatus(t) === 'urgent')
|| curTahapan.find(t => getStatus(t) === 'upcoming');
const lastUpdate = rawData?.updatedAt
? new Date(rawData.updatedAt).toLocaleDateString('id-ID',{day:'numeric',month:'short',year:'numeric'})
: null;



/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   MAIN WIDGET RENDER
   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
return (
<>
{showEditModal && canEdit && <KalenderEditModal siklus={SIKLUS} onSave={onSaveKalender} onClose={()=>setShowEditModal(false)} lastUpdate={lastUpdate} updatedBy={rawData?.updatedBy} />}
<div className="bg-white rounded-2xl shadow-sm overflow-hidden border border-gray-100">

{/* ‚îÄ‚îÄ Header ‚îÄ‚îÄ */}
<div className={`${siklusHeaderCls[activeSiklus] || 'siklus-header-1'} px-5 py-4`}>
<div className="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3">
<div>
<h3 className="text-base font-black text-white flex items-center gap-2 flex-wrap">
<span className="text-xl">üóìÔ∏è</span>
Kalender Akademik Skripsi
<span className="text-xs font-semibold bg-white/20 text-white px-2 py-0.5 rounded-full">FEBI UINSI {now.getFullYear()}</span>
{lastUpdate && <span className="text-[10px] bg-white/10 text-white/70 px-2 py-0.5 rounded-full">Diperbarui: {lastUpdate}</span>}
</h3>
<p className="text-white/80 text-xs mt-0.5">3 Siklus Wisuda ¬∑ Monitoring tahapan penyelesaian karya akhir secara real-time</p>
</div>
{/* Clock + edit button */}
<div className="flex items-center gap-2">
<div className="bg-white/10 rounded-xl px-4 py-2 border border-white/20 text-center">
<div className="flex items-center gap-0.5">
<span className="text-white font-black text-lg tabular-nums">{hh}</span>
<span className="text-white/60 font-black text-lg clock-colon">:</span>
<span className="text-white font-black text-lg tabular-nums">{mm}</span>
<span className="text-white/60 font-black text-lg clock-colon">:</span>
<span className="text-white/70 font-bold text-base tabular-nums">{ss}</span>
</div>
<p className="text-white/60 text-[10px] mt-0.5">{clockStr}</p>
</div>
{canEdit && (
<button onClick={()=>setShowEditModal(true)}
className="bg-white/20 hover:bg-white/30 border border-white/30 text-white px-3 py-2 rounded-xl text-xs font-bold transition-all flex items-center gap-1.5 hover:scale-105">
‚úèÔ∏è Edit Kalender
</button>
)}
</div>
</div>

{/* Overall progress */}
<div className="mt-3">
<div className="flex justify-between text-[10px] text-white/70 mb-1">
<span>Progress keseluruhan {now.getFullYear()} ({doneTahapan}/{totalTahapan} tahapan)</span>
<span className="font-bold text-white">{overallPct}%</span>
</div>
<div className="w-full h-2 bg-white/20 rounded-full overflow-hidden">
<div className="h-full bg-white/80 rounded-full transition-all duration-1000" style={{width:`${overallPct}%`}}></div>
</div>
</div>
</div>

{/* ‚îÄ‚îÄ Siklus Tabs ‚îÄ‚îÄ */}
<div className="flex gap-0 border-b border-gray-200 overflow-x-auto">
{SIKLUS.map((s, i) => {
const st = getSiklusStats(s);
return (
<button key={s.id} onClick={()=>{ setActiveSiklus(i); setExpandedId(null); }}
className={`flex-1 min-w-[120px] px-3 py-3 text-center transition-all border-b-2 ${
activeSiklus===i
? 'border-emerald-600 bg-emerald-50'
: 'border-transparent hover:bg-gray-50'
}`}>
<div className="flex items-center justify-center gap-1.5 mb-0.5">
<span className="text-base">{s.icon}</span>
<span className={`text-xs font-bold ${activeSiklus===i ? 'text-emerald-700' : 'text-gray-600'}`}>{s.wisuda?.label || `Siklus ${i+1}`}</span>
</div>
<div className="flex items-center justify-center gap-1">
<div className="w-16 h-1 bg-gray-200 rounded-full overflow-hidden">
<div className={`h-full rounded-full transition-all ${activeSiklus===i ? 'bg-emerald-500' : 'bg-gray-400'}`} style={{width:`${st.pct}%`}}></div>
</div>
<span className={`text-[9px] font-bold ${activeSiklus===i ? 'text-emerald-600' : 'text-gray-400'}`}>{st.pct}%</span>
</div>
<p className="text-[9px] text-gray-400 mt-0.5">{s.wisuda?.tanggal ? fmtDateShort(s.wisuda.tanggal) : '‚Äî'}</p>
</button>
);
})}
</div>

{/* ‚îÄ‚îÄ Body: focus card + timeline ‚îÄ‚îÄ */}
<div className="p-5 grid lg:grid-cols-5 gap-5">

{/* LEFT: Fokus aktif + wisuda countdown + greeting */}
<div className="lg:col-span-2 flex flex-col gap-3">

{/* Wisuda countdown card */}
{curSiklus?.wisuda?.tanggal && (() => {
const wDate = parseDate(curSiklus.wisuda.tanggal); wDate.setHours(23,59,59);
const daysToWisuda = Math.max(0, Math.ceil((wDate - now) / 86400000));
const wisudaDone = now > wDate;
const isNear = daysToWisuda <= 30 && !wisudaDone;
return (
<div className={`rounded-2xl p-4 border-2 text-center ${wisudaDone ? 'bg-gray-50 border-gray-200' : isNear ? 'bg-amber-50 border-amber-300' : 'bg-blue-50 border-blue-200'}`}>
<p className="text-xs font-bold text-gray-500 mb-1">{curSiklus.wisuda?.label || 'Wisuda'}</p>
<p className="text-xs text-gray-600 mb-2">{fmtDate(curSiklus.wisuda.tanggal)}</p>
{wisudaDone ? (
<p className="text-2xl font-black text-gray-400">‚úÖ Selesai</p>
) : (
<>
<p className={`text-3xl font-black countdown-digit ${isNear ? 'text-amber-600' : 'text-blue-600'}`}>{daysToWisuda}</p>
<p className={`text-xs font-semibold ${isNear ? 'text-amber-500' : 'text-blue-400'}`}>hari lagi</p>
{isNear && <p className="text-[10px] text-amber-500 mt-1 font-bold">‚ö° Segera!</p>}
</>
)}
</div>
);
})()}

{/* Tahapan aktif / focus */}
{focusTahapan ? (() => {
const st = getStatus(focusTahapan);
const days = getDaysLeft(focusTahapan);
const pct  = st === 'now' ? getElapsed(focusTahapan) : 0;
const isNow = st === 'now';
return (
<div className={`rounded-2xl p-4 border-2 ${isNow ? 'border-emerald-300 bg-emerald-50' : 'border-amber-200 bg-amber-50'}`}>
<span className={`text-[10px] font-bold px-2 py-0.5 rounded-full ${isNow ? 'bg-emerald-600 text-white' : 'bg-amber-500 text-white'}`}>
{isNow ? 'üü¢ Berlangsung' : '‚è∞ Segera'}
</span>
<p className="text-sm font-black text-gray-900 mt-2 mb-1">{focusTahapan.icon} {focusTahapan.label}</p>
<p className="text-[11px] text-gray-500 mb-3 leading-relaxed">{focusTahapan.desc}</p>
<div className="grid grid-cols-2 gap-2 mb-2">
<div className="bg-white/80 rounded-lg p-2 text-center">
<p className="text-[9px] text-gray-400">{isNow ? 'Berakhir' : 'Dimulai'}</p>
<p className="text-xs font-bold text-gray-800">{fmtDate(isNow ? focusTahapan.selesai : focusTahapan.mulai)}</p>
</div>
<div className={`rounded-lg p-2 text-center ${isNow ? 'bg-emerald-600' : 'bg-amber-500'}`}>
<p className="text-[9px] text-white/80">{isNow ? 'Sisa' : 'Mulai'}</p>
<p className="text-lg font-black text-white countdown-digit">{days}</p>
<p className="text-[9px] text-white/70">hari</p>
</div>
</div>
{isNow && (
<div>
<div className="flex justify-between text-[9px] text-gray-400 mb-1"><span>Progres periode</span><span className="font-bold text-emerald-700">{pct}%</span></div>
<div className="w-full h-1.5 bg-white/60 rounded-full overflow-hidden">
<div className="h-full bg-emerald-500 rounded-full transition-all" style={{width:`${pct}%`}}></div>
</div>
</div>
)}
</div>
);
})() : (
<div className="rounded-2xl p-4 bg-purple-50 border-2 border-purple-200 text-center">
<p className="text-2xl mb-1">üèÖ</p>
<p className="text-xs font-bold text-purple-800">Seluruh tahapan siklus ini selesai!</p>
</div>
)}

{/* Greeting */}
<div className="rounded-2xl bg-gray-50 border border-gray-200 p-4">
<p className="text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-0.5">Selamat Datang</p>
<p className="shimmer-text text-sm font-black mb-0.5">{currentUser?.nama || 'Civitas FEBI'}</p>
<p className="text-[11px] text-gray-500 mb-3 capitalize">
{userRole==='mahasiswa'?'üéì Mahasiswa':userRole==='dosen'?'üë®‚Äçüè´ Dosen Pembimbing':userRole==='operator'?'üñ•Ô∏è Operator':'‚öôÔ∏è Administrator'} FEBI UINSI
</p>
<div className="space-y-1.5">
{userRole==='mahasiswa'&&<button onClick={()=>onNavigate('proposal')} className="w-full text-left text-xs bg-emerald-600 hover:bg-emerald-700 text-white px-3 py-1.5 rounded-lg font-semibold transition-all flex items-center gap-2">üìù Ajukan Proposal</button>}
{(userRole==='dosen'||userRole==='mahasiswa')&&<button onClick={()=>onNavigate('bimbingan')} className="w-full text-left text-xs bg-white hover:bg-emerald-50 text-emerald-700 border border-emerald-200 px-3 py-1.5 rounded-lg font-semibold transition-all flex items-center gap-2">üìã Lihat Bimbingan</button>}
{(userRole==='admin'||userRole==='operator')&&<button onClick={()=>onNavigate('proposal')} className="w-full text-left text-xs bg-white hover:bg-blue-50 text-blue-700 border border-blue-200 px-3 py-1.5 rounded-lg font-semibold transition-all flex items-center gap-2">‚úÖ Validasi Proposal</button>}
</div>
</div>
</div>

{/* RIGHT: Timeline tahapan siklus aktif */}
<div className="lg:col-span-3">
<div className="flex items-center justify-between mb-3">
<p className="text-xs font-bold text-gray-500 uppercase tracking-widest">Timeline ‚Äî {curSiklus?.nama}</p>
<span className={`text-[10px] font-bold px-2 py-1 rounded-full ${siklsBadgeCls[activeSiklus]||'siklus-badge-1'}`}>
{curStats.done}/{curStats.total} selesai ¬∑ {curStats.pct}%
</span>
</div>
<div className="space-y-1.5">
{curTahapan.map((t) => {
const st = getStatus(t);
const days = getDaysLeft(t);
const pct  = getElapsed(t);
const dur  = getDurasi(t);
const isExp = expandedId === t.id;
const rowClass = st==='now'?'tahapan-now':st==='done'?'tahapan-done':st==='urgent'?'tahapan-urgent':'tahapan-upcoming';
const statusInfo = st==='now'?{text:'Berlangsung',cls:'bg-emerald-600 text-white'}:st==='done'?{text:'Selesai ‚úì',cls:'bg-gray-300 text-gray-600'}:st==='urgent'?{text:'Segera',cls:'bg-amber-500 text-white'}:{text:'Mendatang',cls:'bg-gray-200 text-gray-500'};
return (
<div key={t.id} className={`tahapan-item ${rowClass} rounded-xl overflow-hidden`} onClick={()=>setExpandedId(isExp?null:t.id)}>
<div className="flex items-center gap-2.5 px-3 py-2 cursor-pointer">
<div className={`w-7 h-7 rounded-full flex items-center justify-center flex-shrink-0 text-sm ${st==='done'?'bg-gray-200':st==='now'?'bg-emerald-100':st==='urgent'?'bg-amber-100':'bg-gray-100'}`}>
{st==='done'?'‚úÖ':t.icon}
</div>
<div className="flex-1 min-w-0">
<div className="flex items-center gap-1.5 flex-wrap">
<p className={`text-xs font-bold truncate ${st==='done'?'text-gray-400 line-through':'text-gray-800'}`}>{t.label}</p>
<span className={`text-[9px] font-bold px-1.5 py-0.5 rounded-full whitespace-nowrap ${statusInfo.cls}`}>{statusInfo.text}</span>
</div>
<p className="text-[9px] text-gray-400 mt-0.5">{fmtDateShort(t.mulai)} ‚Äì {fmtDateShort(t.selesai)} ¬∑ {dur} hari</p>
{st==='now'&&<div className="mt-1 w-full h-1 bg-emerald-100 rounded-full overflow-hidden"><div className="h-full bg-emerald-500 rounded-full" style={{width:`${pct}%`}}></div></div>}
</div>
<div className="flex-shrink-0 text-right">
{st==='done'?<span className="text-gray-300">‚úì</span>:(
<div className="text-center">
<p className={`text-sm font-black tabular-nums ${st==='now'?'text-emerald-700':st==='urgent'?'text-amber-700':'text-gray-400'}`}>{days}</p>
<p className="text-[9px] text-gray-400">{st==='now'?'hr sisa':'hr lagi'}</p>
</div>
)}
</div>
<span className={`text-gray-300 text-[10px] transition-transform duration-200 ${isExp?'rotate-180':''}`}>‚ñº</span>
</div>
{isExp&&(
<div className="px-4 pb-3 pt-1 border-t border-black/5">
<p className="text-[11px] text-gray-600 leading-relaxed mb-2">{t.desc}</p>
<div className="flex gap-3 flex-wrap">
{[['Mulai',fmtDate(t.mulai)],['Selesai',fmtDate(t.selesai)],[`Durasi`,`${dur} hari`],...(st==='now'?[['Progres',`${pct}%`]]:[])].map(([k,v])=>(
<div key={k} className="text-center">
<p className="text-[9px] text-gray-400">{k}</p>
<p className="text-xs font-bold text-gray-700">{v}</p>
</div>
))}
</div>
</div>
)}
</div>
);
})}
</div>
</div>
</div>
</div>
</>
);
})()}
<div className="bg-white rounded-2xl shadow-sm p-6">
<h3 className="text-lg font-bold text-emerald-900 mb-4">üìä Aktivitas Terbaru</h3>
<div className="space-y-3">
{proposalsArr.slice(0, 5).map((p, i) => (
<div key={i} className="p-3 bg-gray-50 rounded-lg border flex items-center justify-between">
<div className="flex items-center gap-3">
<div className="w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center">
<span className="text-lg">üìù</span>
</div>
<div>
<p className="font-semibold text-sm">{p.judul?.substring(0, 40) || 'Proposal Baru'}</p>
<p className="text-xs text-gray-500">{p.mahasiswaNama || 'Mahasiswa'}</p>
</div>
</div>
<span className={`px-3 py-1 rounded-full text-xs font-semibold ${
p.status === 'Diterima' ? 'bg-green-100 text-green-700' :
p.status === 'Ditolak' ? 'bg-red-100 text-red-700' :
p.status === 'Diperbaiki' ? 'bg-yellow-100 text-yellow-700' :
'bg-blue-100 text-blue-700'
}`}>
{p.status || 'Menunggu'}
</span>
</div>
))}
{proposalsArr.length === 0 && (
<div className="text-center py-8 text-gray-400">
<p className="text-4xl mb-2">üì≠</p>
<p className="text-sm">Belum ada aktivitas</p>
</div>
)}
</div>
</div>
</div>
);
};

// ============================================
// PROPOSAL PAGE - DENGAN PAGINATION
// ============================================
const ProposalPage = ({ proposals, userRole, currentUser, onAdd, onEdit, onDelete, dosenList, mahasiswaList, onCheckSimilarity, similarityResult, onMulaiBimbingan, bimbinganArr, onNavigate }) => {
const [searchTerm, setSearchTerm] = React.useState('');
const [filterStatus, setFilterStatus] = React.useState('');
const [filterProdi, setFilterProdi] = React.useState('');
const [sortBy, setSortBy] = React.useState('tanggal');
const [sortOrder, setSortOrder] = React.useState('desc');
const [selectedProposal, setSelectedProposal] = React.useState(null);
const [showDetailModal, setShowDetailModal] = React.useState(false);
const [currentPage, setCurrentPage] = React.useState(1);
const ITEMS_PER_PAGE = 15;

// Filter proposals berdasarkan role dan filter
const filteredProposals = React.useMemo(() => {
let filtered = userRole === 'mahasiswa'
? proposals.filter(p => p.nim === currentUser?.nim)
: userRole === 'dosen'
? proposals.filter(p => p.pembimbing1 === currentUser?.nama || p.pembimbing2 === currentUser?.nama)
: proposals;

// Apply search
if (searchTerm) {
filtered = filtered.filter(p => 
p.judul?.toLowerCase().includes(searchTerm.toLowerCase()) ||
p.mahasiswaNama?.toLowerCase().includes(searchTerm.toLowerCase()) ||
p.nim?.toLowerCase().includes(searchTerm.toLowerCase()) ||
p.pembimbing1?.toLowerCase().includes(searchTerm.toLowerCase()) ||
(p.pembimbing2 && p.pembimbing2 !== '-' && p.pembimbing2.toLowerCase().includes(searchTerm.toLowerCase()))
);
}

// Apply status filter
if (filterStatus) {
filtered = filtered.filter(p => {
if (filterStatus === 'Menunggu') return !p.status || p.status === 'Menunggu';
return p.status === filterStatus;
});
}

// Apply prodi filter
if (filterProdi) {
filtered = filtered.filter(p => p.prodi === filterProdi);
}

// Apply sorting
filtered.sort((a, b) => {
let aVal, bVal;
switch(sortBy) {
case 'judul':
aVal = a.judul || '';
bVal = b.judul || '';
break;
case 'mahasiswa':
aVal = a.mahasiswaNama || '';
bVal = b.mahasiswaNama || '';
break;
case 'status':
aVal = a.status || '';
bVal = b.status || '';
break;
case 'tanggal':
default:
aVal = a.tanggalPengajuan || a.createdAt || '';
bVal = b.tanggalPengajuan || b.createdAt || '';
}

if (sortOrder === 'asc') {
return aVal > bVal ? 1 : -1;
} else {
return aVal < bVal ? 1 : -1;
}
});

return filtered;
}, [proposals, userRole, currentUser, searchTerm, filterStatus, filterProdi, sortBy, sortOrder]);

// Reset ke halaman 1 saat filter berubah
React.useEffect(() => {
setCurrentPage(1);
}, [searchTerm, filterStatus, filterProdi, sortBy, sortOrder]);

const totalPages = Math.ceil(filteredProposals.length / ITEMS_PER_PAGE);
const paginatedProposals = filteredProposals.slice(
(currentPage - 1) * ITEMS_PER_PAGE,
currentPage * ITEMS_PER_PAGE
);

const canAdd = userRole === 'mahasiswa' || userRole === 'admin' || userRole === 'operator';
const canEdit = userRole === 'admin' || userRole === 'operator';
const canDelete = userRole === 'admin'; // Only admin can delete

// Cek apakah bimbingan sudah ada untuk dosen tertentu
const getBimbinganForDosen = (proposal, dosenNama) => {
return bimbinganArr.find(b => b.nim === proposal.nim && b.judul === proposal.judul && b.dosenNama === dosenNama);
};

// Format tanggal
const formatDate = (dateStr) => {
if (!dateStr) return '-';
const date = new Date(dateStr);
return date.toLocaleDateString('id-ID', { day: 'numeric', month: 'short', year: 'numeric' });
};

// Get status color and icon
const getStatusInfo = (status) => {
switch(status) {
case 'Diterima':
return { color: 'bg-green-100 text-green-700 border-green-300', icon: '‚úÖ' };
case 'Ditolak':
return { color: 'bg-red-100 text-red-700 border-red-300', icon: '‚ùå' };
case 'Diperbaiki':
return { color: 'bg-yellow-100 text-yellow-700 border-yellow-300', icon: '‚ö†Ô∏è' };
default:
return { color: 'bg-blue-100 text-blue-700 border-blue-300', icon: '‚è≥' };
}
};

const handleViewDetail = (proposal) => {
setSelectedProposal(proposal);
setShowDetailModal(true);
};

// Detail Modal Component
const DetailModal = ({ proposal, onClose }) => {
if (!proposal) return null;
const statusInfo = getStatusInfo(proposal.status);

return (
<div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4" onClick={onClose}>
<div className="bg-white rounded-2xl p-6 max-w-3xl w-full max-h-[90vh] overflow-y-auto" onClick={(e) => e.stopPropagation()}>
<div className="flex justify-between items-start mb-6">
<h2 className="text-2xl font-bold text-emerald-900 flex items-center gap-2">
<span className="text-3xl">üìÑ</span> Detail Proposal
</h2>
<button onClick={onClose} className="p-2 hover:bg-gray-100 rounded-lg text-xl">‚úï</button>
</div>

<div className="space-y-6">
{/* Header Status */}
<div className="flex items-center justify-between bg-gray-50 p-4 rounded-xl">
<div>
<p className="text-sm text-gray-600">Status Proposal</p>
<div className="flex items-center gap-2 mt-1">
<span className={`px-4 py-2 rounded-full text-sm font-semibold ${statusInfo.color}`}>
{statusInfo.icon} {proposal.status}
</span>
</div>
</div>
<div className="text-right">
<p className="text-sm text-gray-600">Tanggal Pengajuan</p>
<p className="font-semibold">{formatDate(proposal.tanggalPengajuan || proposal.createdAt)}</p>
</div>
</div>

{/* Judul */}
<div className="border-b pb-4">
<h3 className="text-xl font-bold text-gray-900">{proposal.judul}</h3>
</div>

{/* Informasi Mahasiswa */}
<div className="grid md:grid-cols-2 gap-4">
<div className="bg-emerald-50 p-4 rounded-xl">
<h4 className="font-semibold text-emerald-800 mb-3 flex items-center gap-2">
<span>üë§</span> Data Mahasiswa
</h4>
<div className="space-y-2">
<div className="flex justify-between">
<span className="text-sm text-gray-600">Nama</span>
<span className="text-sm font-medium">{proposal.mahasiswaNama}</span>
</div>
<div className="flex justify-between">
<span className="text-sm text-gray-600">NIM</span>
<span className="text-sm font-medium">{proposal.nim}</span>
</div>
<div className="flex justify-between">
<span className="text-sm text-gray-600">Program Studi</span>
<span className="text-sm font-medium">{proposal.prodi}</span>
</div>
<div className="flex justify-between">
<span className="text-sm text-gray-600">WhatsApp</span>
<span className="text-sm font-medium">{proposal.whatsapp}</span>
</div>
</div>
</div>

<div className="bg-blue-50 p-4 rounded-xl">
<h4 className="font-semibold text-blue-800 mb-3 flex items-center gap-2">
<span>üë®‚Äçüè´</span> Data Pembimbing
</h4>
<div className="space-y-3">
<div className="p-2 bg-white rounded-lg">
<div className="flex items-center gap-2 mb-1">
<span className="pembimbing-badge pembimbing-badge-1">Pembimbing 1</span>
</div>
<p className="font-medium">{proposal.pembimbing1}</p>
</div>
{proposal.pembimbing2 && proposal.pembimbing2 !== '-' && (
<div className="p-2 bg-white rounded-lg">
<div className="flex items-center gap-2 mb-1">
<span className="pembimbing-badge pembimbing-badge-2">Pembimbing 2</span>
</div>
<p className="font-medium">{proposal.pembimbing2}</p>
</div>
)}
</div>
</div>
</div>

{/* Abstrak */}
<div className="border rounded-xl p-4">
<h4 className="font-semibold text-gray-800 mb-2 flex items-center gap-2">
<span>üìù</span> Abstrak
</h4>
<p className="text-gray-700 leading-relaxed whitespace-pre-line">{proposal.abstrak}</p>
</div>

{/* Catatan Validasi */}
{proposal.catatan && (
<div className="bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-r-xl">
<h4 className="font-semibold text-yellow-800 mb-1 flex items-center gap-2">
<span>üìå</span> Catatan Validasi
</h4>
<p className="text-yellow-700">{proposal.catatan}</p>
</div>
)}

{/* Metadata */}
<div className="text-xs text-gray-400 border-t pt-4">
<p>ID Proposal: {proposal.id}</p>
<p>Tahun Akademik: {proposal.tahun}</p>
</div>
</div>
</div>
</div>
);
};

return (
<div className="space-y-6">
{/* Header */}
<div className="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
<div>
<h2 className="text-2xl font-bold text-emerald-900 flex items-center gap-2">
<span>üìù</span> Pengajuan Proposal Skripsi
</h2>
<p className="text-sm text-gray-600 mt-1">
Total {filteredProposals.length} proposal {filteredProposals.length !== proposals.length && `(dari ${proposals.length} total)`}
</p>
</div>
{canAdd && (
<button onClick={onAdd} className="px-4 py-2 bg-emerald-600 text-white rounded-xl font-semibold hover:bg-emerald-700 transition-all flex items-center gap-2 shadow-lg hover:shadow-xl">
<span>‚ûï</span> Ajukan Proposal Baru
</button>
)}
</div>

{/* ‚îÄ‚îÄ Statistik Proposal ‚îÄ‚îÄ */}
<div className="grid grid-cols-2 md:grid-cols-4 gap-4">
{/* Card 1 ‚Äì Total Proposal */}
<div className="relative overflow-hidden bg-gradient-to-br from-emerald-500 to-teal-600 rounded-2xl shadow-lg p-5 text-white">
<div className="absolute -top-4 -right-4 w-20 h-20 bg-white/10 rounded-full"></div>
<div className="absolute -bottom-6 -right-2 w-16 h-16 bg-white/10 rounded-full"></div>
<p className="text-sm font-medium opacity-90 mb-1">üìù Total Proposal</p>
<p className="text-4xl font-black">{proposals.length}</p>
<p className="text-xs opacity-75 mt-1">Seluruh pengajuan</p>
<div className="mt-3 h-1.5 bg-white/20 rounded-full overflow-hidden">
<div className="h-full bg-white/60 rounded-full" style={{width: '100%'}}></div>
</div>
</div>
{/* Card 2 ‚Äì Diterima */}
<div className="relative overflow-hidden bg-gradient-to-br from-blue-500 to-indigo-600 rounded-2xl shadow-lg p-5 text-white">
<div className="absolute -top-4 -right-4 w-20 h-20 bg-white/10 rounded-full"></div>
<div className="absolute -bottom-6 -right-2 w-16 h-16 bg-white/10 rounded-full"></div>
<p className="text-sm font-medium opacity-90 mb-1">‚úÖ Diterima</p>
<p className="text-4xl font-black">{proposals.filter(p => p.status === 'Diterima').length}</p>
<p className="text-xs opacity-75 mt-1">
{proposals.length > 0 ? Math.round(proposals.filter(p => p.status === 'Diterima').length / proposals.length * 100) : 0}% dari total
</p>
<div className="mt-3 h-1.5 bg-white/20 rounded-full overflow-hidden">
<div className="h-full bg-white/60 rounded-full" style={{width: `${proposals.length > 0 ? Math.round(proposals.filter(p => p.status === 'Diterima').length / proposals.length * 100) : 0}%`}}></div>
</div>
</div>
{/* Card 3 ‚Äì Menunggu & Diperbaiki */}
<div className="relative overflow-hidden bg-gradient-to-br from-amber-400 to-orange-500 rounded-2xl shadow-lg p-5 text-white">
<div className="absolute -top-4 -right-4 w-20 h-20 bg-white/10 rounded-full"></div>
<div className="absolute -bottom-6 -right-2 w-16 h-16 bg-white/10 rounded-full"></div>
<p className="text-sm font-medium opacity-90 mb-1">‚è≥ Menunggu / Revisi</p>
<p className="text-4xl font-black">{proposals.filter(p => !p.status || p.status === 'Menunggu' || p.status === 'Diperbaiki').length}</p>
<div className="flex gap-2 mt-1">
<span className="text-xs bg-white/20 rounded-full px-2 py-0.5">‚è≥ {proposals.filter(p => !p.status || p.status === 'Menunggu').length} menunggu</span>
<span className="text-xs bg-white/20 rounded-full px-2 py-0.5">‚ö†Ô∏è {proposals.filter(p => p.status === 'Diperbaiki').length} revisi</span>
</div>
<div className="mt-3 h-1.5 bg-white/20 rounded-full overflow-hidden">
<div className="h-full bg-white/60 rounded-full" style={{width: `${proposals.length > 0 ? Math.round(proposals.filter(p => !p.status || p.status === 'Menunggu' || p.status === 'Diperbaiki').length / proposals.length * 100) : 0}%`}}></div>
</div>
</div>
{/* Card 4 ‚Äì Distribusi Prodi */}
<div className="relative overflow-hidden bg-gradient-to-br from-purple-500 to-violet-600 rounded-2xl shadow-lg p-5 text-white">
<div className="absolute -top-4 -right-4 w-20 h-20 bg-white/10 rounded-full"></div>
<div className="absolute -bottom-6 -right-2 w-16 h-16 bg-white/10 rounded-full"></div>
<p className="text-sm font-medium opacity-90 mb-1">üéì Distribusi Prodi</p>
<p className="text-4xl font-black">{[...new Set(proposals.map(p => p.prodi).filter(Boolean))].length}</p>
<div className="mt-1 space-y-0.5">
{[['Ekonomi Syariah','ES'],['Perbankan Syariah','PS'],['Manajemen Bisnis Syariah','MBS']].map(([prodi, abbr]) => (
<div key={prodi} className="flex justify-between items-center">
<span className="text-xs opacity-80">{abbr}</span>
<span className="text-xs font-bold bg-white/20 rounded-full px-2">{proposals.filter(p => p.prodi === prodi).length}</span>
</div>
))}
</div>
</div>
</div>

{/* Filter Section */}
<div className="bg-white rounded-xl shadow-sm border p-4">
<div className="grid grid-cols-1 md:grid-cols-5 gap-4">
<div className="md:col-span-2">
<label className="block text-xs font-semibold text-gray-600 mb-1">üîç Pencarian</label>
<input
type="text"
placeholder="Cari judul, mahasiswa, NIM, pembimbing..."
value={searchTerm}
onChange={(e) => setSearchTerm(e.target.value)}
className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 focus:outline-none"
/>
</div>
<div>
<label className="block text-xs font-semibold text-gray-600 mb-1">üìä Status</label>
<select
value={filterStatus}
onChange={(e) => setFilterStatus(e.target.value)}
className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 focus:outline-none"
>
<option value="">Semua Status</option>
<option value="Menunggu">Menunggu</option>
<option value="Diterima">Diterima</option>
<option value="Diperbaiki">Diperbaiki</option>
<option value="Ditolak">Ditolak</option>
</select>
</div>
<div>
<label className="block text-xs font-semibold text-gray-600 mb-1">üìã Program Studi</label>
<select
value={filterProdi}
onChange={(e) => setFilterProdi(e.target.value)}
className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 focus:outline-none"
>
<option value="">Semua Prodi</option>
<option value="Ekonomi Syariah">Ekonomi Syariah</option>
<option value="Perbankan Syariah">Perbankan Syariah</option>
<option value="Manajemen Bisnis Syariah">Manajemen Bisnis Syariah</option>
</select>
</div>
<div>
<label className="block text-xs font-semibold text-gray-600 mb-1">üìÖ Urutkan</label>
<select
value={sortBy}
onChange={(e) => setSortBy(e.target.value)}
className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 focus:outline-none"
>
<option value="tanggal">Tanggal</option>
<option value="judul">Judul</option>
<option value="mahasiswa">Mahasiswa</option>
<option value="status">Status</option>
</select>
</div>
</div>
<div className="flex justify-end mt-2">
<button
onClick={() => setSortOrder(sortOrder === 'asc' ? 'desc' : 'asc')}
className="text-sm text-emerald-600 hover:text-emerald-800 flex items-center gap-1"
>
{sortOrder === 'asc' ? '‚¨ÜÔ∏è Ascending' : '‚¨áÔ∏è Descending'}
</button>
</div>
</div>

{/* Tabel Proposal */}
<div className="bg-white rounded-xl shadow-sm border overflow-hidden">
<div className="overflow-x-auto">
<table className="w-full min-w-[1200px]">
<thead className="bg-gradient-to-r from-emerald-600 to-teal-600 text-white">
<tr>
<th className="px-4 py-3 text-left text-sm font-semibold w-16">No</th>
<th className="px-4 py-3 text-left text-sm font-semibold">Judul Proposal</th>
<th className="px-4 py-3 text-left text-sm font-semibold w-40">Mahasiswa</th>
<th className="px-4 py-3 text-left text-sm font-semibold w-32">Program Studi</th>
<th className="px-4 py-3 text-left text-sm font-semibold w-48">Pembimbing</th>
<th className="px-4 py-3 text-left text-sm font-semibold w-28">Status</th>
<th className="px-4 py-3 text-left text-sm font-semibold w-28">Tanggal</th>
<th className="px-4 py-3 text-center text-sm font-semibold w-40">Aksi</th>
</tr>
</thead>
<tbody className="divide-y divide-gray-100">
{paginatedProposals.map((proposal, index) => {
const statusInfo = getStatusInfo(proposal.status);
const hasBimbingan1 = getBimbinganForDosen(proposal, proposal.pembimbing1);
const hasBimbingan2 = proposal.pembimbing2 && proposal.pembimbing2 !== '-' && getBimbinganForDosen(proposal, proposal.pembimbing2);
const isDosenPembimbing = userRole === 'dosen' && (proposal.pembimbing1 === currentUser?.nama || proposal.pembimbing2 === currentUser?.nama);
const pembimbingKe = isDosenPembimbing ? (proposal.pembimbing1 === currentUser?.nama ? 1 : 2) : null;

return (
<tr key={proposal.id} className="hover:bg-emerald-50/50 transition-colors group">
<td className="px-4 py-4 text-sm text-gray-500 align-top">
{(currentPage - 1) * ITEMS_PER_PAGE + index + 1}
</td>
<td className="px-4 py-4">
<div className="space-y-2">
<div className="font-medium text-gray-900 group-hover:text-emerald-700 transition-colors">
{proposal.judul}
</div>
<div className="text-xs text-gray-400 line-clamp-2">
{proposal.abstrak.substring(0, 100)}...
</div>
{proposal.catatan && (
<div className="flex items-start gap-1 mt-1 text-xs text-amber-600 bg-amber-50 p-1 rounded">
<span>üìå</span>
<span className="line-clamp-1">{proposal.catatan}</span>
</div>
)}
</div>
</td>
<td className="px-4 py-4">
<div className="text-sm font-medium">{proposal.mahasiswaNama}</div>
<div className="text-xs text-gray-400">{proposal.nim}</div>
<div className="text-xs text-gray-400 mt-1">üì± {proposal.whatsapp}</div>
</td>
<td className="px-4 py-4">
<span className="text-sm">{proposal.prodi}</span>
</td>
<td className="px-4 py-4">
<div className="space-y-2">
<div className="flex items-center gap-1">
<span className="pembimbing-badge pembimbing-badge-1 text-[10px]">P1</span>
<span className="text-sm">{proposal.pembimbing1}</span>
{hasBimbingan1 && (
<span className="progress-indicator ml-1" title="Bimbingan aktif">
<span className="progress-dot aktif"></span>
<span className="text-[10px]">{hasBimbingan1.progress}%</span>
</span>
)}
</div>
{proposal.pembimbing2 && proposal.pembimbing2 !== '-' && (
<div className="flex items-center gap-1 mt-1">
<span className="pembimbing-badge pembimbing-badge-2 text-[10px]">P2</span>
<span className="text-sm">{proposal.pembimbing2}</span>
{hasBimbingan2 && (
<span className="progress-indicator ml-1" title="Bimbingan aktif">
<span className="progress-dot aktif"></span>
<span className="text-[10px]">{hasBimbingan2.progress}%</span>
</span>
)}
</div>
)}
</div>
</td>
<td className="px-4 py-4">
<div className={`inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold ${statusInfo.color}`}>
<span className="mr-1">{statusInfo.icon}</span>
{proposal.status}
</div>
</td>
<td className="px-4 py-4 text-sm text-gray-600">
{formatDate(proposal.tanggalPengajuan || proposal.createdAt)}
</td>
<td className="px-4 py-4">
<div className="flex items-center justify-center gap-2 flex-wrap">
{/* Tombol Lihat Detail */}
<button
onClick={() => handleViewDetail(proposal)}
className="p-2 bg-emerald-100 text-emerald-700 rounded-lg hover:bg-emerald-200 transition-all transform hover:scale-110"
title="Lihat Detail"
>
<span className="text-lg">üëÅÔ∏è</span>
</button>

{/* Tombol untuk Dosen - Mulai Bimbingan */}
{isDosenPembimbing && proposal.status === 'Diterima' && !getBimbinganForDosen(proposal, currentUser.nama) && (
<button
onClick={() => onMulaiBimbingan(proposal, pembimbingKe)}
className="p-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-all transform hover:scale-110"
title={`Mulai Bimbingan sebagai Pembimbing ${pembimbingKe}`}
>
<span className="text-lg">üìã</span>
</button>
)}

{/* Tombol untuk Dosen - Lihat Bimbingan */}
{isDosenPembimbing && proposal.status === 'Diterima' && getBimbinganForDosen(proposal, currentUser.nama) && (
<button
onClick={() => onNavigate('bimbingan')}
className="p-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-all transform hover:scale-110"
title="Lihat Bimbingan"
>
<span className="text-lg">üìä</span>
</button>
)}

{/* Admin/Operator Actions */}
{canEdit && (
<button
onClick={() => onEdit(proposal)}
className="p-2 bg-amber-100 text-amber-700 rounded-lg hover:bg-amber-200 transition-all transform hover:scale-110"
title="Edit Proposal"
>
<span className="text-lg">‚úèÔ∏è</span>
</button>
)}
{canDelete && (
<button
onClick={() => onDelete(proposal.id, proposal.judul)}
className="p-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-all transform hover:scale-110"
title="Hapus Proposal"
>
<span className="text-lg">üóëÔ∏è</span>
</button>
)}
</div>
</td>
</tr>
);
})}

{filteredProposals.length === 0 && (
<tr>
<td colSpan="8" className="px-4 py-12 text-center text-gray-400">
<div className="flex flex-col items-center">
<span className="text-6xl mb-4">üìù</span>
<p className="text-lg font-medium">Tidak ada proposal ditemukan</p>
<p className="text-sm mt-1">Coba ubah filter pencarian Anda</p>
</div>
</td>
</tr>
)}
</tbody>
</table>
</div>

{/* Table Footer with Stats */}
{filteredProposals.length > 0 && (
<div className="bg-gray-50 px-4 py-3 border-t text-sm text-gray-600 flex justify-between items-center">
<div className="flex items-center gap-4">
<span>
Menampilkan <strong>{Math.min((currentPage - 1) * ITEMS_PER_PAGE + 1, filteredProposals.length)}‚Äì{Math.min(currentPage * ITEMS_PER_PAGE, filteredProposals.length)}</strong> dari <strong>{filteredProposals.length}</strong> proposal
</span>
<div className="flex items-center gap-2">
<span className="text-xs px-2 py-1 bg-blue-100 text-blue-700 rounded-full">Menunggu: {proposals.filter(p => !p.status || p.status === 'Menunggu').length}</span>
<span className="text-xs px-2 py-1 bg-green-100 text-green-700 rounded-full">Diterima: {proposals.filter(p => p.status === 'Diterima').length}</span>
<span className="text-xs px-2 py-1 bg-yellow-100 text-yellow-700 rounded-full">Diperbaiki: {proposals.filter(p => p.status === 'Diperbaiki').length}</span>
<span className="text-xs px-2 py-1 bg-red-100 text-red-700 rounded-full">Ditolak: {proposals.filter(p => p.status === 'Ditolak').length}</span>
</div>
</div>
<span className="text-emerald-600">
üìä Halaman {currentPage} dari {totalPages}
</span>
</div>
)}
</div>

{/* Pagination */}
<Pagination 
currentPage={currentPage}
totalPages={totalPages}
onPageChange={setCurrentPage}
/>

{/* Detail Modal */}
{showDetailModal && (
<DetailModal
proposal={selectedProposal}
onClose={() => {
setShowDetailModal(false);
setSelectedProposal(null);
}}
/>
)}
</div>
);
};

// ============================================
// BIMBINGAN PAGE - DENGAN PAGINATION
// ============================================
const BimbinganPage = ({ bimbingan, userRole, currentUser, onAdd, onEdit, onDelete, mahasiswaList, dosenList, proposalsList, onNavigate, onEditMeeting, onDeleteMeeting, onAddMeeting }) => {
const [selectedBimbingan, setSelectedBimbingan] = React.useState(null);
const [showDetailModal, setShowDetailModal] = React.useState(false);
const [showMeetingModal, setShowMeetingModal] = React.useState(false);
const [editingMeeting, setEditingMeeting] = React.useState(null);
const [searchTerm, setSearchTerm] = React.useState('');
const [filterStatus, setFilterStatus] = React.useState('');
const [filterProdi, setFilterProdi] = React.useState('');
const [filterPembimbing, setFilterPembimbing] = React.useState('');
const [showPrintPreview, setShowPrintPreview] = React.useState(false);
const [printData, setPrintData] = React.useState(null);
const [currentPage, setCurrentPage] = React.useState(1);
const ITEMS_PER_PAGE = 15;

// Filter bimbingan berdasarkan role dan filter
const filteredBimbingan = React.useMemo(() => {
let filtered = userRole === 'mahasiswa'
? bimbingan.filter(b => b.nim === currentUser?.nim)
: userRole === 'dosen'
? bimbingan.filter(b => b.dosenNama === currentUser?.nama)
: bimbingan;

// Apply search
if (searchTerm) {
filtered = filtered.filter(b => 
b.judul?.toLowerCase().includes(searchTerm.toLowerCase()) ||
b.mahasiswaNama?.toLowerCase().includes(searchTerm.toLowerCase()) ||
b.dosenNama?.toLowerCase().includes(searchTerm.toLowerCase())
);
}

// Apply status filter
if (filterStatus) {
filtered = filtered.filter(b => b.status === filterStatus);
}

// Apply prodi filter
if (filterProdi) {
filtered = filtered.filter(b => b.prodi === filterProdi);
}

// Apply pembimbing filter
if (filterPembimbing) {
filtered = filtered.filter(b => b.pembimbingKe === parseInt(filterPembimbing));
}

return filtered;
}, [bimbingan, userRole, currentUser, searchTerm, filterStatus, filterProdi, filterPembimbing]);

// Reset ke halaman 1 saat filter berubah
React.useEffect(() => {
setCurrentPage(1);
}, [searchTerm, filterStatus, filterProdi, filterPembimbing]);

const totalPages = Math.ceil(filteredBimbingan.length / ITEMS_PER_PAGE);
const paginatedBimbingan = filteredBimbingan.slice(
(currentPage - 1) * ITEMS_PER_PAGE,
currentPage * ITEMS_PER_PAGE
);

// Statistik bimbingan
const stats = React.useMemo(() => {
const filtered = userRole === 'mahasiswa' 
? bimbingan.filter(b => b.nim === currentUser?.nim)
: userRole === 'dosen'
? bimbingan.filter(b => b.dosenNama === currentUser?.nama)
: bimbingan;

return {
total: filtered.length,
berlangsung: filtered.filter(b => b.status === 'berlangsung').length,
selesai: filtered.filter(b => b.status === 'selesai').length,
progressRata: filtered.length > 0 
? Math.round(filtered.reduce((sum, b) => sum + (b.progress || 0), 0) / filtered.length) 
: 0
};
}, [bimbingan, userRole, currentUser]);

const canAdd = userRole === 'admin' || userRole === 'operator';
const canEdit = userRole === 'admin' || userRole === 'operator' || userRole === 'dosen';
const canDelete = userRole === 'admin'; // Only admin can delete

const handleViewDetail = (item) => {
setSelectedBimbingan(item);
setShowDetailModal(true);
};

const handleAddMeeting = (item) => {
if (item.meetings && item.meetings.length >= 10) {
alert('Maksimal 10 kali pertemuan bimbingan (progress 100%)');
return;
}
setSelectedBimbingan(item);
setEditingMeeting(null);
setShowMeetingModal(true);
};

const handleEditMeeting = (item, meeting) => {
setSelectedBimbingan(item);
setEditingMeeting(meeting);
setShowMeetingModal(true);
};

const handleDeleteMeeting = async (bimbinganId, meetingId, meetingCatatan) => {
if (userRole !== 'admin') {
alert('Hanya admin yang dapat menghapus pertemuan bimbingan');
return;
}
if (!confirm(`Hapus pertemuan "${meetingCatatan}"?`)) return;

try {
const bimbinganItem = bimbingan.find(b => b.id === bimbinganId);
if (!bimbinganItem) return;

const updatedMeetings = (bimbinganItem.meetings || []).filter(m => m.id !== meetingId);
// Hitung ulang progress berdasarkan jumlah pertemuan
const newProgress = updatedMeetings.length * 10;

await DB.set(`bimbingan/${bimbinganId}`, {
...bimbinganItem,
meetings: updatedMeetings,
progress: newProgress,
lastUpdate: new Date().toISOString().split('T')[0]
});

alert('Pertemuan berhasil dihapus');
} catch (error) {
console.error('Error deleting meeting:', error);
alert('Gagal menghapus pertemuan');
}
};

const handleSaveMeeting = async (bimbinganId, meetingData) => {
try {
const bimbinganItem = bimbingan.find(b => b.id === bimbinganId);
if (!bimbinganItem) return false;

let updatedMeetings = bimbinganItem.meetings || [];

if (editingMeeting) {
// Edit existing meeting
updatedMeetings = updatedMeetings.map(m => 
m.id === editingMeeting.id ? { ...meetingData, id: m.id } : m
);
} else {
// Add new meeting
const newMeeting = {
...meetingData,
id: 'm' + Date.now() + Math.random().toString(36).substr(2, 5)
};
updatedMeetings = [...updatedMeetings, newMeeting];
}

// Urutkan berdasarkan tanggal
updatedMeetings.sort((a, b) => new Date(a.tanggal) - new Date(b.tanggal));

// Hitung ulang progress berdasarkan jumlah pertemuan
const newProgress = updatedMeetings.length * 10;
const isCompleted = newProgress >= 100;

await DB.set(`bimbingan/${bimbinganId}`, {
...bimbinganItem,
meetings: updatedMeetings,
progress: newProgress,
status: isCompleted ? 'selesai' : 'berlangsung',
lastUpdate: new Date().toISOString().split('T')[0]
});

setShowMeetingModal(false);
setEditingMeeting(null);
alert(editingMeeting ? 'Pertemuan berhasil diperbarui' : 'Pertemuan berhasil ditambahkan');
return true;
} catch (error) {
console.error('Error saving meeting:', error);
alert('Gagal menyimpan pertemuan');
return false;
}
};

const handlePrintLaporan = (item) => {
// Langsung buka window cetak yang sudah disempurnakan
const now = new Date();
const tglCetak = now.toLocaleDateString('id-ID', { day: 'numeric', month: 'long', year: 'numeric' });
const jamCetak = now.toLocaleTimeString('id-ID', { hour: '2-digit', minute: '2-digit' });
const tglCetakLong = now.toLocaleDateString('id-ID', { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' });

const getDosenByNama = (nama) => dosenList.find(d => d.nama === nama) || { nip: '-', keahlian: '-', whatsapp: '-' };
const getMahasiswaByNim = (nim) => mahasiswaList.find(m => m.nim === nim) || { nama: '-', nim: '-', whatsapp: '-' };

const dosen = getDosenByNama(item.dosenNama);
const mahasiswa = getMahasiswaByNim(item.nim);
const progress = item.progress || 0;
const meetings = item.meetings || [];
const pembimbingLabel = item.pembimbingKe === 1 ? 'Pembimbing 1' : (item.pembimbingKe === 2 ? 'Pembimbing 2' : 'Pembimbing');
const statusLabel = item.status === 'berlangsung' ? 'Berlangsung' : 'Selesai';
const statusColor = item.status === 'berlangsung' ? '#1d4ed8' : '#047857';
const statusBg = item.status === 'berlangsung' ? '#dbeafe' : '#d1fae5';
const noDoc = `FEBI-BIM-${now.getFullYear()}-${String(now.getMonth()+1).padStart(2,'0')}${String(now.getDate()).padStart(2,'0')}-${String(Math.floor(Math.random()*9000)+1000)}`;

// Cari data pembimbing lain (jika ada bimbingan pair untuk judul yang sama)
const pairDosen = bimbingan && bimbingan.find(b =>
  b.nim === item.nim &&
  b.judul === item.judul &&
  b.id !== item.id
);
const dosenPair = pairDosen ? getDosenByNama(pairDosen.dosenNama) : null;

// Build meeting rows
const buildMeetingRows = () => {
if (!meetings || meetings.length === 0) {
return `<tr><td colspan="5" style="text-align:center;padding:20px;color:#9ca3af;font-style:italic">Belum ada pertemuan bimbingan yang tercatat</td></tr>`;
}
return meetings.map((m, idx) => {
const prog = m.progress || 0;
const barColor = prog >= 70 ? '#047857' : prog >= 40 ? '#f59e0b' : '#3b82f6';
return `<tr style="${idx % 2 === 0 ? 'background:#f9fafb' : 'background:#ffffff'}">
<td style="text-align:center;font-weight:700;color:#374151;padding:8px 6px">${idx + 1}</td>
<td style="padding:8px 6px;text-align:center;font-size:11px;color:#374151">${m.tanggal || '-'}</td>
<td style="padding:8px 6px;font-size:11px;color:#374151;line-height:1.5">${m.catatan || '-'}</td>
<td style="padding:8px 6px;text-align:center">
<div style="display:flex;align-items:center;gap:6px;justify-content:center">
<div style="width:60px;height:10px;background:#e5e7eb;border-radius:5px;overflow:hidden">
<div style="width:${Math.min(prog,100)}%;height:100%;background:${barColor};border-radius:5px"></div>
</div>
<span style="font-size:11px;font-weight:700;color:${barColor};min-width:30px">${prog}%</span>
</div>
</td>
<td style="padding:8px 6px;text-align:center;font-size:10.5px;color:#6b7280">${m.dosenNama || item.dosenNama}</td>
</tr>`;
}).join('');
};

const printHTML = `<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Laporan Bimbingan Skripsi - ${item.mahasiswaNama}</title>
<style>
  * { margin:0; padding:0; box-sizing:border-box; }
  body { font-family:'Times New Roman', serif; background:#fff; color:#1f2937; }
  .print-btn { position:fixed; top:16px; right:16px; z-index:9999; display:flex; gap:8px; }
  .print-btn button { padding:8px 18px; border:none; border-radius:8px; font-size:13px; font-weight:600; cursor:pointer; font-family:Arial,sans-serif; }
  .btn-print { background:#047857; color:#fff; }
  .btn-print:hover { background:#065f46; }
  .btn-close { background:#6b7280; color:#fff; }
  .btn-close:hover { background:#374151; }
  .page { max-width:820px; margin:0 auto; padding:20px 30px 40px; }

  /* ‚îÄ‚îÄ KOP ‚îÄ‚îÄ */
  .kop { display:flex; align-items:center; gap:20px; padding-bottom:12px; border-bottom:4px double #047857; margin-bottom:6px; }
  .kop-logo { width:70px; height:70px; background:linear-gradient(135deg,#047857,#065f46); border-radius:12px; display:flex; align-items:center; justify-content:center; font-size:34px; flex-shrink:0; }
  .kop-text { flex:1; }
  .kop-text h1 { font-size:15px; font-weight:700; color:#047857; letter-spacing:0.5px; margin-bottom:2px; }
  .kop-text h2 { font-size:12.5px; font-weight:600; color:#065f46; margin-bottom:1px; }
  .kop-text h3 { font-size:11.5px; color:#374151; }
  .kop-text p { font-size:9.5px; color:#6b7280; margin-top:3px; border-top:1px solid #d1fae5; padding-top:3px; }
  .doc-title { text-align:center; margin:10px 0; }
  .doc-title h2 { font-size:14px; font-weight:700; text-transform:uppercase; letter-spacing:1px; color:#047857; }
  .doc-title .no-doc { font-size:9.5px; color:#6b7280; margin-top:2px; }
  .doc-title .garis { height:2px; background:linear-gradient(to right,transparent,#047857,transparent); margin:6px 0; }

  /* ‚îÄ‚îÄ SECTIONS ‚îÄ‚îÄ */
  .section { margin-bottom:12px; }
  .section-title { font-size:11px; font-weight:700; text-transform:uppercase; color:#047857; background:#f0fdf4; padding:4px 10px; border-left:4px solid #047857; margin-bottom:7px; letter-spacing:0.5px; }

  /* ‚îÄ‚îÄ IDENTITY TABLE ‚îÄ‚îÄ */
  .id-table { width:100%; border-collapse:collapse; font-size:11.5px; }
  .id-table td { padding:5px 8px; vertical-align:top; }
  .id-table td:first-child { width:165px; font-weight:600; color:#374151; }
  .id-table td:nth-child(2) { width:10px; color:#374151; }
  .id-table tr:nth-child(even) { background:#f9fafb; }
  .id-table tr td { border-bottom:1px solid #f3f4f6; }

  /* ‚îÄ‚îÄ STATUS BADGE ‚îÄ‚îÄ */
  .status-badge { display:inline-block; padding:3px 10px; border-radius:12px; font-size:10.5px; font-weight:700; }

  /* ‚îÄ‚îÄ PROGRESS SECTION ‚îÄ‚îÄ */
  .prog-wrap { margin:8px 0; }
  .prog-bar-track { height:16px; background:#e5e7eb; border-radius:8px; overflow:hidden; margin:4px 0 2px; }
  .prog-bar-fill { height:100%; border-radius:8px; display:flex; align-items:center; justify-content:flex-end; padding-right:6px; font-size:9px; font-weight:700; color:#fff; }
  .prog-steps { display:flex; align-items:center; margin-top:8px; }
  .prog-step { flex:1; text-align:center; }
  .prog-step-circle { width:22px; height:22px; border-radius:50%; display:inline-flex; align-items:center; justify-content:center; font-size:9px; font-weight:700; margin-bottom:2px; }
  .prog-step-line { flex:1; height:2px; margin:0; }

  /* ‚îÄ‚îÄ JUDUL BOX ‚îÄ‚îÄ */
  .judul-box { background:#f0fdf4; border:1px solid #d1fae5; border-radius:8px; padding:10px 14px; font-size:12px; font-weight:600; color:#065f46; line-height:1.6; }

  /* ‚îÄ‚îÄ MEETING TABLE ‚îÄ‚îÄ */
  table.meeting { width:100%; border-collapse:collapse; font-size:11px; }
  table.meeting th { background:#047857; color:#fff; padding:7px 6px; text-align:center; font-size:10.5px; font-weight:600; }
  table.meeting th:nth-child(3) { text-align:left; }
  table.meeting td { border-bottom:1px solid #e5e7eb; vertical-align:middle; }
  table.meeting tr:last-child td { border-bottom:none; }

  /* ‚îÄ‚îÄ CATATAN BOX ‚îÄ‚îÄ */
  .catatan-box { background:#fffbeb; border:1px solid #fcd34d; border-radius:8px; padding:10px 14px; font-size:11px; line-height:1.6; white-space:pre-line; color:#374151; min-height:40px; }

  /* ‚îÄ‚îÄ FOOTER TTD ‚îÄ‚îÄ */
  .footer-wrap { display:flex; justify-content:space-between; align-items:flex-end; margin-top:22px; padding-top:14px; border-top:1.5px solid #d1d5db; }
  .footer-left { font-size:10px; color:#6b7280; line-height:1.7; max-width:57%; }
  .ttd-box { text-align:center; min-width:210px; }
  .ttd-place-date { font-size:11px; color:#374151; font-weight:600; margin-bottom:5px; }
  .ttd-title { font-size:10.5px; color:#374151; margin-bottom:2px; }
  .ttd-name-wrap { margin-top:58px; text-align:center; }
  .ttd-line { border-top:1.5px solid #374151; width:195px; margin:0 auto; padding-top:4px; }
  .ttd-unit { font-size:11px; font-weight:700; color:#047857; }
  .ttd-instansi { font-size:10px; color:#374151; margin-top:1px; }

  /* ‚îÄ‚îÄ TWO COLUMN ‚îÄ‚îÄ */
  .grid2 { display:grid; grid-template-columns:1fr 1fr; gap:0; }
  .grid2-left { padding-right:12px; border-right:1px solid #e5e7eb; }
  .grid2-right { padding-left:12px; }

  /* ‚îÄ‚îÄ WATERMARK ‚îÄ‚îÄ */
  .watermark { position:fixed; top:50%; left:50%; transform:translate(-50%,-50%) rotate(-35deg); font-size:70px; font-weight:900; color:rgba(4,120,87,0.04); pointer-events:none; z-index:0; white-space:nowrap; }

  @media print {
    .print-btn { display:none; }
    body { -webkit-print-color-adjust:exact; print-color-adjust:exact; }
    .page { padding:8px 18px; }
    .watermark { position:fixed; }
  }
</style>
</head>
<body>
<div class="watermark">FEBI UINSI SAMARINDA</div>
<div class="print-btn no-print">
  <button class="btn-print" onclick="window.print()">üñ®Ô∏è Cetak</button>
  <button class="btn-close" onclick="window.close()">‚úï Tutup</button>
</div>

<div class="page">

  <!-- KOP SURAT -->
  <div class="kop">
    <div class="kop-logo">üéì</div>
    <div class="kop-text">
      <h1>LAPORAN BIMBINGAN SKRIPSI</h1>
      <h2>FAKULTAS EKONOMI DAN BISNIS ISLAM (FEBI)</h2>
      <h3>UNIVERSITAS ISLAM NEGERI SULTAN IDAD SAMARINDA (UINSI)</h3>
      <p>Jl. H.A.M. Rifadin, Samarinda Seberang, Kota Samarinda, Kalimantan Timur 75131 &nbsp;|&nbsp; febi.uinsi.ac.id</p>
    </div>
  </div>
  <div class="doc-title">
    <h2>Laporan Proses Bimbingan Penulisan Skripsi</h2>
    <div class="no-doc">No. Dok: ${noDoc}</div>
    <div class="garis"></div>
  </div>

  <!-- BAGIAN A: IDENTITAS MAHASISWA -->
  <div class="section">
    <div class="section-title">A. Identitas Mahasiswa</div>
    <table class="id-table">
      <tr><td>Nama Mahasiswa</td><td>:</td><td><strong>${item.mahasiswaNama}</strong></td></tr>
      <tr><td>NIM</td><td>:</td><td>${item.nim}</td></tr>
      <tr><td>Program Studi</td><td>:</td><td>${item.prodi}</td></tr>
      <tr><td>Nomor WhatsApp</td><td>:</td><td>${item.whatsapp || mahasiswa.whatsapp || '-'}</td></tr>
      <tr><td>Mulai Bimbingan</td><td>:</td><td>${item.createdAt ? new Date(item.createdAt).toLocaleDateString('id-ID',{day:'numeric',month:'long',year:'numeric'}) : '-'}</td></tr>
      <tr><td>Terakhir Update</td><td>:</td><td>${item.lastUpdate ? new Date(item.lastUpdate).toLocaleDateString('id-ID',{day:'numeric',month:'long',year:'numeric'}) : '-'}</td></tr>
    </table>
  </div>

  <!-- BAGIAN B: JUDUL SKRIPSI -->
  <div class="section">
    <div class="section-title">B. Judul Skripsi yang Dibimbing</div>
    <div class="judul-box">"${item.judul}"</div>
  </div>

  <!-- BAGIAN C: IDENTITAS DOSEN PEMBIMBING -->
  <div class="section">
    <div class="section-title">C. Identitas Dosen Pembimbing</div>
    <div class="grid2">
      <div class="grid2-left">
        <table class="id-table">
          <tr><td colspan="3" style="font-weight:700;color:#065f46;background:#f0fdf4;padding:4px 8px;font-size:11px">PEMBIMBING 1 ${item.pembimbingKe === 1 ? '‚Üê (Pembimbing Saat Ini)' : pairDosen && pairDosen.pembimbingKe === 1 ? '' : ''}</td></tr>
          <tr><td>Nama</td><td>:</td><td><strong>${item.pembimbingKe === 1 ? item.dosenNama : (pairDosen ? pairDosen.dosenNama : '-')}</strong></td></tr>
          <tr><td>NIP</td><td>:</td><td>${item.pembimbingKe === 1 ? (dosen.nip||'-') : (dosenPair ? dosenPair.nip : '-')}</td></tr>
          <tr><td>Keahlian</td><td>:</td><td>${item.pembimbingKe === 1 ? (dosen.keahlian||'-') : (dosenPair ? dosenPair.keahlian : '-')}</td></tr>
          <tr><td>WhatsApp</td><td>:</td><td>${item.pembimbingKe === 1 ? (dosen.whatsapp||'-') : (dosenPair ? dosenPair.whatsapp : '-')}</td></tr>
        </table>
      </div>
      <div class="grid2-right">
        <table class="id-table">
          <tr><td colspan="3" style="font-weight:700;color:#b45309;background:#fffbeb;padding:4px 8px;font-size:11px">PEMBIMBING 2 ${item.pembimbingKe === 2 ? '‚Üê (Pembimbing Saat Ini)' : ''}</td></tr>
          <tr><td>Nama</td><td>:</td><td><strong>${item.pembimbingKe === 2 ? item.dosenNama : (pairDosen && pairDosen.pembimbingKe === 2 ? pairDosen.dosenNama : '-')}</strong></td></tr>
          <tr><td>NIP</td><td>:</td><td>${item.pembimbingKe === 2 ? (dosen.nip||'-') : (pairDosen && pairDosen.pembimbingKe === 2 ? (dosenPair?dosenPair.nip:'-') : '-')}</td></tr>
          <tr><td>Keahlian</td><td>:</td><td>${item.pembimbingKe === 2 ? (dosen.keahlian||'-') : (pairDosen && pairDosen.pembimbingKe === 2 ? (dosenPair?dosenPair.keahlian:'-') : '-')}</td></tr>
          <tr><td>WhatsApp</td><td>:</td><td>${item.pembimbingKe === 2 ? (dosen.whatsapp||'-') : (pairDosen && pairDosen.pembimbingKe === 2 ? (dosenPair?dosenPair.whatsapp:'-') : '-')}</td></tr>
        </table>
      </div>
    </div>
  </div>

  <!-- BAGIAN D: STATUS & PROGRESS -->
  <div class="section">
    <div class="section-title">D. Status &amp; Progress Bimbingan</div>
    <table class="id-table" style="margin-bottom:8px">
      <tr>
        <td>Status Bimbingan</td><td>:</td>
        <td><span class="status-badge" style="background:${statusBg};color:${statusColor};border:1.5px solid ${statusColor}">${statusLabel}</span></td>
      </tr>
      <tr>
        <td>Peran Pembimbing</td><td>:</td>
        <td><strong>${pembimbingLabel}</strong> &nbsp;‚Äî&nbsp; ${item.dosenNama}</td>
      </tr>
      <tr>
        <td>Total Pertemuan</td><td>:</td>
        <td><strong>${meetings.length} dari 10 pertemuan</strong> (setiap pertemuan = 10% progress)</td>
      </tr>
    </table>
    <div class="prog-wrap">
      <div style="display:flex;justify-content:space-between;font-size:10.5px;margin-bottom:3px">
        <span>Progress Keseluruhan</span>
        <span style="font-weight:700;color:#047857">${progress}%</span>
      </div>
      <div class="prog-bar-track">
        <div class="prog-bar-fill" style="width:${Math.min(progress,100)}%;background:${progress>=70?'#047857':progress>=40?'#f59e0b':'#3b82f6'}">
          ${progress}%
        </div>
      </div>
      <div class="prog-steps" style="margin-top:6px">
        ${Array.from({length:10},(v,i)=>{
          const completed = meetings.length > i;
          const active = meetings.length === i;
          const circleColor = completed ? '#16a34a' : active ? '#047857' : '#d1d5db';
          const textColor = completed || active ? '#fff' : '#9ca3af';
          const lineColor = meetings.length > i ? '#16a34a' : '#e5e7eb';
          return `<div class="prog-step">
            <div class="prog-step-circle" style="background:${circleColor};color:${textColor};margin:0 auto">${i+1}</div>
            <div style="font-size:8px;color:${completed?'#16a34a':'#9ca3af'}">${(i+1)*10}%</div>
          </div>${i<9?`<div class="prog-step-line" style="background:${lineColor}"></div>`:''}`;
        }).join('')}
      </div>
    </div>
  </div>

  <!-- BAGIAN E: RINCIAN PERTEMUAN BIMBINGAN -->
  <div class="section">
    <div class="section-title">E. Rincian Pertemuan Bimbingan (${meetings.length} dari 10 Pertemuan)</div>
    <table class="meeting">
      <thead>
        <tr>
          <th style="width:32px">No</th>
          <th style="width:14%">Tanggal</th>
          <th style="text-align:left">Catatan / Materi Bimbingan</th>
          <th style="width:16%">Progress</th>
          <th style="width:22%">Dosen Pembimbing</th>
        </tr>
      </thead>
      <tbody>
        ${buildMeetingRows()}
      </tbody>
    </table>
    ${meetings.length > 0 ? `
    <div style="margin-top:8px;font-size:10px;color:#6b7280;font-style:italic">
      * Terakhir diperbarui: ${item.lastUpdate || tglCetak} | Total progress tercapai: ${progress}% dari target 100%
    </div>` : ''}
  </div>

  <!-- BAGIAN F: CATATAN UMUM -->
  <div class="section">
    <div class="section-title">F. Catatan Umum Bimbingan</div>
    <div class="catatan-box">${item.catatan || 'Belum ada catatan umum bimbingan.'}</div>
  </div>

  <!-- FOOTER: Tempat+Tanggal & TTD Koordinator Prodi -->
  <div class="footer-wrap">
    <div class="footer-left">
      <strong>Keterangan:</strong><br>
      Laporan ini digenerate secara otomatis oleh Sistem Informasi Bimbingan Skripsi FEBI UINSI Samarinda.<br>
      Dokumen ini merupakan bukti resmi proses bimbingan skripsi mahasiswa program studi <strong>${item.prodi}</strong>.<br>
      Laporan ini sah dan dapat dipertanggungjawabkan.<br>
      <span style="color:#9ca3af">Dicetak: ${tglCetakLong}, pukul ${jamCetak} WITA</span>
    </div>
    <div class="ttd-box">
      <div class="ttd-place-date">Samarinda, ${tglCetak}</div>
      <div class="ttd-title">Koordinator</div>
      
      <div class="ttd-name-wrap">
        <div class="ttd-line">
          <div class="ttd-unit">Program Studi ${item.prodi}</div>
          <div class="ttd-instansi">FEBI UINSI Samarinda</div>
        </div>
      </div>
    </div>
  </div>

</div>
</body>
</html>`;

const printWindow = window.open('', '_blank', 'width=1000,height=800');
printWindow.document.write(printHTML);
printWindow.document.close();
setTimeout(() => printWindow.focus(), 300);
};

const handlePrintAll = () => {
// Cetak semua bimbingan yang terfilter - buka satu per satu atau tampilkan daftar
const now = new Date();
const tglCetak = now.toLocaleDateString('id-ID', { day: 'numeric', month: 'long', year: 'numeric' });
const jamCetak = now.toLocaleTimeString('id-ID', { hour:'2-digit', minute:'2-digit' });
const tglCetakLong = now.toLocaleDateString('id-ID', { weekday:'long', day:'numeric', month:'long', year:'numeric' });

const getDosenByNama = (nama) => dosenList.find(d => d.nama === nama) || { nip: '-', keahlian: '-' };

const buildItemSection = (item, index) => {
const dosen = getDosenByNama(item.dosenNama);
const meetings = item.meetings || [];
const progress = item.progress || 0;
const pembimbingLabel = item.pembimbingKe === 1 ? 'Pembimbing 1' : 'Pembimbing 2';
const statusLabel = item.status === 'berlangsung' ? 'Berlangsung' : 'Selesai';
const statusColor = item.status === 'berlangsung' ? '#1d4ed8' : '#047857';
const statusBg = item.status === 'berlangsung' ? '#dbeafe' : '#d1fae5';
const meetingRows = meetings.length === 0
? `<tr><td colspan="5" style="text-align:center;color:#9ca3af;padding:12px;font-style:italic">Belum ada pertemuan</td></tr>`
: meetings.map((m,i)=>`<tr style="${i%2===0?'background:#f9fafb':''}">
<td style="text-align:center;padding:6px;font-size:10px">${i+1}</td>
<td style="padding:6px;font-size:10px;text-align:center">${m.tanggal||'-'}</td>
<td style="padding:6px;font-size:10px">${m.catatan||'-'}</td>
<td style="text-align:center;padding:6px;font-size:10px;font-weight:700;color:${m.progress>=70?'#047857':m.progress>=40?'#f59e0b':'#3b82f6'}">${m.progress||0}%</td>
<td style="padding:6px;font-size:10px;text-align:center">${m.dosenNama||'-'}</td>
</tr>`).join('');
return `
${index > 0 ? '<div style="page-break-before:always"></div>' : ''}
<div style="margin-bottom:30px">
<h3 style="color:#047857;border-bottom:2px solid #047857;padding-bottom:5px;margin-bottom:12px;font-size:13px">
${index+1}. ${item.judul}
<span style="font-size:10px;background:${item.pembimbingKe===1?'#d1fae5':'#fef3c7'};color:${item.pembimbingKe===1?'#047857':'#b45309'};padding:2px 8px;border-radius:10px;margin-left:8px">${pembimbingLabel}</span>
<span style="font-size:10px;background:${statusBg};color:${statusColor};padding:2px 8px;border-radius:10px;margin-left:4px">${statusLabel}</span>
</h3>
<table style="width:100%;border-collapse:collapse;font-size:11px;margin-bottom:10px">
<tr><td style="width:180px;font-weight:600;padding:4px 8px;background:#f9fafb">Mahasiswa</td><td style="padding:4px 8px">${item.mahasiswaNama} (NIM: ${item.nim})</td><td style="width:180px;font-weight:600;padding:4px 8px;background:#f9fafb">Program Studi</td><td style="padding:4px 8px">${item.prodi}</td></tr>
<tr><td style="font-weight:600;padding:4px 8px;background:#f0fdf4">Dosen Pembimbing</td><td style="padding:4px 8px">${item.dosenNama} (NIP: ${dosen.nip})</td><td style="font-weight:600;padding:4px 8px;background:#f0fdf4">Progress</td><td style="padding:4px 8px;font-weight:700;color:#047857">${progress}% (${meetings.length}/10 pertemuan)</td></tr>
<tr><td style="font-weight:600;padding:4px 8px;background:#f9fafb">Mulai Bimbingan</td><td style="padding:4px 8px">${item.createdAt?new Date(item.createdAt).toLocaleDateString('id-ID'):'-'}</td><td style="font-weight:600;padding:4px 8px;background:#f9fafb">Terakhir Update</td><td style="padding:4px 8px">${item.lastUpdate||'-'}</td></tr>
</table>
<table style="width:100%;border-collapse:collapse;font-size:10.5px;margin-bottom:8px">
<thead><tr><th style="background:#047857;color:#fff;padding:6px;text-align:center;width:28px">No</th><th style="background:#047857;color:#fff;padding:6px;text-align:center;width:14%">Tanggal</th><th style="background:#047857;color:#fff;padding:6px;text-align:left">Catatan Bimbingan</th><th style="background:#047857;color:#fff;padding:6px;text-align:center;width:12%">Progress</th><th style="background:#047857;color:#fff;padding:6px;text-align:center;width:22%">Dosen</th></tr></thead>
<tbody>${meetingRows}</tbody>
</table>
${item.catatan ? `<div style="background:#fffbeb;border:1px solid #fcd34d;border-radius:6px;padding:8px 12px;font-size:10.5px"><strong>Catatan:</strong> ${item.catatan}</div>` : ''}
</div>`;
};

const printWindow = window.open('', '_blank', 'width=1000,height=800');
printWindow.document.write(`<!DOCTYPE html>
<html lang="id"><head><meta charset="UTF-8">
<title>Laporan Bimbingan Skripsi - Semua Data</title>
<style>
  body{font-family:'Times New Roman',serif;margin:30px 40px;color:#1f2937}
  @media print{.no-print{display:none};body{-webkit-print-color-adjust:exact;print-color-adjust:exact}}
</style>
</head><body>
<div class="no-print" style="text-align:right;margin-bottom:16px">
<button onclick="window.print()" style="background:#047857;color:#fff;border:none;padding:9px 18px;border-radius:6px;cursor:pointer;font-size:13px;margin-right:8px">üñ®Ô∏è Cetak</button>
<button onclick="window.close()" style="background:#6b7280;color:#fff;border:none;padding:9px 18px;border-radius:6px;cursor:pointer;font-size:13px">‚úï Tutup</button>
</div>
<div style="display:flex;align-items:center;gap:18px;border-bottom:4px double #047857;padding-bottom:10px;margin-bottom:10px">
<div style="width:66px;height:66px;background:linear-gradient(135deg,#047857,#065f46);border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:32px;flex-shrink:0">üéì</div>
<div>
<h1 style="font-size:14px;font-weight:700;color:#047857;margin-bottom:2px">LAPORAN BIMBINGAN SKRIPSI ‚Äî REKAPITULASI</h1>
<h2 style="font-size:12px;font-weight:600;color:#065f46;margin-bottom:1px">FAKULTAS EKONOMI DAN BISNIS ISLAM (FEBI)</h2>
<h3 style="font-size:11px;color:#374151">UNIVERSITAS ISLAM NEGERI SULTAN IDAD SAMARINDA (UINSI)</h3>
<p style="font-size:9px;color:#6b7280;margin-top:2px">Tanggal Cetak: ${tglCetakLong} | Pukul: ${jamCetak} WITA | Total Data: ${filteredBimbingan.length} bimbingan</p>
</div>
</div>
<div style="text-align:center;margin:8px 0 14px">
<h2 style="font-size:13px;font-weight:700;text-transform:uppercase;color:#047857;letter-spacing:1px">Rekap Proses Bimbingan Penulisan Skripsi</h2>
<div style="height:2px;background:linear-gradient(to right,transparent,#047857,transparent);margin:5px 0"></div>
</div>
${filteredBimbingan.map((item, index) => buildItemSection(item, index)).join('')}
<div style="margin-top:24px;padding-top:12px;border-top:1px solid #d1d5db;display:flex;justify-content:space-between;align-items:flex-end">
<div style="font-size:9.5px;color:#6b7280;line-height:1.7;max-width:55%">
Laporan ini digenerate otomatis oleh Sistem Informasi Bimbingan Skripsi FEBI UINSI Samarinda.<br>
Dokumen ini sah sebagai bukti resmi proses bimbingan skripsi.
</div>
<div style="text-align:center;min-width:210px">
<div style="font-size:11px;font-weight:600;color:#374151;margin-bottom:4px">Samarinda, ${tglCetak}</div>
<div style="font-size:10.5px;color:#374151">Koordinator</div>
<div style="margin-top:55px">
<div style="border-top:1.5px solid #374151;width:190px;margin:0 auto;padding-top:4px">
<div style="font-size:11px;font-weight:700;color:#047857">Program Studi</div>
<div style="font-size:10px;color:#374151">FEBI UINSI Samarinda</div>
</div>
</div>
</div>
</div>
</body></html>`);
printWindow.document.close();
setTimeout(() => printWindow.focus(), 300);
};

const generateLaporanHTML = (data, isAll = false, singleItem = null) => {
// Legacy function untuk backward compatibility - redirect ke fungsi baru
if (singleItem) { handlePrintLaporan(singleItem); return ''; }
if (isAll) { handlePrintAll(); return ''; }
return '';
};

// Detail Modal Component dengan Timeline Pertemuan
const DetailModal = ({ item, onClose, onPrint, onAddMeeting, onEditMeeting, onDeleteMeeting, userRole }) => {
if (!item) return null;
const progress = item.progress || 0;
const meetings = item.meetings || [];

return (
<div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4" onClick={onClose}>
<div className="bg-white rounded-2xl p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto" onClick={(e) => e.stopPropagation()}>
<div className="flex justify-between items-start mb-6">
<h2 className="text-2xl font-bold text-emerald-900 flex items-center gap-2">
<span className="text-3xl">üìã</span> Detail Bimbingan
{item.pembimbingKe === 1 && <span className="pembimbing-badge pembimbing-badge-1 text-xs">Pembimbing 1</span>}
{item.pembimbingKe === 2 && <span className="pembimbing-badge pembimbing-badge-2 text-xs">Pembimbing 2</span>}
</h2>
<button onClick={onClose} className="p-2 hover:bg-gray-100 rounded-lg text-xl">‚úï</button>
</div>

<div className="space-y-6">
{/* Header Info */}
<div className="bg-gradient-to-r from-emerald-50 to-teal-50 p-6 rounded-xl">
<h3 className="text-xl font-bold text-emerald-900 mb-4">{item.judul}</h3>
<div className="grid md:grid-cols-2 gap-4">
<div>
<p className="text-sm text-gray-600">Mahasiswa</p>
<p className="font-semibold">{item.mahasiswaNama}</p>
<p className="text-sm text-gray-500">{item.nim}</p>
</div>
<div>
<p className="text-sm text-gray-600">Dosen Pembimbing</p>
<p className="font-semibold">{item.dosenNama}</p>
<p className="text-sm text-gray-500">Pembimbing {item.pembimbingKe}</p>
</div>
<div>
<p className="text-sm text-gray-600">Program Studi</p>
<p className="font-semibold">{item.prodi}</p>
</div>
<div>
<p className="text-sm text-gray-600">Status</p>
<span className={`inline-block px-3 py-1 rounded-full text-xs font-semibold ${
item.status === 'berlangsung' ? 'bg-blue-100 text-blue-700' : 'bg-green-100 text-green-700'
}`}>
{item.status === 'berlangsung' ? 'Berlangsung' : 'Selesai'}
</span>
</div>
</div>
</div>

{/* Progress Bar */}
<div className="border rounded-xl p-6">
<div className="flex justify-between items-center mb-4">
<h4 className="font-bold text-emerald-800 flex items-center gap-2">
<span>üìä</span> Progress Bimbingan
</h4>
{(userRole === 'dosen' || userRole === 'admin' || userRole === 'operator') && meetings.length < 10 && (
<button
onClick={() => onAddMeeting(item)}
className="px-3 py-1 bg-emerald-600 text-white rounded-lg text-sm hover:bg-emerald-700 flex items-center gap-1"
>
<span>‚ûï</span> Tambah Pertemuan
</button>
)}
</div>
<div className="mb-2 flex justify-between text-sm">
<span>Progress Keseluruhan</span>
<span className="font-bold text-emerald-600">{progress}% ({meetings.length}/10 pertemuan)</span>
</div>
<div className="w-full bg-gray-200 rounded-full h-4 mb-4">
<div className="bg-emerald-600 h-4 rounded-full transition-all duration-300" style={{width: `${progress}%`}}></div>
</div>

{/* Visual Progress Steps */}
<div className="flex items-center justify-between mt-6 mb-2">
{[...Array(10)].map((_, i) => {
const stepProgress = (i + 1) * 10;
const isCompleted = meetings.length > i;
const isActive = meetings.length === i;
return (
<React.Fragment key={i}>
<div className="flex flex-col items-center">
<div className={`w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold ${
isCompleted ? 'bg-green-500 text-white' : 
isActive ? 'bg-emerald-500 text-white animate-pulse' : 
'bg-gray-200 text-gray-500'
}`}>
{i + 1}
</div>
<span className="text-[10px] mt-1 text-gray-500">{stepProgress}%</span>
</div>
{i < 9 && (
<div className={`flex-1 h-1 ${meetings.length > i ? 'bg-green-500' : 'bg-gray-200'}`}></div>
)}
</React.Fragment>
);
})}
</div>
</div>

{/* Timeline Pertemuan */}
<div className="border rounded-xl p-6">
<h4 className="font-bold text-emerald-800 mb-4 flex items-center gap-2">
<span>üìÖ</span> Timeline Pertemuan Bimbingan ({meetings.length}/10)
</h4>
<div className="meeting-timeline space-y-3">
{meetings.map((meeting, idx) => (
<div key={meeting.id} className="meeting-item relative group">
<div className="flex justify-between items-start">
<div className="flex-1">
<div className="flex items-center gap-2 mb-1">
<span className="text-xs font-semibold text-emerald-600 bg-emerald-50 px-2 py-0.5 rounded-full">
Pertemuan {idx + 1}
</span>
<span className="text-xs text-gray-500">{meeting.tanggal}</span>
</div>
<p className="text-sm font-medium text-gray-800 mb-1">{meeting.catatan}</p>
<div className="flex items-center gap-2">
<span className="text-xs bg-blue-100 text-blue-700 px-2 py-0.5 rounded-full">
Progress: {meeting.progress}%
</span>
<span className="text-xs text-gray-500">Oleh: {meeting.dosenNama}</span>
</div>
</div>
<div className="flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity">
{(userRole === 'dosen' || userRole === 'admin' || userRole === 'operator') && (
<button
onClick={() => onEditMeeting(item, meeting)}
className="p-1 bg-amber-100 text-amber-700 rounded hover:bg-amber-200"
title="Edit Pertemuan"
>
<span className="text-sm">‚úèÔ∏è</span>
</button>
)}
{userRole === 'admin' && (
<button
onClick={() => onDeleteMeeting(item.id, meeting.id, meeting.catatan)}
className="p-1 bg-red-100 text-red-700 rounded hover:bg-red-200"
title="Hapus Pertemuan"
>
<span className="text-sm">üóëÔ∏è</span>
</button>
)}
</div>
</div>
</div>
))}
{meetings.length === 0 && (
<div className="text-center py-8 text-gray-400">
<p className="text-4xl mb-2">üì≠</p>
<p className="text-sm">Belum ada pertemuan bimbingan</p>
</div>
)}
</div>
</div>

{/* Catatan Umum */}
<div className="border rounded-xl p-6">
<h4 className="font-bold text-emerald-800 mb-3 flex items-center gap-2">
<span>üìù</span> Catatan Bimbingan
</h4>
<div className="bg-gray-50 p-4 rounded-lg whitespace-pre-line">
{item.catatan || 'Belum ada catatan bimbingan'}
</div>
</div>

{/* Action Buttons */}
<div className="flex flex-wrap gap-3 pt-4 border-t">
<button
onClick={() => onPrint(item)}
className="flex-1 px-6 py-3 bg-emerald-600 text-white rounded-xl font-semibold hover:bg-emerald-700 transition-all flex items-center justify-center gap-2"
>
<span>üñ®Ô∏è</span> Cetak Laporan
</button>
</div>
</div>
</div>
</div>
);
};

// Meeting Modal Component
const MeetingModal = ({ item, meeting, onClose, onSave }) => {
const [formData, setFormData] = React.useState(meeting || {
tanggal: new Date().toISOString().split('T')[0],
progress: (item.meetings?.length || 0) * 10 + 10,
catatan: '',
dosenNama: item.dosenNama
});
const [isSaving, setIsSaving] = React.useState(false);

const handleSubmit = async (e) => {
e.preventDefault();
if (!formData.tanggal || !formData.catatan) {
alert('Harap lengkapi semua field');
return;
}
setIsSaving(true);
try {
await onSave(item.id, formData);
} finally {
setIsSaving(false);
}
};

return (
<div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4" onClick={onClose}>
<div className="bg-white rounded-2xl p-6 max-w-lg w-full" onClick={(e) => e.stopPropagation()}>
<h2 className="text-2xl font-bold text-emerald-900 mb-4">
{meeting ? '‚úèÔ∏è Edit Pertemuan Bimbingan' : '‚ûï Tambah Pertemuan Bimbingan'}
{item.pembimbingKe === 1 && <span className="ml-2 pembimbing-badge pembimbing-badge-1 text-xs">Pembimbing 1</span>}
{item.pembimbingKe === 2 && <span className="ml-2 pembimbing-badge pembimbing-badge-2 text-xs">Pembimbing 2</span>}
</h2>
<form onSubmit={handleSubmit}>
<div className="space-y-4">
<div>
<label className="block text-sm font-semibold text-gray-700 mb-1">Tanggal Pertemuan</label>
<input
type="date"
value={formData.tanggal}
onChange={(e) => setFormData({...formData, tanggal: e.target.value})}
className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500"
required
/>
</div>
<div>
<label className="block text-sm font-semibold text-gray-700 mb-1">Progress (%)</label>
<input
type="number"
value={formData.progress}
onChange={(e) => setFormData({...formData, progress: parseInt(e.target.value)})}
className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500"
min="10"
max="100"
step="10"
required
/>
<p className="text-xs text-gray-500 mt-1">Progress otomatis: {((item.meetings?.length || 0) + 1) * 10}% (pertemuan ke-{(item.meetings?.length || 0) + 1})</p>
</div>
<div>
<label className="block text-sm font-semibold text-gray-700 mb-1">Catatan Bimbingan</label>
<textarea
value={formData.catatan}
onChange={(e) => setFormData({...formData, catatan: e.target.value})}
className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 h-24"
placeholder="Masukkan catatan bimbingan..."
required
></textarea>
</div>
<div className="bg-blue-50 p-3 rounded-lg">
<p className="text-xs text-blue-700">
<span className="font-bold">Informasi:</span> Setiap pertemuan akan menambah progress 10%. Maksimal 10 pertemuan untuk mencapai 100%.
</p>
</div>
</div>
<div className="flex gap-3 mt-6">
<button
type="submit"
disabled={isSaving}
className="flex-1 px-6 py-3 bg-emerald-600 text-white rounded-xl font-semibold hover:bg-emerald-700 disabled:opacity-50"
>
{isSaving ? 'Menyimpan...' : (meeting ? 'Update Pertemuan' : 'Simpan Pertemuan')}
</button>
<button
type="button"
onClick={onClose}
className="px-6 py-3 bg-gray-200 text-gray-700 rounded-xl font-semibold hover:bg-gray-300"
>
Batal
</button>
</div>
</form>
</div>
</div>
);
};

// Print Preview Modal
const PrintPreviewModal = ({ data, onClose }) => {
if (!data) return null;

const handlePrint = () => {
handlePrintLaporan(data);
onClose();
};

return (
<div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4" onClick={onClose}>
<div className="bg-white rounded-2xl p-6 max-w-lg w-full" onClick={(e) => e.stopPropagation()}>
<div className="flex justify-between items-start mb-4">
<h2 className="text-xl font-bold text-emerald-900 flex items-center gap-2">
<span className="text-2xl">üñ®Ô∏è</span> Cetak Laporan Bimbingan
</h2>
<button onClick={onClose} className="p-2 hover:bg-gray-100 rounded-lg text-xl">‚úï</button>
</div>
<div className="bg-emerald-50 rounded-xl p-4 mb-4">
<p className="text-sm font-semibold text-emerald-800 mb-1">üìã {data.judul}</p>
<p className="text-xs text-gray-600">{data.mahasiswaNama} ({data.nim}) ‚Äî {data.prodi}</p>
<p className="text-xs text-gray-600">Dosen: {data.dosenNama} | Progress: {data.progress || 0}% ({(data.meetings||[]).length}/10 pertemuan)</p>
</div>
<p className="text-sm text-gray-600 mb-4">Laporan lengkap akan dibuka di tab baru dan siap dicetak dengan format resmi FEBI UINSI Samarinda.</p>
<div className="flex gap-3">
<button
onClick={handlePrint}
className="flex-1 px-6 py-3 bg-emerald-600 text-white rounded-xl font-semibold hover:bg-emerald-700 transition-all flex items-center justify-center gap-2"
>
<span>üñ®Ô∏è</span> Buka & Cetak Laporan
</button>
<button
onClick={onClose}
className="px-6 py-3 bg-gray-200 text-gray-700 rounded-xl font-semibold hover:bg-gray-300 transition-all"
>
Batal
</button>
</div>
</div>
</div>
);
};

return (
<div className="space-y-6">
{/* Header with Stats */}
<div className="flex justify-between items-center flex-wrap gap-4">
<div>
<h2 className="text-2xl font-bold text-emerald-900 flex items-center gap-2">
<span>üìã</span> Manajemen Bimbingan Skripsi
</h2>
<p className="text-sm text-gray-600 mt-1">
Total {filteredBimbingan.length} bimbingan
</p>
</div>
<div className="flex gap-2">
{canAdd && (
<button onClick={onAdd} className="px-4 py-2 bg-emerald-600 text-white rounded-xl font-semibold hover:bg-emerald-700 transition-all flex items-center gap-2">
<span>‚ûï</span> Tambah Bimbingan
</button>
)}
<button onClick={handlePrintAll} className="px-4 py-2 bg-purple-600 text-white rounded-xl font-semibold hover:bg-purple-700 transition-all flex items-center gap-2">
<span>üñ®Ô∏è</span> Cetak Semua
</button>
</div>
</div>

{/* Statistics Cards */}
<div className="grid grid-cols-1 md:grid-cols-4 gap-4">
<div className="bg-gradient-to-br from-emerald-500 to-teal-600 rounded-xl shadow-lg p-4 text-white">
<p className="text-sm opacity-90">Total Bimbingan</p>
<p className="text-3xl font-bold">{stats.total}</p>
</div>
<div className="bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl shadow-lg p-4 text-white">
<p className="text-sm opacity-90">Berlangsung</p>
<p className="text-3xl font-bold">{stats.berlangsung}</p>
</div>
<div className="bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl shadow-lg p-4 text-white">
<p className="text-sm opacity-90">Selesai</p>
<p className="text-3xl font-bold">{stats.selesai}</p>
</div>
<div className="bg-gradient-to-br from-purple-500 to-pink-600 rounded-xl shadow-lg p-4 text-white">
<p className="text-sm opacity-90">Rata-rata Progress</p>
<p className="text-3xl font-bold">{stats.progressRata}%</p>
</div>
</div>

{/* Filter Section */}
<div className="bg-white rounded-xl shadow-sm border p-4">
<div className="grid md:grid-cols-5 gap-4">
<div className="md:col-span-2">
<label className="block text-xs font-semibold text-gray-600 mb-1">üîç Cari</label>
<input
type="text"
placeholder="Cari judul, mahasiswa, atau dosen..."
value={searchTerm}
onChange={(e) => setSearchTerm(e.target.value)}
className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 focus:outline-none"
/>
</div>
<div>
<label className="block text-xs font-semibold text-gray-600 mb-1">üìä Status</label>
<select
value={filterStatus}
onChange={(e) => setFilterStatus(e.target.value)}
className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 focus:outline-none"
>
<option value="">Semua Status</option>
<option value="berlangsung">Berlangsung</option>
<option value="selesai">Selesai</option>
</select>
</div>
<div>
<label className="block text-xs font-semibold text-gray-600 mb-1">üìã Program Studi</label>
<select
value={filterProdi}
onChange={(e) => setFilterProdi(e.target.value)}
className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 focus:outline-none"
>
<option value="">Semua Prodi</option>
<option value="Ekonomi Syariah">Ekonomi Syariah</option>
<option value="Perbankan Syariah">Perbankan Syariah</option>
<option value="Manajemen Bisnis Syariah">Manajemen Bisnis Syariah</option>
</select>
</div>
<div>
<label className="block text-xs font-semibold text-gray-600 mb-1">üë• Pembimbing</label>
<select
value={filterPembimbing}
onChange={(e) => setFilterPembimbing(e.target.value)}
className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 focus:outline-none"
>
<option value="">Semua</option>
<option value="1">Pembimbing 1</option>
<option value="2">Pembimbing 2</option>
</select>
</div>
</div>
</div>

{/* Bimbingan List */}
<div className="space-y-4">
{paginatedBimbingan.map((b) => {
const progress = b.progress || 0;
const isBerlangsung = b.status === 'berlangsung';
const meetings = b.meetings || [];
const isPembimbing1 = b.pembimbingKe === 1;
return (
<div key={b.id} className={`bimbingan-card ${isBerlangsung ? 'berlangsung' : 'selesai'} bg-white rounded-xl shadow-sm border p-6 hover:shadow-lg transition-all ${isPembimbing1 ? 'border-l-4 border-l-emerald-600' : 'border-l-4 border-l-amber-500'}`}>
<div className="flex flex-col lg:flex-row lg:items-start justify-between gap-4">
{/* Main Info */}
<div className="flex-1">
<div className="flex items-start justify-between mb-3">
<h3 className="text-lg font-bold text-gray-900 flex-1">{b.judul}</h3>
<div className="flex items-center gap-2">
<span className={`pembimbing-badge ${isPembimbing1 ? 'pembimbing-badge-1' : 'pembimbing-badge-2'} text-xs`}>
Pembimbing {b.pembimbingKe}
</span>
<span className={`ml-2 px-3 py-1 rounded-full text-xs font-semibold whitespace-nowrap ${
isBerlangsung ? 'bg-blue-100 text-blue-700' : 'bg-green-100 text-green-700'
}`}>
{isBerlangsung ? 'Berlangsung' : 'Selesai'}
</span>
</div>
</div>
<div className="grid md:grid-cols-2 gap-4">
<div>
<p className="text-sm text-gray-600">Mahasiswa</p>
<p className="font-medium">{b.mahasiswaNama}</p>
<p className="text-xs text-gray-500">{b.nim}</p>
</div>
<div>
<p className="text-sm text-gray-600">Dosen Pembimbing</p>
<p className="font-medium">{b.dosenNama}</p>
</div>
<div>
<p className="text-sm text-gray-600">Program Studi</p>
<p className="text-sm">{b.prodi}</p>
</div>
<div>
<p className="text-sm text-gray-600">Terakhir Update</p>
<p className="text-sm">{b.lastUpdate || '-'}</p>
</div>
</div>
</div>

{/* Progress & Actions */}
<div className="lg:w-80">
<div className="mb-3">
<div className="flex justify-between text-sm mb-1">
<span>Progress</span>
<span className="font-bold text-emerald-600">{progress}% ({meetings.length}/10)</span>
</div>
<div className="w-full bg-gray-200 rounded-full h-2.5">
<div className={`h-2.5 rounded-full ${isPembimbing1 ? 'bg-emerald-600' : 'bg-amber-600'}`} style={{width: `${progress}%`}}></div>
</div>
</div>
<div className="flex gap-2 justify-end flex-wrap">
<button
onClick={() => handleViewDetail(b)}
className="p-2 bg-emerald-100 text-emerald-700 rounded-lg hover:bg-emerald-200 transition-all transform hover:scale-110"
title="Lihat Detail & Timeline"
>
<span className="text-lg">üëÅÔ∏è</span>
</button>
{(userRole === 'dosen' || userRole === 'admin' || userRole === 'operator') && meetings.length < 10 && (
<button
onClick={() => handleAddMeeting(b)}
className="p-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-all transform hover:scale-110"
title="Tambah Pertemuan"
>
<span className="text-lg">‚ûï</span>
</button>
)}
<button
onClick={() => handlePrintLaporan(b)}
className="p-2 bg-purple-100 text-purple-700 rounded-lg hover:bg-purple-200 transition-all transform hover:scale-110"
title="Cetak Laporan"
>
<span className="text-lg">üñ®Ô∏è</span>
</button>
{(userRole === 'dosen' || userRole === 'admin' || userRole === 'operator') && (
<button
onClick={() => onEdit(b)}
className="p-2 bg-amber-100 text-amber-700 rounded-lg hover:bg-amber-200 transition-all transform hover:scale-110"
title="Update Progress"
>
<span className="text-lg">‚úèÔ∏è</span>
</button>
)}
{canDelete && (
<button
onClick={() => onDelete(b.id, b.judul)}
className="p-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-all transform hover:scale-110"
title="Hapus"
>
<span className="text-lg">üóëÔ∏è</span>
</button>
)}
</div>
</div>
</div>

{/* Catatan Preview */}
{b.catatan && (
<div className="mt-4 pt-4 border-t border-gray-100">
<p className="text-sm text-gray-600 line-clamp-2">
<span className="font-medium">Catatan:</span> {b.catatan}
</p>
</div>
)}

{/* Preview Pertemuan Terakhir */}
{meetings.length > 0 && (
<div className="mt-3 pt-3 border-t border-gray-100">
<p className="text-xs text-gray-500 mb-2">Pertemuan terakhir: {meetings[meetings.length - 1].tanggal} - {meetings[meetings.length - 1].catatan.substring(0, 50)}...</p>
</div>
)}
</div>
);
})}

{filteredBimbingan.length === 0 && (
<div className="text-center py-12 text-gray-400 bg-white rounded-xl border">
<div className="flex flex-col items-center">
<span className="text-6xl mb-4">üìã</span>
<p className="text-lg font-medium">Tidak ada bimbingan ditemukan</p>
<p className="text-sm mt-1">Coba ubah filter pencarian Anda</p>
</div>
</div>
)}
</div>

{/* Pagination */}
<Pagination 
currentPage={currentPage}
totalPages={totalPages}
onPageChange={setCurrentPage}
/>

{/* Detail Modal */}
{showDetailModal && (
<DetailModal
item={selectedBimbingan}
onClose={() => { setShowDetailModal(false); setSelectedBimbingan(null); }}
onPrint={handlePrintLaporan}
onAddMeeting={handleAddMeeting}
onEditMeeting={handleEditMeeting}
onDeleteMeeting={handleDeleteMeeting}
userRole={userRole}
/>
)}

{/* Meeting Modal */}
{showMeetingModal && (
<MeetingModal
item={selectedBimbingan}
meeting={editingMeeting}
onClose={() => { setShowMeetingModal(false); setEditingMeeting(null); }}
onSave={handleSaveMeeting}
/>
)}

{/* Print Preview Modal */}
{showPrintPreview && (
<PrintPreviewModal
data={printData}
onClose={() => { setShowPrintPreview(false); setPrintData(null); }}
/>
)}
</div>
);
};

// ============================================
// EARLY WARNING PAGE - DENGAN PAGINATION
// ============================================
const EarlyWarningPage = ({ bimbingan, mahasiswa, currentUser, userRole, onSendWhatsApp, onNavigate }) => {
const today = new Date();
const [currentPage, setCurrentPage] = React.useState(1);
const ITEMS_PER_PAGE = 15;
const warningData = [];

// Fungsi untuk menghitung semester dari 2 digit pertama NIM dengan logika yang benar
const calculateSemesterCorrectly = (nim) => {
if (!nim || nim.length < 2) return 1;
  
// Ambil 2 digit pertama untuk tahun angkatan
const tahunDuaDigit = nim.substring(0, 2);
const angkatan = parseInt(tahunDuaDigit);
if (isNaN(angkatan) || angkatan < 10 || angkatan > 99) return 1;
  
const tahunMasuk = 2000 + angkatan; // Misal: 21 -> 2021
const bulanSekarang = today.getMonth() + 1; // Januari = 1, Desember = 12
const tahunSekarang = today.getFullYear();

// Hitung selisih tahun
const selisihTahun = tahunSekarang - tahunMasuk;

// Jika selisih tahun negatif, berarti NIM tidak valid atau tahun depan
if (selisihTahun < 0) return 1;

// Hitung semester berdasarkan bulan
let semester = selisihTahun * 2 + 1; // Default: semester ganjil

// Jika bulan Januari-Juni (semester genap), tambah 1
if (bulanSekarang >= 1 && bulanSekarang <= 6) {
semester += 1;
}

// Maksimal semester 14 (7 tahun)
return Math.max(1, Math.min(16, semester));
};

// Proses data bimbingan
bimbingan.forEach(b => {
const lastUpdate = b.lastUpdate ? new Date(b.lastUpdate) : new Date();
const daysSinceUpdate = Math.floor((today - lastUpdate) / (1000 * 60 * 60 * 24));
let level = 'aman', color = 'bg-green-100 text-green-700 border-green-200', icon = '‚úÖ';
if (daysSinceUpdate > 30) {
level = 'kritis'; color = 'bg-red-100 text-red-700 border-red-200'; icon = 'üö®';
} else if (daysSinceUpdate > 14) {
level = 'peringatan'; color = 'bg-yellow-100 text-yellow-700 border-yellow-200'; icon = '‚ö†Ô∏è';
}
warningData.push({
...b, type: 'bimbingan', daysSinceUpdate, level, color, icon, lastUpdateDate: lastUpdate,
semester: calculateSemesterCorrectly(b.nim)
});
});

// Proses data mahasiswa untuk deteksi semester akhir
mahasiswa.forEach(m => {
const semester = calculateSemesterCorrectly(m.nim);
if (semester >= 11 && semester <= 14) {
warningData.push({
type: 'semester', nim: m.nim, nama: m.nama, prodi: m.prodi, semester: semester,
whatsapp: m.whatsapp, level: 'peringatan', color: 'bg-yellow-100 text-yellow-700 border-yellow-200',
icon: '‚ö†Ô∏è', lastUpdateDate: new Date()
});
}
});

warningData.sort((a, b) => {
const levelPriority = { kritis: 3, peringatan: 2, aman: 1 };
if (levelPriority[b.level] !== levelPriority[a.level]) return levelPriority[b.level] - levelPriority[a.level];
return b.lastUpdateDate - a.lastUpdateDate;
});

const filteredWarningData = userRole === 'mahasiswa'
? warningData.filter(w => w.nim === currentUser?.nim)
: userRole === 'dosen'
? warningData.filter(w => w.dosenNama === currentUser?.nama)
: warningData;

const totalPages = Math.ceil(filteredWarningData.length / ITEMS_PER_PAGE);
const paginatedWarningData = filteredWarningData.slice(
(currentPage - 1) * ITEMS_PER_PAGE,
currentPage * ITEMS_PER_PAGE
);

const kritisCount = warningData.filter(w => w.level === 'kritis').length;
const peringatanCount = warningData.filter(w => w.level === 'peringatan').length;

const canSendWhatsApp = userRole === 'admin' || userRole === 'operator' || userRole === 'dosen';

return (
<div className="space-y-6">
<div className="bg-gradient-to-r from-red-500 to-orange-600 rounded-2xl shadow-lg p-6 text-white">
<h2 className="text-2xl font-bold mb-2">‚ö†Ô∏è Early Warning System</h2>
<p className="text-sm opacity-90">Monitoring bimbingan yang tidak aktif dan mahasiswa semester akhir untuk deteksi dini menghindari DO</p>
</div>
<div className="grid grid-cols-1 md:grid-cols-2 gap-4">
<div className="bg-white rounded-xl shadow-sm border-2 border-red-200 p-6">
<div className="flex items-center justify-between mb-2">
<span className="text-4xl">üö®</span>
<span className="text-3xl font-black text-red-600">{kritisCount}</span>
</div>
<h3 className="text-sm font-semibold text-red-700">Status Kritis</h3>
<p className="text-xs text-gray-600 mt-1">&gt;30 hari tidak update</p>
</div>
<div className="bg-white rounded-xl shadow-sm border-2 border-yellow-200 p-6">
<div className="flex items-center justify-between mb-2">
<span className="text-4xl">‚ö†Ô∏è</span>
<span className="text-3xl font-black text-yellow-600">{peringatanCount}</span>
</div>
<h3 className="text-sm font-semibold text-yellow-700">Peringatan</h3>
<p className="text-xs text-gray-600 mt-1">14-30 hari tidak update / Semester 11-14</p>
</div>
</div>
<div className="bg-white rounded-xl shadow-sm border p-6">
<h3 className="text-lg font-bold text-gray-900 mb-4">üìä Daftar Monitoring Early Warning</h3>
<div className="space-y-3">
{paginatedWarningData.map((w, index) => (
<div key={index} className={`border-2 rounded-lg p-4 ${w.color}`}>
<div className="flex justify-between items-start mb-2">
<div className="flex items-start gap-3">
<span className="text-2xl">{w.icon}</span>
<div>
<h4 className="font-bold text-sm">
{w.type === 'semester' ? `Semester ${w.semester} (Akhir Studi)` : w.judul?.substring(0, 30) || 'Bimbingan'}
{w.type === 'bimbingan' && w.pembimbingKe && (
<span className={`ml-2 inline-block px-2 py-0.5 rounded-full text-[10px] font-semibold ${w.pembimbingKe === 1 ? 'bg-emerald-100 text-emerald-700' : 'bg-amber-100 text-amber-700'}`}>
Pembimbing {w.pembimbingKe}
</span>
)}
</h4>
<p className="text-xs mt-1">Mahasiswa: {w.nama || w.mahasiswaNama} ({w.nim})</p>
<p className="text-xs">Program Studi: {w.prodi}</p>
{w.type === 'bimbingan' && (
<>
<p className="text-xs">Dosen: {w.dosenNama}</p>
<p className="text-xs">Progress: {w.progress || 0}% ({w.meetings?.length || 0}/10 pertemuan)</p>
</>
)}
{w.type === 'semester' && (
<p className="text-xs font-semibold text-yellow-700 mt-1">‚ö†Ô∏è Mahasiswa semester akhir perlu perhatian khusus</p>
)}
</div>
</div>
<div className="text-right">
{w.type === 'bimbingan' ? (
<>
<p className="font-bold text-lg">{w.daysSinceUpdate}</p>
<p className="text-xs">hari tidak update</p>
</>
) : (
<>
<p className="font-bold text-lg">Semester {w.semester}</p>
<p className="text-xs">Akhir Studi</p>
</>
)}
</div>
</div>
<div className="mt-2">
<p className="text-xs font-semibold">
{w.level === 'kritis' && '‚ö†Ô∏è SEGERA TINDAK LANJUT! Hubungi mahasiswa dan dosen pembimbing.'}
{w.level === 'peringatan' && '‚ö†Ô∏è Perlu perhatian. Pantau perkembangan bimbingan.'}
{w.level === 'aman' && '‚úÖ Bimbingan berjalan normal.'}
</p>
</div>
{w.type === 'bimbingan' && (
<button
onClick={() => onNavigate('bimbingan')}
className="mt-2 text-xs text-emerald-600 hover:text-emerald-800 font-medium"
>
Lihat Detail Bimbingan ‚Üí
</button>
)}
{w.whatsapp && canSendWhatsApp && (
<div className="mt-3 pt-3 border-t border-current">
<button onClick={() => onSendWhatsApp(w.whatsapp, `Assalamualaikum ${w.nama || w.mahasiswaNama}, ini early warning dari FEBI UINSI. ${w.type === 'semester' ? 'Anda sudah memasuki semester akhir (Semester ' + w.semester + '), mohon segera menyelesaikan bimbingan.' : 'Mohon segera update status bimbingan Anda.'}`)} className="px-3 py-1 bg-emerald-600 text-white rounded text-xs hover:bg-emerald-700">
üì± Kirim WA Peringatan
</button>
</div>
)}
</div>
))}
{filteredWarningData.length === 0 && (
<div className="text-center py-12 text-gray-400">
<p className="text-6xl mb-4">‚úÖ</p>
<p className="text-lg">Tidak ada early warning untuk Anda</p>
</div>
)}
</div>

{/* Pagination */}
<Pagination 
currentPage={currentPage}
totalPages={totalPages}
onPageChange={setCurrentPage}
/>
</div>
</div>
);
};

const UINSI_REPOSITORY_DATA = [
// ======= PERBANKAN SYARIAH (PS) =======
{id:"u1",judul:"PENGARUH TINGKAT BAGI HASIL DAN KURS TERHADAP NET PROFIT MARGIN BANK UMUM SYARIAH DI INDONESIA PERIODE 2017-2021",penulis:"WULANSARI",prodi:"Perbankan Syariah",tahun:"2023",abstrak:"Wulansari, 2023. Pengaruh Tingkat Bagi Hasil dan Kurs Terhadap Net Profit Margin Bank Umum Syariah di Indonesia Periode 2017-2021. Skripsi, Jurusan Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5484"},
{id:"u2",judul:"PENGARUH PERSEPSI, PENGETAHUAN DAN PEMAHAMAN MASYARAKAT TENTANG PERBANKAN SYARIAH TERHADAP PENGGUNAAN JASA LAYANAN BANK SYARIAH (Studi Kasus pada Civitas Akademika UINSI Samarinda)",penulis:"FEBRYANTI, AYUNI",prodi:"Perbankan Syariah",tahun:"2023",abstrak:"Ayuni Febryanti, 2023. Pengaruh Persepsi, Pengetahuan dan Pemahaman Masyarakat tentang Bank Syariah dalam Penggunaan Jasa Layanan Bank Syariah. Skripsi, Prodi Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5481"},
{id:"u3",judul:"ANALISIS KESEHATAN BANK UMUM SYARIAH SEBELUM DAN SELAMA PANDEMI CORONA VIRUS DISEASE 2019 (COVID-19)",penulis:"WATI, RISNA",prodi:"Perbankan Syariah",tahun:"2023",abstrak:"Risna Wati, 2023. Analisis Kesehatan Bank Umum Syariah Sebelum dan Selama Pandemi Corona Virus Disease 2019 (Covid-19). Skripsi, Jurusan Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5475"},
{id:"u4",judul:"PENGARUH LITERASI KEUANGAN SYARIAH TERHADAP MINAT MENABUNG DI BANK SYARIAH INDONESIA (STUDI PADA MAHASISWA FEBI UINSI SAMARINDA)",penulis:"Hidayat, Rudi",prodi:"Perbankan Syariah",tahun:"2023",abstrak:"Rudi Hidayat, 2022. Pengaruh Literasi Keuangan Syariah Terhadap Minat Menabung di Bank Syariah Indonesia (Studi Pada Mahasiswa FEBI UINSI Samarinda). Skripsi, Jurusan Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5456"},
{id:"u5",judul:"PENGARUH KUALITAS LAYANAN, KUALITAS PRODUK DAN KEPUASAN NASABAH PENGGUNA BSI MOBILE TERHADAP LOYALITAS NASABAH BANK SYARIAH INDONESIA DI KOTA SAMARINDA",penulis:"PUTERI, SHINDY SAFIRA",prodi:"Perbankan Syariah",tahun:"2023",abstrak:"Shindy Safira Puteri, 2023. Pengaruh Kualitas Layanan, Kualitas Produk dan Kepuasan Nasabah Pengguna BSI Mobile Terhadap Loyalitas Nasabah Bank Syariah Indonesia di Kota Samarinda. Skripsi, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5448"},
{id:"u6",judul:"FAKTOR-FAKTOR YANG MEMPENGARUHI MINAT MASYARAKAT MENABUNG DI BANK SYARIAH INDONESIA KCP BUNG TOMO SAMARINDA SEBERANG",penulis:"WAHYUDI",prodi:"Perbankan Syariah",tahun:"2023",abstrak:"Wahyudi, 2023. Faktor-Faktor Yang Mempengaruhi Minat Masyarakat Menabung di Bank Syariah Indonesia KCP Bung Tomo Samarinda Seberang. Skripsi, Jurusan Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5431"},
{id:"u7",judul:"ANALISIS PENGARUH PEMBIAYAAN TERHADAP KEMAMPUAN LABA DENGAN NON PERFORMING FINANCING (NPF) SEBAGAI VARIABEL MODERASI PADA PT. BANK BNI SYARIAH PERIODE 2018-2020",penulis:"ANGGRAINI, FRISKA MULINDA",prodi:"Perbankan Syariah",tahun:"2022",abstrak:"Friska Mulinda Anggraini, 2022. Analisis Pengaruh Pembiayaan Terhadap Kemampuan Laba dengan NPF sebagai Variabel Moderasi pada PT. Bank BNI Syariah Periode 2018-2020. Skripsi, Jurusan Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5387"},
{id:"u8",judul:"PENGARUH PROMO GRATIS ONGKOS KIRIM, ONLINE CUSTOMER REVIEW, DAN LAYANAN CASH ON DELIVERY TERHADAP KEPUTUSAN PEMBELIAN DI FITUR TIKTOK SHOP PADA GENERASI MUSLIM Y DAN GENERASI MUSLIM Z DI KALIMANTAN TIMUR",penulis:"FAUZIAH, RIZKY NOR",prodi:"Ekonomi Syariah",tahun:"2023",abstrak:"Rizky Nor Fauziah, 2023. Pengaruh Promo Gratis Ongkos Kirim, Online Customer Review, dan Layanan Cash On Delivery terhadap Keputusan Pembelian di Fitur Tiktok Shop. Skripsi, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5381"},
{id:"u9",judul:"ANALISIS STRATEGI PEMASARAN PRODUK DALAM MENARIK MINAT NASABAH PADA PT. PEGADAIAN SYARIAH CABANG PELITA KOTA SAMARINDA",penulis:"RAHAYU, HOSNITA TIKA",prodi:"Ekonomi Syariah",tahun:"2023",abstrak:"Hosnita Tika Rahayu, 2023. Analisis Strategi Pemasaran Produk dalam Menarik Minat Nasabah pada PT. Pegadaian Syariah Cabang Pelita Kota Samarinda. Skripsi, Program Studi Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5380"},
{id:"u10",judul:"ANALISIS PERMASALAHAN SUMBER DAYA MANUSIA PADA BAITUL MAAL WAT TAMWIL (BMT) (Studi BMT UGT Nusantara Samarinda)",penulis:"ARIANI",prodi:"Perbankan Syariah",tahun:"2023",abstrak:"Ariani, 2023. Analisis Permasalahan Sumber Daya Manusia pada Baitul Maal Wat Tamwil (BMT) (Studi BMT UGT Nusantara Samarinda). Skripsi, Jurusan Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5376"},
{id:"u11",judul:"PENGARUH SHARIAH COMPLIANCE DAN INTELLECTUAL CAPITAL TERHADAP PROFITABILITAS BANK UMUM SYARIAH DI INDONESIA (PERIODE 2018-2022)",penulis:"ANGGRAINI, NOVA SISKA",prodi:"Perbankan Syariah",tahun:"2023",abstrak:"Nova Siska Anggraini, 2023. Pengaruh Shariah Compliance dan Intellectual Capital Terhadap Profitabilitas (ROA) Bank Umum Syariah di Indonesia Periode 2018-2022. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5370"},
{id:"u12",judul:"FAKTOR-FAKTOR YANG MEMPENGARUHI PENGUSAHA MUSLIM MEMILIH PINJAMAN PADA BANK KONVENSIONAL (Studi Kelompok UMKM Kecamatan Sungai Kunjang Kota Samarinda)",penulis:"Putri, Helmalia",prodi:"Perbankan Syariah",tahun:"2023",abstrak:"Helmalia Putri, 2023. Faktor-Faktor yang Mempengaruhi Pengusaha Muslim Memilih Pinjaman Pada Bank Konvensional (Studi UMKM Kecamatan Sungai Kunjang Samarinda). Skripsi, Jurusan Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5467"},
{id:"u13",judul:"PENGARUH RASIO KECUKUPAN LIKUIDITAS DAN PROFITABILITAS TERHADAP RETURN SAHAM PADA BANK UMUM SYARIAH DI INDONESIA PERIODE 2019-2022",penulis:"Sari, Rizki Laili",prodi:"Perbankan Syariah",tahun:"2023",abstrak:"Rizki Laili Sari, 2023. Pengaruh Rasio Kecukupan Likuiditas dan Profitabilitas Terhadap Return Saham pada Bank Umum Syariah di Indonesia Periode 2019-2022. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5370"},
{id:"u14",judul:"PENGARUH DANA PIHAK KETIGA (DPK) DAN PEMBIAYAAN BAGI HASIL TERHADAP LIKUIDITAS PADA BANK UMUM SYARIAH PERIODE 2018-2023",penulis:"TURMUDZI, AHMAD RAUF IMAN",prodi:"Perbankan Syariah",tahun:"2024",abstrak:"Ahmad Rauf Iman Turmudzi, 2024. Pengaruh Dana Pihak Ketiga (DPK) dan Pembiayaan Bagi Hasil terhadap Likuiditas pada Bank Umum Syariah Periode 2018-2023. Skripsi, Jurusan Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5484"},
{id:"u15",judul:"ANALISIS MANAJEMEN RISIKO PADA PEMBIAYAAN KPR DALAM MENEKAN PEMBIAYAAN BERMASALAH (Studi BSI KCP Pahlawan Kota Samarinda)",penulis:"Risma, Elika Diana",prodi:"Perbankan Syariah",tahun:"2024",abstrak:"Elika Diana Risma, 2024. Analisis Manajemen Risiko Pada Pembiayaan KPR Dalam Menekan Pembiayaan Bermasalah (Studi BSI KCP Pahlawan Kota Samarinda). Skripsi, Jurusan Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5475"},
{id:"u16",judul:"PERBANDINGAN KINERJA KEUANGAN ANTARA BANK MEGA SYARIAH DAN BANK SYARIAH BUKOPIN SEBELUM DAN SELAMA PANDEMI COVID-19",penulis:"Hairatunisa, Siti",prodi:"Perbankan Syariah",tahun:"2023",abstrak:"Siti Hairatunisa, 2023. Perbandingan Kinerja Keuangan Antara Bank Mega Syariah dan Bank Syariah Bukopin Sebelum dan Selama Pandemi Covid-19. Skripsi, Jurusan Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5481"},
{id:"u17",judul:"FAKTOR-FAKTOR YANG MEMPENGARUHI RETURN ON ASSETS PADA BANK UMUM SYARIAH DI INDONESIA PERIODE 2018-2022",penulis:"Marinda, Dina",prodi:"Perbankan Syariah",tahun:"2023",abstrak:"Dina Marinda, 2023. Faktor-faktor Yang Mempengaruhi Return on Assets pada Bank Umum Syariah di Indonesia Periode 2018-2022. Skripsi, Jurusan Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5456"},
{id:"u18",judul:"FAKTOR-FAKTOR YANG MEMPENGARUHI TOTAL ASET PERBANKAN SYARIAH PERIODE 2015-2019",penulis:"Wulan Sari, Deasy Rus",prodi:"Perbankan Syariah",tahun:"2020",abstrak:"Deasy Rus Wulan Sari, 2020. Faktor-Faktor yang Mempengaruhi Total Aset Perbankan Syariah Periode 2015-2019. Skripsi, Jurusan Perbankan Syariah, FEBI IAIN Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5387"},
{id:"u19",judul:"INFLASI, JUMLAH UANG BEREDAR, DAN PERTUMBUHAN EKSPOR TERHADAP TOTAL PEMBIAYAAN PERBANKAN SYARIAH DENGAN DANA PIHAK KETIGA SEBAGAI VARIABEL MODERATING",penulis:"Fitriana",prodi:"Perbankan Syariah",tahun:"2023",abstrak:"Fitriana, 2023. Inflasi, Jumlah Uang Beredar, dan Pertumbuhan Ekspor terhadap Total Pembiayaan Perbankan Syariah dengan Dana Pihak Ketiga Sebagai Variabel Moderating. Skripsi, Jurusan Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5381"},
{id:"u20",judul:"FAKTOR INTERNAL PENENTUAN STABILITAS BANK UMUM SYARIAH DI INDONESIA PERIODE 2018-2022",penulis:"Yanti, Fitri",prodi:"Perbankan Syariah",tahun:"2023",abstrak:"Fitri Yanti, 2023. Faktor Internal Penentuan Stabilitas Bank Umum Syariah di Indonesia Periode 2018-2022. Skripsi, Program Studi Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5380"},
{id:"u21",judul:"FAKTOR YANG MEMPENGARUHI KINERJA PEGAWAI PADA BANK SYARIAH INDONESIA KCP BALIKPAPAN BARU",penulis:"Asmi, Nuratfal Romadhan",prodi:"Perbankan Syariah",tahun:"2023",abstrak:"Nuratfal Romadhan Asmi, 2023. Faktor Yang Mempengaruhi Kinerja Pegawai Pada Bank Syariah Indonesia KCP Balikpapan Baru. Skripsi, Jurusan Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5376"},
{id:"u22",judul:"FAKTOR-FAKTOR YANG MEMENGARUHI MINAT MAHASISWA MENJADI NASABAH BANK SYARIAH (Studi Kasus Mahasiswa FEBI UINSI Samarinda)",penulis:"Jekky",prodi:"Perbankan Syariah",tahun:"2022",abstrak:"Jekky, 2022. Faktor-faktor Yang Memengaruhi Minat Mahasiswa Menjadi Nasabah Bank Syariah (Studi Kasus Mahasiswa FEBI UINSI Samarinda). Skripsi, Jurusan Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5456"},
{id:"u23",judul:"FAKTOR-FAKTOR YANG MEMENGARUHI MINAT MASYARAKAT DALAM MEMILIH BANK SYARIAH DENGAN PENDEKATAN THEORY OF PLANNED BEHAVIOR (TPB) (Studi Masyarakat Kecamatan Sungai Kunjang)",penulis:"Rahmayanti, Nisa Dwi",prodi:"Perbankan Syariah",tahun:"2023",abstrak:"Nisa Dwi Rahmayanti, 2023. Faktor-faktor yang Memengaruhi minat masyarakat dalam memilih bank syariah dengan pendekatan Theory of Planned Behavior (TPB). Skripsi, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5448"},
{id:"u24",judul:"FAKTOR-FAKTOR YANG MEMPENGARUHI NASABAH DALAM KEPUTUSAN MENABUNG DI BANK PEMBIAYAAN RAKYAT SYARIAH MANFAAT BALIKPAPAN",penulis:"Damayanti, Reni",prodi:"Perbankan Syariah",tahun:"2022",abstrak:"Reni Damayanti, 2022. Faktor-Faktor Yang Mempengaruhi Nasabah Dalam Keputusan Menabung Di Bank Pembiayaan Rakyat Syariah Manfaat Balikpapan. Skripsi, Jurusan Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5431"},
{id:"u25",judul:"FAKTOR-FAKTOR YANG MEMPENGARUHI DANA PIHAK KETIGA BANK UMUM SYARIAH DI INDONESIA",penulis:"Marwah",prodi:"Perbankan Syariah",tahun:"2021",abstrak:"Marwah, 2021. Faktor-faktor yang Mempengaruhi Dana Pihak Ketiga Bank Umum Syariah di Indonesia. Skripsi, Jurusan Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5387"},
{id:"u26",judul:"FAKTOR-FAKTOR YANG MEMPENGARUHI DEPOSITO VALUTA ASING PADA BANK UMUM SYARIAH DI INDONESIA PERIODE 2015-2019",penulis:"Ramadhani, Shally",prodi:"Perbankan Syariah",tahun:"2020",abstrak:"Shally Ramadhani, 2020. Faktor-Faktor Yang Mempengaruhi Deposito Valuta Asing Pada Bank Umum Syariah Di Indonesia Periode 2015-2019. Skripsi, Jurusan Perbankan Syariah, FEBI IAIN Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5475"},
{id:"u27",judul:"FAKTOR-FAKTOR YANG MEMPENGARUHI KINERJA KEUANGAN BANK UMUM SYARIAH YANG TERDAFTAR DI BURSA EFEK INDONESIA PERIODE 2021-2022",penulis:"Ayuni, Bunga Putri",prodi:"Perbankan Syariah",tahun:"2023",abstrak:"Bunga Putri Ayuni, 2023. Faktor-Faktor Yang Mempengaruhi Kinerja Keuangan Bank Umum Syariah Yang Terdaftar Di Bursa Efek Indonesia Periode 2021-2022. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5481"},
{id:"u28",judul:"FAKTOR-FAKTOR YANG MEMPENGARUHI LABA BERSIH BANK UMUM SYARIAH DI INDONESIA PERIODE 2017-2022",penulis:"Nurfatimah, Andi Nimas",prodi:"Perbankan Syariah",tahun:"2023",abstrak:"Andi Nimas Nurfatimah, 2023. Faktor-Faktor Yang Mempengaruhi Laba Bersih Bank Umum Syariah Di Indonesia Periode 2017-2022. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5456"},
{id:"u29",judul:"FAKTOR-FAKTOR YANG MEMPENGARUHI MARKET SHARE BANK UMUM SYARIAH DI INDONESIA PERIODE 2017-2022",penulis:"Haliana",prodi:"Perbankan Syariah",tahun:"2023",abstrak:"Haliana, 2023. Faktor-Faktor Yang Mempengaruhi Market Share Bank Umum Syariah di Indonesia Periode 2017-2022. Skripsi, Jurusan Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5431"},
{id:"u30",judul:"FAKTOR-FAKTOR YANG MEMPENGARUHI MINAT NASABAH UNTUK MENGGUNAKAN PEMBAYARAN DIGITAL QRIS BANK SYARIAH INDONESIA DI KOTA SAMARINDA",penulis:"Maulida, Nelly Nurul",prodi:"Perbankan Syariah",tahun:"2023",abstrak:"Nelly Nurul Maulida, 2023. Faktor-Faktor Yang Mempengaruhi Minat Nasabah Untuk Menggunakan Pembayaran Digital QRIS Bank Syariah Indonesia di Kota Samarinda. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5387"},
{id:"u31",judul:"PENGARUH CAR, FDR, DAN BOPO TERHADAP PROFITABILITAS BANK UMUM SYARIAH DI INDONESIA PERIODE 2018-2022",penulis:"Islamiyah, Nurul",prodi:"Perbankan Syariah",tahun:"2023",abstrak:"Nurul Islamiyah, 2023. Pengaruh CAR, FDR, dan BOPO Terhadap Profitabilitas Bank Umum Syariah di Indonesia Periode 2018-2022. Skripsi, Jurusan Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5376"},
{id:"u32",judul:"PENGARUH CAPITAL ADEQUACY RATIO (CAR) DAN NON PERFORMING FINANCING (NPF) TERHADAP RETURN ON ASSET (ROA) PADA BANK UMUM SYARIAH",penulis:"Lestari, Winda",prodi:"Perbankan Syariah",tahun:"2022",abstrak:"Winda Lestari, 2022. Pengaruh Capital Adequacy Ratio (CAR) dan Non Performing Financing (NPF) Terhadap Return On Asset (ROA) Pada Bank Umum Syariah. Skripsi, Jurusan Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5370"},
{id:"u33",judul:"PENGARUH FINANCING TO DEPOSIT RATIO (FDR) DAN NET PERFORMING FINANCING (NPF) TERHADAP TINGKAT BAGI HASIL DEPOSITO MUDHARABAH PADA BANK UMUM SYARIAH DI INDONESIA",penulis:"Safitri, Ririn Ayu",prodi:"Perbankan Syariah",tahun:"2022",abstrak:"Ririn Ayu Safitri, 2022. Pengaruh Financing to Deposit Ratio (FDR) dan Net Performing Financing (NPF) Terhadap Tingkat Bagi Hasil Deposito Mudharabah. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5467"},
{id:"u34",judul:"PENGARUH GOOD CORPORATE GOVERNANCE, CAPITAL ADEQUACY RATIO, DAN PROFITABILITAS TERHADAP KESEHATAN PERBANKAN SYARIAH DI INDONESIA",penulis:"Hidayah, Nur",prodi:"Perbankan Syariah",tahun:"2023",abstrak:"Nur Hidayah, 2023. Pengaruh Good Corporate Governance, Capital Adequacy Ratio, dan Profitabilitas Terhadap Kesehatan Perbankan Syariah di Indonesia. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5456"},
{id:"u35",judul:"PENGARUH INFLASI DAN SUKU BUNGA TERHADAP PEMBIAYAAN BERMASALAH (NPF) PADA BANK UMUM SYARIAH DI INDONESIA PERIODE 2016-2021",penulis:"Amalia, Rizka",prodi:"Perbankan Syariah",tahun:"2022",abstrak:"Rizka Amalia, 2022. Pengaruh Inflasi dan Suku Bunga Terhadap Pembiayaan Bermasalah (NPF) Pada Bank Umum Syariah di Indonesia Periode 2016-2021. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5448"},
{id:"u36",judul:"PENGARUH ISLAMICITY PERFORMANCE INDEX TERHADAP PROFITABILITAS BANK UMUM SYARIAH DI INDONESIA PERIODE 2018-2022",penulis:"Fitriani, Dian",prodi:"Perbankan Syariah",tahun:"2023",abstrak:"Dian Fitriani, 2023. Pengaruh Islamicity Performance Index Terhadap Profitabilitas Bank Umum Syariah di Indonesia Periode 2018-2022. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5431"},
{id:"u37",judul:"PENGARUH KEPERCAYAAN, KEMUDAHAN, DAN KUALITAS INFORMASI TERHADAP KEPUTUSAN PEMBELIAN ONLINE PADA MARKETPLACE SHOPEE DI KOTA SAMARINDA",penulis:"Nadia, Ema",prodi:"Perbankan Syariah",tahun:"2022",abstrak:"Ema Nadia, 2022. Pengaruh Kepercayaan, Kemudahan, dan Kualitas Informasi Terhadap Keputusan Pembelian Online pada Marketplace Shopee di Kota Samarinda. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5387"},
{id:"u38",judul:"PENGARUH MODAL SOSIAL DAN RELIGIUSITAS TERHADAP KEBERHASILAN USAHA PELAKU UMKM DI KOTA SAMARINDA",penulis:"Larasati, Dewi",prodi:"Perbankan Syariah",tahun:"2022",abstrak:"Dewi Larasati, 2022. Pengaruh Modal Sosial dan Religiusitas Terhadap Keberhasilan Usaha Pelaku UMKM di Kota Samarinda. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5376"},
{id:"u39",judul:"PENGARUH PENERAPAN E-BANKING TERHADAP KEPUASAN DAN LOYALITAS NASABAH BANK SYARIAH INDONESIA DI SAMARINDA",penulis:"Wahyuningsih, Sri",prodi:"Perbankan Syariah",tahun:"2023",abstrak:"Sri Wahyuningsih, 2023. Pengaruh Penerapan E-Banking Terhadap Kepuasan dan Loyalitas Nasabah Bank Syariah Indonesia di Samarinda. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5370"},
{id:"u40",judul:"PENGARUH PENDAPATAN BAGI HASIL DAN PENDAPATAN MARGIN MURABAHAH TERHADAP PROFITABILITAS BANK UMUM SYARIAH DI INDONESIA",penulis:"Septiana, Aulia",prodi:"Perbankan Syariah",tahun:"2022",abstrak:"Aulia Septiana, 2022. Pengaruh Pendapatan Bagi Hasil dan Pendapatan Margin Murabahah Terhadap Profitabilitas Bank Umum Syariah di Indonesia. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5467"},
{id:"u41",judul:"PENGARUH PERTUMBUHAN EKONOMI, INFLASI, DAN NILAI TUKAR TERHADAP PEMBIAYAAN MUDHARABAH PADA BANK UMUM SYARIAH DI INDONESIA",penulis:"Maulana, Arif",prodi:"Perbankan Syariah",tahun:"2023",abstrak:"Arif Maulana, 2023. Pengaruh Pertumbuhan Ekonomi, Inflasi, dan Nilai Tukar Terhadap Pembiayaan Mudharabah pada Bank Umum Syariah di Indonesia. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5456"},
{id:"u42",judul:"PENGARUH PRODUK, HARGA, PROMOSI, DAN TEMPAT TERHADAP KEPUASAN NASABAH BANK SYARIAH INDONESIA CABANG SAMARINDA",penulis:"Oktaviani, Reni",prodi:"Perbankan Syariah",tahun:"2023",abstrak:"Reni Oktaviani, 2023. Pengaruh Produk, Harga, Promosi, dan Tempat Terhadap Kepuasan Nasabah Bank Syariah Indonesia Cabang Samarinda. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5448"},
{id:"u43",judul:"PENGARUH TABUNGAN WADIAH DAN DEPOSITO MUDHARABAH TERHADAP PROFITABILITAS BANK UMUM SYARIAH DI INDONESIA PERIODE 2017-2021",penulis:"Rahmawati, Anita",prodi:"Perbankan Syariah",tahun:"2022",abstrak:"Anita Rahmawati, 2022. Pengaruh Tabungan Wadiah dan Deposito Mudharabah Terhadap Profitabilitas Bank Umum Syariah di Indonesia Periode 2017-2021. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5431"},
{id:"u44",judul:"ANALISIS EFISIENSI BANK UMUM SYARIAH DI INDONESIA MENGGUNAKAN METODE DATA ENVELOPMENT ANALYSIS (DEA) PERIODE 2019-2022",penulis:"Kusuma, Bagas Adi",prodi:"Perbankan Syariah",tahun:"2023",abstrak:"Bagas Adi Kusuma, 2023. Analisis Efisiensi Bank Umum Syariah di Indonesia Menggunakan Metode Data Envelopment Analysis (DEA) Periode 2019-2022. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5387"},
{id:"u45",judul:"ANALISIS PENGARUH GOOD CORPORATE GOVERNANCE TERHADAP KINERJA KEUANGAN BANK UMUM SYARIAH DI INDONESIA",penulis:"Sundari, Puji",prodi:"Perbankan Syariah",tahun:"2022",abstrak:"Puji Sundari, 2022. Analisis Pengaruh Good Corporate Governance Terhadap Kinerja Keuangan Bank Umum Syariah di Indonesia. Skripsi, Jurusan Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5376"},
{id:"u46",judul:"PERAN FINTECH LENDING DALAM PENGEMBANGAN USAHA MIKRO KECIL DAN MENENGAH (UMKM) PERSPEKTIF EKONOMI SYARIAH",penulis:"Harlina, Mutiara",prodi:"Perbankan Syariah",tahun:"2023",abstrak:"Mutiara Harlina, 2023. Peran Fintech Lending dalam Pengembangan Usaha Mikro Kecil dan Menengah (UMKM) Perspektif Ekonomi Syariah. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5370"},
{id:"u47",judul:"PENGARUH BIAYA OPERASIONAL DAN PENDAPATAN OPERASIONAL (BOPO) TERHADAP NET INTEREST MARGIN BANK UMUM SYARIAH",penulis:"Astuti, Wuri",prodi:"Perbankan Syariah",tahun:"2022",abstrak:"Wuri Astuti, 2022. Pengaruh Biaya Operasional dan Pendapatan Operasional (BOPO) Terhadap Net Interest Margin Bank Umum Syariah. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5456"},
{id:"u48",judul:"STRATEGI PENGEMBANGAN PRODUK TABUNGAN HAJI PADA BANK SYARIAH INDONESIA KCP SAMARINDA SEBERANG",penulis:"Komalasari, Dewi",prodi:"Perbankan Syariah",tahun:"2023",abstrak:"Dewi Komalasari, 2023. Strategi Pengembangan Produk Tabungan Haji pada Bank Syariah Indonesia KCP Samarinda Seberang. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5481"},
{id:"u49",judul:"PENGARUH KECERDASAN EMOSIONAL DAN SPIRITUAL TERHADAP KINERJA KARYAWAN BANK SYARIAH INDONESIA KANTOR PUSAT SAMARINDA",penulis:"Fitriyah, Wahidah",prodi:"Perbankan Syariah",tahun:"2023",abstrak:"Wahidah Fitriyah, 2023. Pengaruh Kecerdasan Emosional dan Spiritual Terhadap Kinerja Karyawan Bank Syariah Indonesia Kantor Pusat Samarinda. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5484"},
{id:"u50",judul:"IMPLEMENTASI AKAD MURABAHAH PADA PEMBIAYAAN KEPEMILIKAN RUMAH (KPR) DI BANK SYARIAH INDONESIA KC SAMARINDA",penulis:"Rahmah, Nurul",prodi:"Perbankan Syariah",tahun:"2022",abstrak:"Nurul Rahmah, 2022. Implementasi Akad Murabahah pada Pembiayaan Kepemilikan Rumah (KPR) di Bank Syariah Indonesia KC Samarinda. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5475"},
// ======= EKONOMI SYARIAH (ES) =======
{id:"u51",judul:"ANALISIS PEMASARAN MINUMAN PONDOK COKLAT TEH DUA DAUN DI SAMARINDA (PERSPEKTIF PEMASARAN SYARIAH)",penulis:"MEGAWATI",prodi:"Ekonomi Syariah",tahun:"2023",abstrak:"Megawati, 2023. Analisis Pemasaran Minuman Pondok Coklat Teh Dua Daun di Samarinda (Perspektif Pemasaran Syariah). Skripsi, Jurusan Ekonomi Syari'ah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5476"},
{id:"u52",judul:"PENGARUH LINGKUNGAN KERJA, DISIPLIN KERJA, RELIGIUSITAS DAN KOMPENSASI TERHADAP KINERJA PEGAWAI BADAN AMIL ZAKAT NASIONAL PROVINSI KALIMANTAN TIMUR",penulis:"EFFENDI, SAFU'AN MAHFUD",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Safu'an Mahfud Effendi, 2022. Pengaruh Lingkungan Kerja, Disiplin Kerja, Religiusitas dan Kompensasi Terhadap Kinerja Pegawai Badan Amil Zakat Nasional Provinsi Kalimantan Timur. Skripsi, Jurusan Ekonomi Syari'ah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5474"},
{id:"u53",judul:"PENGARUH INFLASI, SAHAM SYARIAH, SUKUK, REKSADANA SYARIAH DAN ASURANSI SYARIAH TERHADAP PERTUMBUHAN EKONOMI DI INDONESIA TAHUN 2015-2022",penulis:"PUTRA, DERMAWAN HAS",prodi:"Ekonomi Syariah",tahun:"2023",abstrak:"Dermawan Has Putra, 2023. Pengaruh Inflasi, Saham Syariah, Sukuk, Reksadana Syariah dan Asuransi Syariah Terhadap Pertumbuhan Ekonomi di Indonesia Tahun 2015-2022. Skripsi, Jurusan Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5472"},
{id:"u54",judul:"PENGARUH TINGKAT KEMISKINAN, INFLASI, SAHAM SYARIAH DAN OBLIGASI SYARIAH TERHADAP PERTUMBUHAN EKONOMI DI INDONESIA PERIODE 2015-2020",penulis:"MA'RIFAH, ALVINA NURUL",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Alvina Nurul Ma'rifah, 2022. Pengaruh Tingkat Kemiskinan, Inflasi, Saham Syariah, dan Obligasi Syariah Terhadap Pertumbuhan Ekonomi di Indonesia Periode 2015-2020. Skripsi, Jurusan Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5464"},
{id:"u55",judul:"ANALISIS PENGARUH PENDAPATAN PAJAK NASIONAL, PENANAMAN MODAL ASING, DAN INSTRUMEN MONETER SYARIAH TERHADAP PERTUMBUHAN EKONOMI DI INDONESIA PERIODE 2017-2022",penulis:"WIDIYANINGSIH, EKI",prodi:"Ekonomi Syariah",tahun:"2023",abstrak:"Eki Widiyaningsih, 2023. Analisis Pengaruh Penerimaan Pajak Nasional, Penanaman Modal Asing, dan Instrumen Moneter Syariah terhadap Pertumbuhan Ekonomi di Indonesia Periode 2017-2022. Skripsi, Jurusan Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5449"},
{id:"u56",judul:"ANALISIS STRATEGI FUNDRAISING DANA ZAKAT, INFAK, DAN SEDEKAH MASA PANDEMI CORONA VIRUS DISEASE-19 DI BADAN AMIL ZAKAT NASIONAL KOTA BALIKPAPAN",penulis:"WULANDARI, CICI TRI",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Cici Tri Wulandari, 2022. Analisis Strategi Fundraising Dana Zakat, Infak, dan Sedekah Masa Pandemi Corona Virus Disease-19 di BAZNAS Kota Balikpapan. Skripsi, Jurusan Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5430"},
{id:"u57",judul:"PENGARUH ZAKAT, INFAK, DAN SEDEKAH (ZIS) TERHADAP INDEKS PEMBANGUNAN MANUSIA DI INDONESIA",penulis:"Rahmawati, Siti",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Siti Rahmawati, 2022. Pengaruh Zakat, Infak, dan Sedekah (ZIS) Terhadap Indeks Pembangunan Manusia di Indonesia. Skripsi, Jurusan Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5474"},
{id:"u58",judul:"PENGARUH BELANJA DAERAH, DANA OTONOMI KHUSUS, DAN PENDAPATAN ASLI DAERAH TERHADAP KEMISKINAN DI PROVINSI KALIMANTAN TIMUR",penulis:"Hasanah, Uswatun",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Uswatun Hasanah, 2022. Pengaruh Belanja Daerah, Dana Otonomi Khusus, dan Pendapatan Asli Daerah Terhadap Kemiskinan di Provinsi Kalimantan Timur. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5472"},
{id:"u59",judul:"DAMPAK PROGRAM CORPORATE SOCIAL RESPONSIBILITY (CSR) PT. PUPUK KALIMANTAN TIMUR TERHADAP KONDISI SOSIAL EKONOMI MASYARAKAT DI KOTA BONTANG",penulis:"Salamah, Nur",prodi:"Ekonomi Syariah",tahun:"2023",abstrak:"Nur Salamah, 2023. Dampak Program Corporate Social Responsibility (CSR) PT. Pupuk Kalimantan Timur Terhadap Kondisi Sosial Ekonomi Masyarakat di Kota Bontang. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5464"},
{id:"u60",judul:"ANALISIS IMPLEMENTASI WAKAF UANG UNTUK PENGEMBANGAN USAHA PRODUKTIF DI KOTA SAMARINDA",penulis:"Kurniawan, Diky",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Diky Kurniawan, 2022. Analisis Implementasi Wakaf Uang untuk Pengembangan Usaha Produktif di Kota Samarinda. Skripsi, Jurusan Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5449"},
{id:"u61",judul:"PENGARUH GAYA KEPEMIMPINAN DAN MOTIVASI KERJA TERHADAP KINERJA KARYAWAN PADA PERUSAHAAN DAERAH AIR MINUM KOTA SAMARINDA",penulis:"Sari, Nurhalimah",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Nurhalimah Sari, 2022. Pengaruh Gaya Kepemimpinan dan Motivasi Kerja Terhadap Kinerja Karyawan Pada Perusahaan Daerah Air Minum Kota Samarinda. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5430"},
{id:"u62",judul:"PENGARUH KUALITAS PRODUK, KUALITAS PELAYANAN DAN NILAI PELANGGAN TERHADAP KEPUASAN KONSUMEN PADA PRODUK TELKOM INDIHOME DI KOTA SAMARINDA",penulis:"Rahmatullah, Andika",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Andika Rahmatullah, 2022. Pengaruh Kualitas Produk, Kualitas Pelayanan dan Nilai Pelanggan Terhadap Kepuasan Konsumen pada Produk Telkom Indihome di Kota Samarinda. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5474"},
{id:"u63",judul:"PERAN LEMBAGA KEUANGAN MIKRO SYARIAH DALAM MENINGKATKAN KESEJAHTERAAN ANGGOTA BMT (Studi Kasus BMT Bina Insan Mandiri Samarinda)",penulis:"Widyasari, Dewi",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Dewi Widyasari, 2022. Peran Lembaga Keuangan Mikro Syariah dalam Meningkatkan Kesejahteraan Anggota BMT (Studi Kasus BMT Bina Insan Mandiri Samarinda). Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5472"},
{id:"u64",judul:"ANALISIS PEMBERDAYAAN MASYARAKAT MELALUI PROGRAM ZAKAT PRODUKTIF PADA BAZNAS PROVINSI KALIMANTAN TIMUR",penulis:"Susanti, Dewi",prodi:"Ekonomi Syariah",tahun:"2023",abstrak:"Dewi Susanti, 2023. Analisis Pemberdayaan Masyarakat Melalui Program Zakat Produktif pada BAZNAS Provinsi Kalimantan Timur. Skripsi, Jurusan Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5464"},
{id:"u65",judul:"PENGARUH PERTUMBUHAN EKONOMI, PENGANGGURAN, DAN BELANJA MODAL TERHADAP KEMISKINAN DI KABUPATEN/KOTA PROVINSI KALIMANTAN TIMUR",penulis:"Rahmadiani, Putri",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Putri Rahmadiani, 2022. Pengaruh Pertumbuhan Ekonomi, Pengangguran, dan Belanja Modal Terhadap Kemiskinan di Kabupaten/Kota Provinsi Kalimantan Timur. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5449"},
{id:"u66",judul:"PENGARUH NILAI TUKAR DAN INFLASI TERHADAP NILAI EKSPOR MINYAK SAWIT INDONESIA KE INDIA TAHUN 2012-2022",penulis:"Purnama, Cahya",prodi:"Ekonomi Syariah",tahun:"2023",abstrak:"Cahya Purnama, 2023. Pengaruh Nilai Tukar dan Inflasi Terhadap Nilai Ekspor Minyak Sawit Indonesia ke India Tahun 2012-2022. Skripsi, Jurusan Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5430"},
{id:"u67",judul:"PENGARUH CORPORATE SOCIAL RESPONSIBILITY (CSR) TERHADAP CITRA PERUSAHAAN PADA PT. PERTAMINA HULU MAHAKAM DI KOTA SAMARINDA",penulis:"Rahmana, Syelvi Aulia",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Syelvi Aulia Rahmana, 2022. Pengaruh Corporate Social Responsibility (CSR) Terhadap Citra Perusahaan pada PT. Pertamina Hulu Mahakam di Kota Samarinda. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5474"},
{id:"u68",judul:"STRATEGI PEMASARAN PRODUK HALAL DALAM MENINGKATKAN PENJUALAN PADA USAHA MIKRO KECIL MENENGAH (UMKM) DI KOTA SAMARINDA",penulis:"Azzahra, Fira",prodi:"Ekonomi Syariah",tahun:"2023",abstrak:"Fira Azzahra, 2023. Strategi Pemasaran Produk Halal dalam Meningkatkan Penjualan pada Usaha Mikro Kecil Menengah (UMKM) di Kota Samarinda. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5472"},
{id:"u69",judul:"ANALISIS PENGARUH PENDAPATAN, PENDIDIKAN, DAN PENGANGGURAN TERHADAP KEMISKINAN DI PROVINSI KALIMANTAN TIMUR TAHUN 2012-2021",penulis:"Amini, Sri",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Sri Amini, 2022. Analisis Pengaruh Pendapatan, Pendidikan, dan Pengangguran Terhadap Kemiskinan di Provinsi Kalimantan Timur Tahun 2012-2021. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5464"},
{id:"u70",judul:"PENGARUH MODAL, TENAGA KERJA, DAN TEKNOLOGI TERHADAP PRODUKSI USAHA KECIL MENENGAH (UKM) BATIK KHAS SAMARINDA",penulis:"Kartika, Dewi Ayu",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Dewi Ayu Kartika, 2022. Pengaruh Modal, Tenaga Kerja, dan Teknologi Terhadap Produksi Usaha Kecil Menengah (UKM) Batik Khas Samarinda. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5449"},
{id:"u71",judul:"ANALISIS PENGELOLAAN DANA DESA DALAM MENINGKATKAN PEREKONOMIAN MASYARAKAT DI DESA MUARA BENGKAL ILIR KABUPATEN KUTAI TIMUR",penulis:"Rahayu, Dewi",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Dewi Rahayu, 2022. Analisis Pengelolaan Dana Desa dalam Meningkatkan Perekonomian Masyarakat di Desa Muara Bengkal Ilir Kabupaten Kutai Timur. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5430"},
{id:"u72",judul:"PENGARUH LABEL HALAL, HARGA, DAN KUALITAS PRODUK TERHADAP KEPUTUSAN PEMBELIAN PRODUK MAKANAN OLAHAN IMPOR DI KOTA SAMARINDA",penulis:"Luthfiyah, Noor",prodi:"Ekonomi Syariah",tahun:"2023",abstrak:"Noor Luthfiyah, 2023. Pengaruh Label Halal, Harga, dan Kualitas Produk Terhadap Keputusan Pembelian Produk Makanan Olahan Impor di Kota Samarinda. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5474"},
{id:"u73",judul:"PENGARUH MEDIA SOSIAL, WORD OF MOUTH, DAN KEPERCAYAAN TERHADAP KEPUTUSAN PEMBELIAN PRODUK FASHION MUSLIM DI KOTA SAMARINDA",penulis:"Handayani, Nur",prodi:"Ekonomi Syariah",tahun:"2023",abstrak:"Nur Handayani, 2023. Pengaruh Media Sosial, Word of Mouth, dan Kepercayaan Terhadap Keputusan Pembelian Produk Fashion Muslim di Kota Samarinda. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5472"},
{id:"u74",judul:"PENGARUH PELATIHAN DAN PENGEMBANGAN SUMBER DAYA MANUSIA TERHADAP KINERJA KARYAWAN PADA BANK SYARIAH INDONESIA KCP SAMARINDA SEBERANG",penulis:"Pertiwi, Indah",prodi:"Ekonomi Syariah",tahun:"2023",abstrak:"Indah Pertiwi, 2023. Pengaruh Pelatihan dan Pengembangan Sumber Daya Manusia Terhadap Kinerja Karyawan pada Bank Syariah Indonesia KCP Samarinda Seberang. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5464"},
{id:"u75",judul:"ANALISIS FAKTOR-FAKTOR YANG MEMPENGARUHI MINAT BERWIRAUSAHA MAHASISWA FEBI UINSI SAMARINDA",penulis:"Firmansyah, Rizal",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Rizal Firmansyah, 2022. Analisis Faktor-Faktor yang Mempengaruhi Minat Berwirausaha Mahasiswa FEBI UINSI Samarinda. Skripsi, Jurusan Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5449"},
{id:"u76",judul:"IMPLEMENTASI ETIKA BISNIS ISLAM PADA PEDAGANG PASAR TRADISIONAL DI KOTA SAMARINDA",penulis:"Khoiriyah, Lailatul",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Lailatul Khoiriyah, 2022. Implementasi Etika Bisnis Islam pada Pedagang Pasar Tradisional di Kota Samarinda. Skripsi, Jurusan Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5430"},
{id:"u77",judul:"PENGARUH PERTUMBUHAN EKONOMI DAN INVESTASI ASING LANGSUNG TERHADAP PENGANGGURAN DI PROVINSI KALIMANTAN TIMUR",penulis:"Mardiani, Reni",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Reni Mardiani, 2022. Pengaruh Pertumbuhan Ekonomi dan Investasi Asing Langsung Terhadap Pengangguran di Provinsi Kalimantan Timur. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5474"},
{id:"u78",judul:"ANALISIS KINERJA KEUANGAN DAERAH DALAM MENDUKUNG PEMBANGUNAN EKONOMI DI KOTA SAMARINDA",penulis:"Yunita, Ria",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Ria Yunita, 2022. Analisis Kinerja Keuangan Daerah dalam Mendukung Pembangunan Ekonomi di Kota Samarinda. Skripsi, Jurusan Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5472"},
{id:"u79",judul:"PENGARUH KOMPETENSI PEGAWAI DAN BUDAYA ORGANISASI TERHADAP KUALITAS PELAYANAN PUBLIK PADA DINAS KEPENDUDUKAN DAN CATATAN SIPIL KOTA SAMARINDA",penulis:"Nuraini, Siti",prodi:"Ekonomi Syariah",tahun:"2023",abstrak:"Siti Nuraini, 2023. Pengaruh Kompetensi Pegawai dan Budaya Organisasi Terhadap Kualitas Pelayanan Publik pada Dinas Kependudukan dan Catatan Sipil Kota Samarinda. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5464"},
{id:"u80",judul:"ANALISIS POTENSI DAN PERKEMBANGAN WAKAF PRODUKTIF DI KOTA SAMARINDA PERSPEKTIF HUKUM EKONOMI SYARIAH",penulis:"Rasyid, Abdul",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Abdul Rasyid, 2022. Analisis Potensi dan Perkembangan Wakaf Produktif di Kota Samarinda Perspektif Hukum Ekonomi Syariah. Skripsi, Jurusan Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5449"},
{id:"u81",judul:"PENGARUH LITERASI KEUANGAN DAN INKLUSI KEUANGAN TERHADAP KESEJAHTERAAN MASYARAKAT DI KOTA BALIKPAPAN",penulis:"Salsabila, Ayu",prodi:"Ekonomi Syariah",tahun:"2023",abstrak:"Ayu Salsabila, 2023. Pengaruh Literasi Keuangan dan Inklusi Keuangan Terhadap Kesejahteraan Masyarakat di Kota Balikpapan. Skripsi, Jurusan Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5430"},
{id:"u82",judul:"PERAN PEREMPUAN DALAM PEMBERDAYAAN EKONOMI KELUARGA MELALUI USAHA MIKRO DI KOTA SAMARINDA PERSPEKTIF EKONOMI SYARIAH",penulis:"Amira, Nurul",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Nurul Amira, 2022. Peran Perempuan dalam Pemberdayaan Ekonomi Keluarga Melalui Usaha Mikro di Kota Samarinda Perspektif Ekonomi Syariah. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5474"},
{id:"u83",judul:"PENGARUH TINGKAT PENDIDIKAN, PENGALAMAN KERJA, DAN UPAH MINIMUM TERHADAP PRODUKTIVITAS TENAGA KERJA DI KALIMANTAN TIMUR",penulis:"Hidayanti, Reza",prodi:"Ekonomi Syariah",tahun:"2023",abstrak:"Reza Hidayanti, 2023. Pengaruh Tingkat Pendidikan, Pengalaman Kerja, dan Upah Minimum Terhadap Produktivitas Tenaga Kerja di Kalimantan Timur. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5472"},
{id:"u84",judul:"DAMPAK PANDEMI COVID-19 TERHADAP PEREKONOMIAN USAHA KECIL MENENGAH DAN STRATEGI PEMULIHAN (Studi Kasus UMKM di Kota Samarinda)",penulis:"Suryani, Eka",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Eka Suryani, 2022. Dampak Pandemi Covid-19 Terhadap Perekonomian Usaha Kecil Menengah dan Strategi Pemulihan (Studi Kasus UMKM di Kota Samarinda). Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5464"},
{id:"u85",judul:"PENGARUH INVESTASI, PENGELUARAN PEMERINTAH, DAN EKSPOR TERHADAP PERTUMBUHAN EKONOMI DI PROVINSI KALIMANTAN TIMUR",penulis:"Mustofa, Khoirul",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Khoirul Mustofa, 2022. Pengaruh Investasi, Pengeluaran Pemerintah, dan Ekspor Terhadap Pertumbuhan Ekonomi di Provinsi Kalimantan Timur. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5449"},
{id:"u86",judul:"ANALISIS POTENSI ZAKAT PROFESI DALAM MENGURANGI KEMISKINAN DI KOTA SAMARINDA",penulis:"Azzahra, Husnul",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Husnul Azzahra, 2022. Analisis Potensi Zakat Profesi dalam Mengurangi Kemiskinan di Kota Samarinda. Skripsi, Jurusan Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5430"},
{id:"u87",judul:"PENGARUH BELANJA PENDIDIKAN DAN KESEHATAN TERHADAP INDEKS PEMBANGUNAN MANUSIA DI KABUPATEN/KOTA PROVINSI KALIMANTAN TIMUR",penulis:"Kurniawati, Evi",prodi:"Ekonomi Syariah",tahun:"2023",abstrak:"Evi Kurniawati, 2023. Pengaruh Belanja Pendidikan dan Kesehatan Terhadap Indeks Pembangunan Manusia di Kabupaten/Kota Provinsi Kalimantan Timur. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5474"},
{id:"u88",judul:"IMPLEMENTASI PROGRAM CORPORATE SOCIAL RESPONSIBILITY (CSR) PT. TOTAL E&P INDONESIE TERHADAP PEMBERDAYAAN MASYARAKAT DI KABUPATEN KUTAI KARTANEGARA",penulis:"Safitri, Rizky Amalia",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Rizky Amalia Safitri, 2022. Implementasi Program Corporate Social Responsibility (CSR) PT. Total E&P Indonesie Terhadap Pemberdayaan Masyarakat. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5472"},
{id:"u89",judul:"PENGARUH PENDAPATAN DAERAH, BELANJA DAERAH, DAN KEMANDIRIAN KEUANGAN DAERAH TERHADAP PERTUMBUHAN EKONOMI DI KABUPATEN/KOTA PROVINSI KALIMANTAN TIMUR",penulis:"Wahyuni, Tri",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Tri Wahyuni, 2022. Pengaruh Pendapatan Daerah, Belanja Daerah, dan Kemandirian Keuangan Daerah Terhadap Pertumbuhan Ekonomi di Kabupaten/Kota Provinsi Kalimantan Timur. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5464"},
{id:"u90",judul:"ANALISIS PENGARUH RASIO KEUANGAN TERHADAP PERUBAHAN LABA PADA PERUSAHAAN MANUFAKTUR YANG TERDAFTAR DI BURSA EFEK INDONESIA",penulis:"Islamiyah, Fitri Nur",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Fitri Nur Islamiyah, 2022. Analisis Pengaruh Rasio Keuangan Terhadap Perubahan Laba pada Perusahaan Manufaktur yang Terdaftar di Bursa Efek Indonesia. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5449"},
{id:"u91",judul:"PENGARUH KINERJA KEUANGAN DAN CORPORATE SOCIAL RESPONSIBILITY TERHADAP NILAI PERUSAHAAN YANG TERDAFTAR DI JAKARTA ISLAMIC INDEX",penulis:"Ramadhan, Galang",prodi:"Ekonomi Syariah",tahun:"2023",abstrak:"Galang Ramadhan, 2023. Pengaruh Kinerja Keuangan dan Corporate Social Responsibility Terhadap Nilai Perusahaan yang Terdaftar di Jakarta Islamic Index. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5430"},
{id:"u92",judul:"ANALISIS PENGARUH ELECTRONIC WORD OF MOUTH (E-WOM) DAN BRAND IMAGE TERHADAP KEPUTUSAN PEMBELIAN PRODUK KOSMETIK HALAL",penulis:"Mustika, Sari",prodi:"Ekonomi Syariah",tahun:"2023",abstrak:"Sari Mustika, 2023. Analisis Pengaruh Electronic Word of Mouth (E-WOM) dan Brand Image Terhadap Keputusan Pembelian Produk Kosmetik Halal. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5474"},
{id:"u93",judul:"PENGARUH KEPUASAN KERJA DAN MOTIVASI TERHADAP KOMITMEN ORGANISASI KARYAWAN BANK SYARIAH DI SAMARINDA",penulis:"Nugraha, Wahyu",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Wahyu Nugraha, 2022. Pengaruh Kepuasan Kerja dan Motivasi Terhadap Komitmen Organisasi Karyawan Bank Syariah di Samarinda. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5472"},
{id:"u94",judul:"PENGARUH BEBAN KERJA, STRES KERJA, DAN MOTIVASI TERHADAP KINERJA KARYAWAN PADA PT. BNI SYARIAH CABANG SAMARINDA",penulis:"Musdalifah",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Musdalifah, 2022. Pengaruh Beban Kerja, Stres Kerja, dan Motivasi Terhadap Kinerja Karyawan pada PT. BNI Syariah Cabang Samarinda. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5464"},
{id:"u95",judul:"EFEKTIVITAS PROGRAM KELUARGA HARAPAN (PKH) DALAM PENGENTASAN KEMISKINAN DITINJAU DARI PERSPEKTIF EKONOMI ISLAM DI DESA BATUAH KECAMATAN LOA JANAN KUTAI KARTANEGARA",penulis:"Handoko, Bayu",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Bayu Handoko, 2022. Efektivitas Program Keluarga Harapan (PKH) Dan Bantuan Pangan Non Tunai (BPNT) Dalam Pengentasan Kemiskinan Ditinjau dari Perspektif Ekonomi Islam. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5449"},
{id:"u96",judul:"KONTRIBUSI INSTRUMEN ZAKAT DALAM MENDUKUNG PEMBANGUNAN BERKELANJUTAN DI KOTA BALIKPAPAN",penulis:"Syamsi, Badrus",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Badrus Syamsi, 2022. Kontribusi Instrumen Zakat dalam Mendukung Pembangunan Berkelanjutan di Kota Balikpapan. Skripsi, Jurusan Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5430"},
{id:"u97",judul:"PENGARUH PENDIDIKAN KEWIRAUSAHAAN, LINGKUNGAN KELUARGA, DAN MOTIVASI TERHADAP MINAT BERWIRAUSAHA MAHASISWA",penulis:"Nuraeni, Siti",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Siti Nuraeni, 2022. Pengaruh Pendidikan Kewirausahaan, Lingkungan Keluarga, dan Motivasi Terhadap Minat Berwirausaha Mahasiswa. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5474"},
{id:"u98",judul:"ANALISIS PENGEMBANGAN EKONOMI LOKAL MELALUI BADAN USAHA MILIK DESA (BUMDes) DI KABUPATEN KUTAI BARAT",penulis:"Permana, Adi",prodi:"Ekonomi Syariah",tahun:"2023",abstrak:"Adi Permana, 2023. Analisis Pengembangan Ekonomi Lokal Melalui Badan Usaha Milik Desa (BUMDes) di Kabupaten Kutai Barat. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5472"},
{id:"u99",judul:"PENGARUH RELIGIUSITAS DAN PENGETAHUAN PRODUK SYARIAH TERHADAP KEPUTUSAN MENGGUNAKAN ASURANSI SYARIAH DI KOTA SAMARINDA",penulis:"Sholehah, Nidaul",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Nidaul Sholehah, 2022. Pengaruh Religiusitas dan Pengetahuan Produk Syariah Terhadap Keputusan Menggunakan Asuransi Syariah di Kota Samarinda. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5464"},
{id:"u100",judul:"PENGARUH LITERASI KEUANGAN SYARIAH TERHADAP PENGAMBILAN KEPUTUSAN INVESTASI PADA MAHASISWA FEBI UINSI SAMARINDA",penulis:"Munawaroh, Dewi",prodi:"Ekonomi Syariah",tahun:"2023",abstrak:"Dewi Munawaroh, 2023. Pengaruh Literasi Keuangan Syariah Terhadap Pengambilan Keputusan Investasi pada Mahasiswa FEBI UINSI Samarinda. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5449"},
// ======= TAMBAHAN PS 101-200 =======
{id:"u101",judul:"ANALISIS PENERAPAN AKAD WADIAH YAD DHAMANAH PADA PRODUK TABUNGAN DI BANK SYARIAH INDONESIA CABANG SAMARINDA",penulis:"Pratiwi, Nurul Aini",prodi:"Perbankan Syariah",tahun:"2023",abstrak:"Nurul Aini Pratiwi, 2023. Analisis Penerapan Akad Wadiah Yad Dhamanah pada Produk Tabungan di Bank Syariah Indonesia Cabang Samarinda. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5484"},
{id:"u102",judul:"PENGARUH LAYANAN MOBILE BANKING TERHADAP KEPUASAN DAN LOYALITAS NASABAH BANK SYARIAH INDONESIA DI SAMARINDA",penulis:"Fadillah, Rizky",prodi:"Perbankan Syariah",tahun:"2023",abstrak:"Rizky Fadillah, 2023. Pengaruh Layanan Mobile Banking Terhadap Kepuasan dan Loyalitas Nasabah Bank Syariah Indonesia di Samarinda. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5481"},
{id:"u103",judul:"ANALISIS PEMBIAYAAN MUSYARAKAH DALAM PENGEMBANGAN USAHA MIKRO DAN KECIL DI BAITUL MAL WAT TAMWIL (BMT) KOTA SAMARINDA",penulis:"Habibi, Muhammad",prodi:"Perbankan Syariah",tahun:"2022",abstrak:"Muhammad Habibi, 2022. Analisis Pembiayaan Musyarakah dalam Pengembangan Usaha Mikro dan Kecil di BMT Kota Samarinda. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5475"},
{id:"u104",judul:"PENGARUH DANA PIHAK KETIGA, BIAYA OPERASIONAL, DAN INFLASI TERHADAP PEMBIAYAAN MURABAHAH PADA BANK UMUM SYARIAH DI INDONESIA",penulis:"Hapsari, Devi",prodi:"Perbankan Syariah",tahun:"2023",abstrak:"Devi Hapsari, 2023. Pengaruh Dana Pihak Ketiga, Biaya Operasional, dan Inflasi Terhadap Pembiayaan Murabahah pada Bank Umum Syariah di Indonesia. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5456"},
{id:"u105",judul:"PENGARUH KUALITAS AUDIT, LEVERAGE, DAN PROFITABILITAS TERHADAP MANAJEMEN LABA PADA PERUSAHAAN SYARIAH YANG TERDAFTAR DI BURSA EFEK INDONESIA",penulis:"Setiawan, Bagas",prodi:"Perbankan Syariah",tahun:"2022",abstrak:"Bagas Setiawan, 2022. Pengaruh Kualitas Audit, Leverage, dan Profitabilitas Terhadap Manajemen Laba pada Perusahaan Syariah yang Terdaftar di BEI. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5448"},
{id:"u106",judul:"PENGARUH ELECTRONIC BANKING TERHADAP KUALITAS LAYANAN DAN KEPUASAN NASABAH PADA BANK SYARIAH DI KOTA SAMARINDA",penulis:"Marlina, Yuli",prodi:"Perbankan Syariah",tahun:"2022",abstrak:"Yuli Marlina, 2022. Pengaruh Electronic Banking Terhadap Kualitas Layanan dan Kepuasan Nasabah pada Bank Syariah di Kota Samarinda. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5431"},
{id:"u107",judul:"PENGARUH PEMBIAYAAN MURABAHAH DAN MUDHARABAH TERHADAP PROFITABILITAS BANK UMUM SYARIAH DI INDONESIA TAHUN 2018-2022",penulis:"Aditya, Fajar",prodi:"Perbankan Syariah",tahun:"2023",abstrak:"Fajar Aditya, 2023. Pengaruh Pembiayaan Murabahah dan Mudharabah Terhadap Profitabilitas Bank Umum Syariah di Indonesia Tahun 2018-2022. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5387"},
{id:"u108",judul:"ANALISIS RISIKO PEMBIAYAAN MUDHARABAH DAN MUSYARAKAH PADA BANK UMUM SYARIAH DI INDONESIA",penulis:"Supriyadi, Eko",prodi:"Perbankan Syariah",tahun:"2022",abstrak:"Eko Supriyadi, 2022. Analisis Risiko Pembiayaan Mudharabah dan Musyarakah pada Bank Umum Syariah di Indonesia. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5381"},
{id:"u109",judul:"PENGARUH SUKU BUNGA, INFLASI, DAN KURS TERHADAP INDEKS SAHAM SYARIAH INDONESIA (ISSI) PERIODE 2018-2022",penulis:"Rahayu, Reni",prodi:"Perbankan Syariah",tahun:"2023",abstrak:"Reni Rahayu, 2023. Pengaruh Suku Bunga, Inflasi, dan Kurs Terhadap Indeks Saham Syariah Indonesia (ISSI) Periode 2018-2022. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5380"},
{id:"u110",judul:"PENGARUH ZAKAT, INFAK DAN SEDEKAH TERHADAP DANA SOSIAL DAN PROFITABILITAS BANK UMUM SYARIAH DI INDONESIA",penulis:"Farida, Nur",prodi:"Perbankan Syariah",tahun:"2023",abstrak:"Nur Farida, 2023. Pengaruh Zakat, Infak dan Sedekah Terhadap Dana Sosial dan Profitabilitas Bank Umum Syariah di Indonesia. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5376"},
// ======= TAMBAHAN ES 201-300 =======
{id:"u111",judul:"IMPLEMENTASI CORPORATE SOCIAL RESPONSIBILITY (CSR) DI PT. PERTAMINA HULU MAHAKAM DALAM PERSPEKTIF SHARIA ENTERPRISE THEORY",penulis:"Lukman, Mohammad",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Mohammad Lukman, 2022. Implementasi Program Corporate Social Responsibility (CSR) di PT. Pertamina Hulu Mahakam Dalam Perspektif Sharia Enterprise Theory. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5472"},
{id:"u112",judul:"EFEKTIVITAS PENGELOLAAN DANA ZAKAT PRODUKTIF MELALUI ZAKAT COMMUNITY DEVELOPMENT (ZCD) TERHADAP EKONOMI MUSTAHIK PADA BAZNAS PROVINSI KALIMANTAN TIMUR",penulis:"Dalhudah, Iklimah",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Iklimah Dalhudah, 2022. Efektivitas Pengelolaan Dana Zakat Produktif Melalui Zakat Community Development (ZCD) Terhadap Ekonomi Mustahik Pada BAZNAS Provinsi Kalimantan Timur. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5464"},
{id:"u113",judul:"PENGARUH PEMBIAYAAN MODAL KERJA, INVESTASI, KONSUMSI, DAN SUKU BUNGA TERHADAP NON PERFORMING FINANCING PADA BANK UMUM SYARIAH DAN UNIT USAHA SYARIAH DI INDONESIA PERIODE 2017-2021",penulis:"Fadillah, Ummi Maghfiran",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Ummi Maghfiran Fadillah, 2022. Pengaruh Pembiayaan Modal Kerja, Investasi, Konsumsi, dan Suku bunga Terhadap Non Performing Financing. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5449"},
{id:"u114",judul:"IMPLEMENTASI MANAJEMEN SYARIAH DAN STRATEGI BISNIS DENGAN SYIRKAH MUDHARABAH DALAM MELAKUKAN EKSPANSI BISNIS PADA ISTANA LAUNDRY DI SAMARINDA",penulis:"Amin Mubarak, Muhammad Sirajul",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Muhammad Sirajul Amin Mubarak, 2022. Implementasi Manajemen Syariah dan Strategi Bisnis dengan Syirkah Mudharabah dalam Melakukan Ekspansi Bisnis pada Istana Laundry di Samarinda. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5430"},
{id:"u115",judul:"PENGARUH KESADARAN HALAL, HARGA DAN CELEBRITY ENDORSER TERHADAP PEMBELIAN PRODUK KOSMETIK BERSERTIFIKAT HALAL (Studi Kasus Kecamatan Marangkayu)",penulis:"Aulia, Nadhifah",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Nadhifah Aulia, 2022. Pengaruh Kesadaran Halal, Harga Dan Celebrity Endorser Terhadap Pembelian Produk Kosmetik Bersertifikat Halal. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5474"},
{id:"u116",judul:"ANALISIS STUDI KELAYAKAN BISNIS DALAM TINJAUAN ISLAM PADA PERUSAHAAN INDUSTRI ROTI DI KUTAI TIMUR (Studi Kasus Pada Oval Bakery Sangatta)",penulis:"Rifandi, Ahmad",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Ahmad Rifandi, 2022. Analisis Studi Kelayakan Bisnis dalam Tinjauan Islam pada Perusahaan Industri Roti Di Kutai Timur (Studi Kasus Pada Oval Bakery Sangatta). Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5472"},
{id:"u117",judul:"IMPLEMENTASI GOOD CORPORATE GOVERNANCE PADA PENGELOLAAN ZAKAT DI BAZNAS DAN LAZ DPU KUTAI TIMUR",penulis:"Firdaus",prodi:"Ekonomi Syariah",tahun:"2021",abstrak:"Firdaus, 2021. Implementasi Good Corporate Governance Pada Pengelolaan Zakat di BAZNAS dan LAZ DPU Kutai Timur. Skripsi, Jurusan Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5464"},
{id:"u118",judul:"STRATEGI BAITUT TAMWIL HIDAYATULLAH (BTH) UMAT MANDIRI DALAM PEMBERDAYAAN USAHA MIKRO KECIL (UMK) DI BALIKPAPAN",penulis:"Masykur, Marhamah",prodi:"Ekonomi Syariah",tahun:"2023",abstrak:"Marhamah Masykur, 2023. Strategi Baitut Tamwil Hidayatullah (BTH) Umat Mandiri dalam Pemberdayaan Usaha Mikro Kecil (UMK) di Balikpapan. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5449"},
{id:"u119",judul:"PENGARUH LABEL HALAL DAN MEREK TERHADAP MINAT BELI KOSMETIK WARDAH (Studi Kasus Mahasiswa dan Mahasiswi UINSI Samarinda)",penulis:"Qarimah, Ulya",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Ulya Qarimah, 2022. Pengaruh Label Halal Dan Merek terhadap Minat Beli Kosmetik Wardah. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5430"},
{id:"u120",judul:"KONSEP EKONOMI ISLAM PADA UNDANG-UNDANG BERAJA NITI KERAJAAN KUTAI KARTANEGARA ING MARTAPURA",penulis:"Faizin, Moch Khoirul",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Moch Khoirul Faizin, 2022. Konsep Ekonomi Islam Pada Undang-Undang Beraja Niti Kerajaan Kutai Kartanegara Ing Martapura. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5472"},
{id:"u121",judul:"PENGARUH PENGETAHUAN KEUANGAN, SIKAP KEUANGAN, DAN KONTROL DIRI TERHADAP PENGELOLAAN KEUANGAN PRIBADI MAHASISWA FEBI UINSI SAMARINDA",penulis:"Khairiyah, Nur",prodi:"Ekonomi Syariah",tahun:"2023",abstrak:"Nur Khairiyah, 2023. Pengaruh Pengetahuan Keuangan, Sikap Keuangan, dan Kontrol Diri Terhadap Pengelolaan Keuangan Pribadi Mahasiswa FEBI UINSI Samarinda. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5430"},
{id:"u122",judul:"STRATEGI PENGEMBANGAN USAHA KECIL MENENGAH BERBASIS SYARIAH DI KOTA SAMARINDA",penulis:"Alfarizi, Muhammad",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Muhammad Alfarizi, 2022. Strategi Pengembangan Usaha Kecil Menengah Berbasis Syariah di Kota Samarinda. Skripsi, Jurusan Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5474"},
{id:"u123",judul:"ANALISIS POTENSI EKONOMI KREATIF BERBASIS KEARIFAN LOKAL DI KOTA SAMARINDA",penulis:"Fadlurrahman, Arif",prodi:"Ekonomi Syariah",tahun:"2023",abstrak:"Arif Fadlurrahman, 2023. Analisis Potensi Ekonomi Kreatif Berbasis Kearifan Lokal di Kota Samarinda. Skripsi, Jurusan Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5472"},
{id:"u124",judul:"PENGARUH PENDIDIKAN EKONOMI, LINGKUNGAN SOSIAL, DAN LITERASI KEUANGAN TERHADAP PERILAKU KONSUMSI ISLAMI MAHASISWA",penulis:"Ningrum, Dwi Ratna",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Dwi Ratna Ningrum, 2022. Pengaruh Pendidikan Ekonomi, Lingkungan Sosial, dan Literasi Keuangan Terhadap Perilaku Konsumsi Islami Mahasiswa. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5464"},
{id:"u125",judul:"PENGARUH TABUNGAN HAJI, PEMBIAYAAN UMRAH, DAN LAYANAN HAJI TERHADAP KEPUASAN NASABAH BSI DI SAMARINDA",penulis:"Kurnia, Desi",prodi:"Ekonomi Syariah",tahun:"2023",abstrak:"Desi Kurnia, 2023. Pengaruh Tabungan Haji, Pembiayaan Umrah, dan Layanan Haji Terhadap Kepuasan Nasabah BSI di Samarinda. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5449"},
{id:"u126",judul:"PENGARUH TEKNOLOGI INFORMASI, KUALITAS SUMBER DAYA MANUSIA DAN PENGENDALIAN INTERNAL TERHADAP KUALITAS LAPORAN KEUANGAN SYARIAH",penulis:"Hidayat, Ahmad",prodi:"Ekonomi Syariah",tahun:"2023",abstrak:"Ahmad Hidayat, 2023. Pengaruh Teknologi Informasi, Kualitas Sumber Daya Manusia dan Pengendalian Internal Terhadap Kualitas Laporan Keuangan Syariah. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5430"},
{id:"u127",judul:"ANALISIS KEPUASAN MUZAKKI TERHADAP KUALITAS PELAYANAN BADAN AMIL ZAKAT NASIONAL (BAZNAS) KOTA SAMARINDA",penulis:"Safira, Anisa",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Anisa Safira, 2022. Analisis Kepuasan Muzakki Terhadap Kualitas Pelayanan Badan Amil Zakat Nasional (BAZNAS) Kota Samarinda. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5474"},
{id:"u128",judul:"ANALISIS PENERAPAN PRINSIP-PRINSIP EKONOMI SYARIAH DALAM PENGELOLAAN PASAR TRADISIONAL DI KOTA SAMARINDA",penulis:"Muttaqin, Khairul",prodi:"Ekonomi Syariah",tahun:"2023",abstrak:"Khairul Muttaqin, 2023. Analisis Penerapan Prinsip-Prinsip Ekonomi Syariah dalam Pengelolaan Pasar Tradisional di Kota Samarinda. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5472"},
{id:"u129",judul:"PENGARUH KESADARAN MEREK, PERSEPSI KUALITAS, DAN LOYALITAS MEREK TERHADAP KEPUTUSAN PEMBELIAN PRODUK HALAL DI KOTA SAMARINDA",penulis:"Rahmi, Aulia",prodi:"Ekonomi Syariah",tahun:"2023",abstrak:"Aulia Rahmi, 2023. Pengaruh Kesadaran Merek, Persepsi Kualitas, dan Loyalitas Merek Terhadap Keputusan Pembelian Produk Halal di Kota Samarinda. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5464"},
{id:"u130",judul:"PENGARUH UKURAN PERUSAHAAN, PROFITABILITAS, DAN LEVERAGE TERHADAP NILAI PERUSAHAAN YANG TERDAFTAR DI JAKARTA ISLAMIC INDEX",penulis:"Wahyudi, Teguh",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Teguh Wahyudi, 2022. Pengaruh Ukuran Perusahaan, Profitabilitas, dan Leverage Terhadap Nilai Perusahaan yang Terdaftar di Jakarta Islamic Index. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5449"},
// ======= TAMBAHAN PS 201-280 =======
{id:"u131",judul:"PENGARUH KECUKUPAN MODAL, KREDIT BERMASALAH, DAN LIKUIDITAS TERHADAP PROFITABILITAS BANK SYARIAH DI INDONESIA PERIODE 2019-2022",penulis:"Sulistyawati, Rina",prodi:"Perbankan Syariah",tahun:"2023",abstrak:"Rina Sulistyawati, 2023. Pengaruh Kecukupan Modal, Kredit Bermasalah, dan Likuiditas Terhadap Profitabilitas Bank Syariah di Indonesia Periode 2019-2022. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5484"},
{id:"u132",judul:"ANALISIS DETERMINAN PEMBIAYAAN KONSUMTIF PADA BANK UMUM SYARIAH DI INDONESIA PERIODE 2018-2022",penulis:"Hanafi, Muhammad",prodi:"Perbankan Syariah",tahun:"2023",abstrak:"Muhammad Hanafi, 2023. Analisis Determinan Pembiayaan Konsumtif pada Bank Umum Syariah di Indonesia Periode 2018-2022. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5481"},
{id:"u133",judul:"PENGARUH UKURAN BANK, INFLASI, DAN PERTUMBUHAN EKONOMI TERHADAP NON-PERFORMING FINANCING BANK UMUM SYARIAH",penulis:"Nuraini, Resti",prodi:"Perbankan Syariah",tahun:"2022",abstrak:"Resti Nuraini, 2022. Pengaruh Ukuran Bank, Inflasi, dan Pertumbuhan Ekonomi Terhadap Non-Performing Financing Bank Umum Syariah. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5475"},
{id:"u134",judul:"ANALISIS KUALITAS PELAYANAN PADA NASABAH PENGGUNA KTA SYARIAH DI BANK SYARIAH INDONESIA KCP SAMARINDA",penulis:"Rahmah, Laila",prodi:"Perbankan Syariah",tahun:"2023",abstrak:"Laila Rahmah, 2023. Analisis Kualitas Pelayanan pada Nasabah Pengguna KTA Syariah di Bank Syariah Indonesia KCP Samarinda. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5456"},
{id:"u135",judul:"PENGARUH BEBAN OPERASIONAL, PENDAPATAN OPERASIONAL, DAN EFISIENSI TERHADAP ROA BANK SYARIAH DI INDONESIA",penulis:"Utami, Sri Wahyu",prodi:"Perbankan Syariah",tahun:"2023",abstrak:"Sri Wahyu Utami, 2023. Pengaruh Beban Operasional, Pendapatan Operasional, dan Efisiensi Terhadap ROA Bank Syariah di Indonesia. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5448"},
{id:"u136",judul:"IMPLEMENTASI AKAD IJARAH MUNTAHIYA BITTAMLIK (IMBT) PADA PEMBIAYAAN PROPERTI SYARIAH DI BANK SYARIAH INDONESIA",penulis:"Auliya, Rima",prodi:"Perbankan Syariah",tahun:"2022",abstrak:"Rima Auliya, 2022. Implementasi Akad Ijarah Muntahiya Bittamlik (IMBT) pada Pembiayaan Properti Syariah di Bank Syariah Indonesia. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5431"},
{id:"u137",judul:"PENGARUH PEMBIAYAAN MURABAHAH, MUDHARABAH, DAN MUSYARAKAH TERHADAP RETURN ON EQUITY (ROE) BANK UMUM SYARIAH",penulis:"Kurniasih, Dewi",prodi:"Perbankan Syariah",tahun:"2023",abstrak:"Dewi Kurniasih, 2023. Pengaruh Pembiayaan Murabahah, Mudharabah, dan Musyarakah Terhadap Return On Equity (ROE) Bank Umum Syariah. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5387"},
{id:"u138",judul:"ANALISIS STRATEGI PENGELOLAAN RISIKO PADA PEMBIAYAAN MUDHARABAH DI BANK MUAMALAT INDONESIA CABANG SAMARINDA",penulis:"Putra, Faisal Adhi",prodi:"Perbankan Syariah",tahun:"2022",abstrak:"Faisal Adhi Putra, 2022. Analisis Strategi Pengelolaan Risiko pada Pembiayaan Mudharabah di Bank Muamalat Indonesia Cabang Samarinda. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5381"},
{id:"u139",judul:"PENGARUH KINERJA KEUANGAN TERHADAP KEPUTUSAN INVESTASI SAHAM SYARIAH PADA PERUSAHAAN YANG TERDAFTAR DI INDEKS SAHAM SYARIAH INDONESIA (ISSI)",penulis:"Lestari, Amalia Tri",prodi:"Perbankan Syariah",tahun:"2023",abstrak:"Amalia Tri Lestari, 2023. Pengaruh Kinerja Keuangan Terhadap Keputusan Investasi Saham Syariah pada Perusahaan yang Terdaftar di ISSI. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5380"},
{id:"u140",judul:"PENGARUH NILAI TUKAR, INFLASI, DAN SUKU BUNGA TERHADAP HARGA SAHAM EMITEN SYARIAH DI BURSA EFEK INDONESIA",penulis:"Wicaksono, Bagas",prodi:"Perbankan Syariah",tahun:"2023",abstrak:"Bagas Wicaksono, 2023. Pengaruh Nilai Tukar, Inflasi, dan Suku Bunga Terhadap Harga Saham Emiten Syariah di Bursa Efek Indonesia. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5376"},
// ======= TAMBAHAN ES 301-400 =======
{id:"u141",judul:"ANALISIS PERAN BANK WAKAF MIKRO DALAM PEMBERDAYAAN EKONOMI MASYARAKAT PESANTREN DI KALIMANTAN TIMUR",penulis:"Ramdani, Wildan",prodi:"Ekonomi Syariah",tahun:"2023",abstrak:"Wildan Ramdani, 2023. Analisis Peran Bank Wakaf Mikro dalam Pemberdayaan Ekonomi Masyarakat Pesantren di Kalimantan Timur. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5430"},
{id:"u142",judul:"PENGARUH KEPEMIMPINAN ISLAMI DAN BUDAYA ORGANISASI TERHADAP KINERJA KARYAWAN PERUSAHAAN SYARIAH DI SAMARINDA",penulis:"Sutrisno, Ari",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Ari Sutrisno, 2022. Pengaruh Kepemimpinan Islami dan Budaya Organisasi Terhadap Kinerja Karyawan Perusahaan Syariah di Samarinda. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5474"},
{id:"u143",judul:"DAMPAK PERDAGANGAN BEBAS ASEAN TERHADAP INDUSTRI HALAL INDONESIA (Studi Kasus Produk Makanan dan Minuman)",penulis:"Haq, Nur",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Nur Haq, 2022. Dampak Perdagangan Bebas ASEAN Terhadap Industri Halal Indonesia (Studi Kasus Produk Makanan dan Minuman). Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5472"},
{id:"u144",judul:"ANALISIS PENGARUH HARGA MINYAK DUNIA DAN PERTUMBUHAN EKONOMI TERHADAP INFLASI DI INDONESIA",penulis:"Susilo, Bagus",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Bagus Susilo, 2022. Analisis Pengaruh Harga Minyak Dunia dan Pertumbuhan Ekonomi Terhadap Inflasi di Indonesia. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5464"},
{id:"u145",judul:"PENGARUH KESEJAHTERAAN KARYAWAN DAN BUDAYA PERUSAHAAN TERHADAP PRODUKTIVITAS KERJA PADA PERBANKAN SYARIAH DI SAMARINDA",penulis:"Irwansyah, Dedi",prodi:"Ekonomi Syariah",tahun:"2023",abstrak:"Dedi Irwansyah, 2023. Pengaruh Kesejahteraan Karyawan dan Budaya Perusahaan Terhadap Produktivitas Kerja pada Perbankan Syariah di Samarinda. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5449"},
{id:"u146",judul:"PERAN KOPERASI SYARIAH DALAM PENINGKATAN KESEJAHTERAAN ANGGOTA DI KOTA SAMARINDA",penulis:"Maulana, Rizky",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Rizky Maulana, 2022. Peran Koperasi Syariah dalam Peningkatan Kesejahteraan Anggota di Kota Samarinda. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5430"},
{id:"u147",judul:"ANALISIS FAKTOR-FAKTOR YANG MEMPENGARUHI KEPUTUSAN INVESTASI REKSA DANA SYARIAH PADA MAHASISWA FEBI UINSI SAMARINDA",penulis:"Pratama, Bagas Andhi",prodi:"Ekonomi Syariah",tahun:"2023",abstrak:"Bagas Andhi Pratama, 2023. Analisis Faktor-Faktor yang Mempengaruhi Keputusan Investasi Reksa Dana Syariah pada Mahasiswa FEBI UINSI Samarinda. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5474"},
{id:"u148",judul:"PENGARUH PERTUMBUHAN PENJUALAN, UKURAN PERUSAHAAN, DAN PROFITABILITAS TERHADAP STRUKTUR MODAL PERUSAHAAN SYARIAH",penulis:"Ramadhani, Putri Indah",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Putri Indah Ramadhani, 2022. Pengaruh Pertumbuhan Penjualan, Ukuran Perusahaan, dan Profitabilitas Terhadap Struktur Modal Perusahaan Syariah. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5472"},
{id:"u149",judul:"PENGARUH KUALITAS AKAD, KUALITAS LAYANAN, DAN KEPERCAYAAN TERHADAP MINAT MENGGUNAKAN PRODUK GADAI SYARIAH",penulis:"Halimah, Nur",prodi:"Ekonomi Syariah",tahun:"2022",abstrak:"Nur Halimah, 2022. Pengaruh Kualitas Akad, Kualitas Layanan, dan Kepercayaan Terhadap Minat Menggunakan Produk Gadai Syariah. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5464"},
{id:"u150",judul:"ANALISIS PENGARUH MANAJEMEN LABA DAN PENGUNGKAPAN CORPORATE SOCIAL RESPONSIBILITY TERHADAP NILAI PERUSAHAAN SYARIAH",penulis:"Faridah, Siti",prodi:"Ekonomi Syariah",tahun:"2023",abstrak:"Siti Faridah, 2023. Analisis Pengaruh Manajemen Laba dan Pengungkapan Corporate Social Responsibility Terhadap Nilai Perusahaan Syariah. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5449"},
// ======= TAMBAHAN SKRIPSI 2024 =======
{id:"u151",judul:"ANALISIS DAMPAK KEUANGAN DIGITAL DAN INKLUSI KEUANGAN TERHADAP PERTUMBUHAN UMKM SYARIAH DI KALIMANTAN TIMUR",penulis:"Andika, Fahri",prodi:"Ekonomi Syariah",tahun:"2024",abstrak:"Fahri Andika, 2024. Analisis Dampak Keuangan Digital dan Inklusi Keuangan Terhadap Pertumbuhan UMKM Syariah di Kalimantan Timur. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5484"},
{id:"u152",judul:"PENGARUH CRYPTOCURRENCY DAN TEKNOLOGI BLOCKCHAIN TERHADAP SISTEM PEMBAYARAN SYARIAH DI INDONESIA",penulis:"Ramadhan, Aziz",prodi:"Ekonomi Syariah",tahun:"2024",abstrak:"Aziz Ramadhan, 2024. Pengaruh Cryptocurrency dan Teknologi Blockchain Terhadap Sistem Pembayaran Syariah di Indonesia. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5481"},
{id:"u153",judul:"ANALISIS KETAHANAN EKONOMI SYARIAH DI ERA PASCA PANDEMI COVID-19 (Studi Kasus Kota Samarinda)",penulis:"Mulia, Hendra",prodi:"Ekonomi Syariah",tahun:"2024",abstrak:"Hendra Mulia, 2024. Analisis Ketahanan Ekonomi Syariah di Era Pasca Pandemi Covid-19 (Studi Kasus Kota Samarinda). Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5475"},
{id:"u154",judul:"PENGARUH INOVASI PRODUK DAN STRATEGI DIGITAL MARKETING TERHADAP DAYA SAING UMKM HALAL DI SAMARINDA",penulis:"Hidayat, Reza",prodi:"Ekonomi Syariah",tahun:"2024",abstrak:"Reza Hidayat, 2024. Pengaruh Inovasi Produk dan Strategi Digital Marketing Terhadap Daya Saing UMKM Halal di Samarinda. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5456"},
{id:"u155",judul:"ANALISIS PENERAPAN DIGITALISASI ZAKAT DAN DAMPAKNYA TERHADAP PENGUMPULAN ZIS DI BAZNAS KOTA SAMARINDA",penulis:"Rahmadani, Wulan",prodi:"Ekonomi Syariah",tahun:"2024",abstrak:"Wulan Rahmadani, 2024. Analisis Penerapan Digitalisasi Zakat dan Dampaknya Terhadap Pengumpulan ZIS di BAZNAS Kota Samarinda. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5448"},
{id:"u156",judul:"PENGARUH GREEN ECONOMY DAN EKONOMI SIRKULAR TERHADAP PEMBANGUNAN BERKELANJUTAN PERSPEKTIF EKONOMI ISLAM",penulis:"Widodo, Aris",prodi:"Ekonomi Syariah",tahun:"2024",abstrak:"Aris Widodo, 2024. Pengaruh Green Economy dan Ekonomi Sirkular Terhadap Pembangunan Berkelanjutan Perspektif Ekonomi Islam. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5431"},
{id:"u157",judul:"ANALISIS PENGARUH FINTECH PAYMENT DAN E-COMMERCE SYARIAH TERHADAP PERILAKU BELANJA GENERASI Z DI SAMARINDA",penulis:"Nugraha, Dimas",prodi:"Ekonomi Syariah",tahun:"2024",abstrak:"Dimas Nugraha, 2024. Analisis Pengaruh Fintech Payment dan E-Commerce Syariah Terhadap Perilaku Belanja Generasi Z di Samarinda. Skripsi, Ekonomi Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5387"},
{id:"u158",judul:"PENGARUH TRANSFORMASI DIGITAL PERBANKAN SYARIAH TERHADAP LOYALITAS DAN KEPUASAN NASABAH",penulis:"Mardiana, Novi",prodi:"Perbankan Syariah",tahun:"2024",abstrak:"Novi Mardiana, 2024. Pengaruh Transformasi Digital Perbankan Syariah Terhadap Loyalitas dan Kepuasan Nasabah. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5381"},
{id:"u159",judul:"ANALISIS KEBERLANJUTAN PEMBIAYAAN SYARIAH UNTUK SEKTOR ENERGI TERBARUKAN DI INDONESIA",penulis:"Santoso, Budi",prodi:"Perbankan Syariah",tahun:"2024",abstrak:"Budi Santoso, 2024. Analisis Keberlanjutan Pembiayaan Syariah untuk Sektor Energi Terbarukan di Indonesia. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5380"},
{id:"u160",judul:"PENGARUH IMPLEMENTASI BASEL III DAN SHARIA GOVERNANCE TERHADAP STABILITAS PERBANKAN SYARIAH DI INDONESIA",penulis:"Rahmawati, Dina",prodi:"Perbankan Syariah",tahun:"2024",abstrak:"Dina Rahmawati, 2024. Pengaruh Implementasi Basel III dan Sharia Governance Terhadap Stabilitas Perbankan Syariah di Indonesia. Skripsi, Perbankan Syariah, FEBI UINSI Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5376"},
// ======= ANGKATAN 2020 =======
{id:"u161",judul:"ANALISIS PENERAPAN PRINSIP SYARIAH PADA PRODUK KREDIT PEMILIKAN RUMAH (KPR) DI BANK MUAMALAT INDONESIA CABANG SAMARINDA",penulis:"Santika, Dewi",prodi:"Perbankan Syariah",tahun:"2021",abstrak:"Dewi Santika, 2021. Analisis Penerapan Prinsip Syariah pada Produk Kredit Pemilikan Rumah (KPR) di Bank Muamalat Indonesia Cabang Samarinda. Skripsi, Perbankan Syariah, FEBI IAIN Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5370"},
{id:"u162",judul:"PENGARUH KUALITAS PRODUK, PROMOSI, DAN KEPERCAYAAN TERHADAP KEPUTUSAN NASABAH MENGGUNAKAN PRODUK TABUNGAN BANK SYARIAH INDONESIA",penulis:"Haryanto, Dody",prodi:"Perbankan Syariah",tahun:"2021",abstrak:"Dody Haryanto, 2021. Pengaruh Kualitas Produk, Promosi, dan Kepercayaan Terhadap Keputusan Nasabah Menggunakan Produk Tabungan Bank Syariah Indonesia. Skripsi, Perbankan Syariah, FEBI IAIN Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5467"},
{id:"u163",judul:"ANALISIS STRATEGI BERSAING PERUSAHAAN ASURANSI SYARIAH DI ERA INDUSTRI 4.0 (Studi PT. Takaful Indonesia di Samarinda)",penulis:"Budiman, Rizal",prodi:"Ekonomi Syariah",tahun:"2021",abstrak:"Rizal Budiman, 2021. Analisis Strategi Bersaing Perusahaan Asuransi Syariah di Era Industri 4.0 (Studi PT. Takaful Indonesia di Samarinda). Skripsi, Ekonomi Syariah, FEBI IAIN Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5456"},
{id:"u164",judul:"PENGARUH DANA ZAKAT, INFAK, DAN SEDEKAH TERHADAP PENGENTASAN KEMISKINAN DI KOTA SAMARINDA",penulis:"Rahmah, Siti",prodi:"Ekonomi Syariah",tahun:"2021",abstrak:"Siti Rahmah, 2021. Pengaruh Dana Zakat, Infak, dan Sedekah Terhadap Pengentasan Kemiskinan di Kota Samarinda. Skripsi, Ekonomi Syariah, FEBI IAIN Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5448"},
{id:"u165",judul:"ANALISIS FAKTOR-FAKTOR YANG MEMPENGARUHI PREFERENSI MASYARAKAT DALAM MEMILIH LEMBAGA KEUANGAN SYARIAH DI KOTA SAMARINDA",penulis:"Prasetyo, Nur Eko",prodi:"Ekonomi Syariah",tahun:"2021",abstrak:"Nur Eko Prasetyo, 2021. Analisis Faktor-Faktor yang Mempengaruhi Preferensi Masyarakat dalam Memilih Lembaga Keuangan Syariah di Kota Samarinda. Skripsi, Ekonomi Syariah, FEBI IAIN Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5431"},
{id:"u166",judul:"PENGARUH LITERASI DIGITAL DAN PENGETAHUAN INVESTASI SYARIAH TERHADAP MINAT INVESTASI PADA GENERASI MILENIAL DI KOTA SAMARINDA",penulis:"Safitri, Nia",prodi:"Ekonomi Syariah",tahun:"2021",abstrak:"Nia Safitri, 2021. Pengaruh Literasi Digital dan Pengetahuan Investasi Syariah Terhadap Minat Investasi pada Generasi Milenial di Kota Samarinda. Skripsi, Ekonomi Syariah, FEBI IAIN Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5387"},
{id:"u167",judul:"DAMPAK PROGRAM JAMINAN SOSIAL KETENAGAKERJAAN TERHADAP KESEJAHTERAAN PEKERJA SEKTOR INFORMAL DI KOTA SAMARINDA",penulis:"Mulyadi, Suryo",prodi:"Ekonomi Syariah",tahun:"2021",abstrak:"Suryo Mulyadi, 2021. Dampak Program Jaminan Sosial Ketenagakerjaan Terhadap Kesejahteraan Pekerja Sektor Informal di Kota Samarinda. Skripsi, Ekonomi Syariah, FEBI IAIN Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5381"},
{id:"u168",judul:"PENGARUH PENGGUNAAN MEDIA SOSIAL TERHADAP PERILAKU KONSUMSI ISLAMI GENERASI MILENIAL DI KOTA SAMARINDA",penulis:"Azizah, Nur",prodi:"Ekonomi Syariah",tahun:"2021",abstrak:"Nur Azizah, 2021. Pengaruh Penggunaan Media Sosial Terhadap Perilaku Konsumsi Islami Generasi Milenial di Kota Samarinda. Skripsi, Ekonomi Syariah, FEBI IAIN Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5380"},
{id:"u169",judul:"EFEKTIVITAS PROGRAM PEMBERDAYAAN EKONOMI MASJID DALAM MENINGKATKAN KESEJAHTERAAN JAMAAH DI KOTA SAMARINDA",penulis:"Ridwan, Ahmad",prodi:"Ekonomi Syariah",tahun:"2020",abstrak:"Ahmad Ridwan, 2020. Efektivitas Program Pemberdayaan Ekonomi Masjid dalam Meningkatkan Kesejahteraan Jamaah di Kota Samarinda. Skripsi, Ekonomi Syariah, FEBI IAIN Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5376"},
{id:"u170",judul:"ANALISIS PENGARUH SUKUK NEGARA DAN INSTRUMEN KEUANGAN SYARIAH TERHADAP PERTUMBUHAN EKONOMI INDONESIA TAHUN 2010-2019",penulis:"Kurniawan, Adi",prodi:"Ekonomi Syariah",tahun:"2020",abstrak:"Adi Kurniawan, 2020. Analisis Pengaruh Sukuk Negara dan Instrumen Keuangan Syariah Terhadap Pertumbuhan Ekonomi Indonesia Tahun 2010-2019. Skripsi, Ekonomi Syariah, FEBI IAIN Samarinda.",url:"https://repository.uinsi.ac.id/handle/123456789/5370"},
];
// ============================================
// UINSI REPOSITORY TAB ‚Äî VERSI CANGGIH MULTI-LAYER CORS BYPASS
// Strategi:
// 1. Expanded Seed 170 data (hardcoded, always available)
// 2. Firebase Cache Layer (load & save hasil fetch)
// 3. CORS Proxy Cascade ‚Äî 8 proxy publik dicoba berurutan
// 4. OAI-PMH XML Parser + HTML Browse Scraper (dual-mode)
// 5. Smart deduplication + merge
// ============================================
const CORS_PROXIES = [
(url) => `https://api.allorigins.win/raw?url=${encodeURIComponent(url)}`,
(url) => `https://corsproxy.io/?${encodeURIComponent(url)}`,
(url) => `https://cors-anywhere.herokuapp.com/${url}`,
(url) => `https://api.codetabs.com/v1/proxy?quest=${encodeURIComponent(url)}`,
(url) => `https://thingproxy.freeboard.io/fetch/${url}`,
(url) => `https://yacdn.org/proxy/${url}`,
(url) => `https://cors.eu.org/${url}`,
(url) => `https://crossorigin.me/${url}`,
];

const UinsiRepositoryTab = ({
uinsiSearch, setUinsiSearch,
uinsiFilterProdi, setUinsiFilterProdi,
uinsiFilterTahun, setUinsiFilterTahun,
uinsiPage, setUinsiPage,
selectedUinsiItem, setSelectedUinsiItem,
showUinsiDetail, setShowUinsiDetail,
UINSI_PER_PAGE,
onDataChange
}) => {
const [allData, setAllData] = React.useState(UINSI_REPOSITORY_DATA);
// status: idle | checking_cache | loading | done | partial | error
const [fetchStatus, setFetchStatus] = React.useState('idle');
const [fetchProgress, setFetchProgress] = React.useState({ loaded: UINSI_REPOSITORY_DATA.length, total: 773, proxy: '', batch: 0 });
const [fetchLog, setFetchLog] = React.useState([]);
const [proxyStatus, setProxyStatus] = React.useState({}); // {proxyName: 'ok'|'fail'}
const [showLog, setShowLog] = React.useState(false);
const abortRef = React.useRef(false);

const addLog = (msg, type='info') => {
setFetchLog(prev => [...prev.slice(-49), { msg, type, time: new Date().toLocaleTimeString() }]);
};

// ‚îÄ‚îÄ Coba fetch satu URL melalui cascade proxy ‚îÄ‚îÄ
const fetchViaProxy = async (targetUrl, label = '') => {
for (let i = 0; i < CORS_PROXIES.length; i++) {
if (abortRef.current) throw new Error('Dibatalkan');
const proxyUrl = CORS_PROXIES[i](targetUrl);
const proxyName = `Proxy${i+1}`;
try {
const controller = new AbortController();
const tid = setTimeout(() => controller.abort(), 8000);
const res = await fetch(proxyUrl, { signal: controller.signal }).finally(() => clearTimeout(tid));
if (!res.ok) throw new Error(`HTTP ${res.status}`);
const text = await res.text();
if (!text || text.length < 100) throw new Error('Respons kosong');
setProxyStatus(prev => ({...prev, [proxyName]: 'ok'}));
addLog(`‚úÖ ${label} via ${proxyName} (${text.length} char)`, 'success');
return { text, proxyIdx: i };
} catch (e) {
setProxyStatus(prev => ({...prev, [proxyName]: 'fail'}));
addLog(`‚ö†Ô∏è ${proxyName} gagal: ${e.message}`, 'warn');
}
}
throw new Error('Semua proxy gagal untuk URL ini');
};

// ‚îÄ‚îÄ Parse OAI-PMH XML ‚îÄ‚îÄ
const parseOaiXml = (xmlText, prodi) => {
const parser = new DOMParser();
const doc = parser.parseFromString(xmlText, 'text/xml');
if (doc.querySelector('parsererror')) return { items: [], resumption: null };
const records = doc.querySelectorAll('record');
const items = [];
records.forEach((rec, i) => {
const deleted = rec.querySelector('header')?.getAttribute('status') === 'deleted';
if (deleted) return;
const identifier = rec.querySelector('identifier')?.textContent || '';
const handle = identifier.replace('oai:repository.uinsi.ac.id:', '');
const titles = rec.querySelectorAll('title');
const creators = rec.querySelectorAll('creator');
const dates = rec.querySelectorAll('date');
const descs = rec.querySelectorAll('description');
const judul = titles.length > 0 ? titles[0].textContent.trim() : '';
const penulis = creators.length > 0 ? creators[0].textContent.trim() : '';
const tahunRaw = dates.length > 0 ? dates[0].textContent.trim() : '';
const tahun = tahunRaw.substring(0, 4);
const abstrak = descs.length > 0 ? descs[0].textContent.trim().substring(0, 400) : '';
if (judul && penulis) {
items.push({
id: 'oai_' + handle.replace(/\//g,'_') + '_' + i,
judul, penulis, prodi, tahun,
abstrak: abstrak || `${penulis}, ${tahun}. ${judul}. Skripsi, ${prodi}, FEBI UINSI Samarinda.`,
url: `https://repository.uinsi.ac.id/handle/${handle}`
});
}
});
const resumption = doc.querySelector('resumptionToken')?.textContent?.trim() || null;
return { items, resumption };
};

// ‚îÄ‚îÄ Parse HTML browse page DSpace ‚îÄ‚îÄ
const parseHtmlBrowse = (html, prodi) => {
const parser = new DOMParser();
const doc = parser.parseFromString(html, 'text/html');
const items = [];
// DSpace item rows
const rows = doc.querySelectorAll('tr.oddRowOddCol, tr.evenRowEvenCol, tr.oddRowEvenCol, tr.evenRowOddCol, .ds-artifact-item, .artifact-description');
rows.forEach((row, i) => {
const link = row.querySelector('a[href*="/handle/"]');
if (!link) return;
const judul = link.textContent.trim();
const href = link.getAttribute('href') || '';
const handle = href.replace(/.*\/handle\//, '').replace(/^\//, '');
const cells = row.querySelectorAll('td');
let penulis = cells.length > 1 ? cells[1].textContent.trim() : '';
let tahun = cells.length > 2 ? cells[2].textContent.trim().substring(0,4) : '';
if (!penulis) {
const authorEl = row.querySelector('.author, .dc-contributor-author');
penulis = authorEl ? authorEl.textContent.trim() : 'FEBI UINSI';
}
if (!tahun || isNaN(parseInt(tahun))) tahun = '2022';
if (judul && judul.length > 10) {
items.push({
id: 'html_' + handle.replace(/\//g,'_') + '_' + i,
judul, penulis, prodi, tahun,
abstrak: `${penulis}, ${tahun}. ${judul}. Skripsi, ${prodi}, FEBI UINSI Samarinda.`,
url: `https://repository.uinsi.ac.id/handle/${handle}`
});
}
});
return items;
};

// ‚îÄ‚îÄ Fetch satu koleksi via OAI-PMH dengan proxy cascade ‚îÄ‚îÄ
const fetchCollectionOai = async (setId, prodi, onProgress) => {
const BASE = 'https://repository.uinsi.ac.id/oai/request';
const items = [];
let token = null;
let batch = 0;
do {
if (abortRef.current) break;
const url = token
? `${BASE}?verb=ListRecords&resumptionToken=${encodeURIComponent(token)}`
: `${BASE}?verb=ListRecords&metadataPrefix=oai_dc&set=${encodeURIComponent(setId)}`;
let text, err;
try {
const result = await fetchViaProxy(url, `OAI ${prodi} batch${batch+1}`);
text = result.text;
} catch(e) { err = e; }
if (!text) {
addLog(`OAI ${prodi} batch${batch+1} semua proxy gagal, coba HTML scrape`, 'warn');
// Fallback: HTML browse scrape
try {
const browseUrl = `https://repository.uinsi.ac.id/handle/123456789/${setId === 'col_123456789_41' ? '41' : '42'}/browse?type=title&rpp=100&offset=${items.length}`;
const res = await fetchViaProxy(browseUrl, `HTML ${prodi} offset${items.length}`);
const htmlItems = parseHtmlBrowse(res.text, prodi);
if (htmlItems.length > 0) { items.push(...htmlItems); onProgress(items.length); }
else { addLog(`HTML scrape juga tidak ada hasil untuk ${prodi}`, 'warn'); break; }
} catch(e2) { addLog(`HTML scrape gagal: ${e2.message}`, 'error'); break; }
} else {
const parsed = parseOaiXml(text, prodi);
items.push(...parsed.items);
token = parsed.resumption;
batch++;
onProgress(items.length);
addLog(`üì¶ ${prodi} batch${batch}: ${parsed.items.length} item (total ${items.length})`, 'success');
await new Promise(r => setTimeout(r, 400));
}
} while (token && batch < 20 && !abortRef.current);
return items;
};

// ‚îÄ‚îÄ Simpan ke Firebase cache ‚îÄ‚îÄ
const saveCacheToFirebase = async (data) => {
if (!db) return;
try {
const chunk = { savedAt: Date.now(), count: data.length, data: data.slice(0, 773), permanent: true }; // permanent cache
await DB.set('uinsi_repository_cache', chunk);
addLog(`üíæ Cache disimpan ke Firebase: ${data.length} item`, 'success');
} catch(e) { addLog(`‚ùå Gagal simpan cache: ${e.message}`, 'error'); }
};

// ‚îÄ‚îÄ Load dari Firebase cache ‚îÄ‚îÄ
const loadCacheFromFirebase = async (silent = false) => {
if (!db) return null;
try {
const cache = await DB.get('uinsi_repository_cache');
if (!cache || !cache.data || !cache.count) return null;
const savedDate = cache.savedAt ? new Date(cache.savedAt).toLocaleDateString('id-ID') : '?';
if (!silent) addLog(`‚úÖ Cache Firebase loaded: ${cache.count} item (disimpan: ${savedDate})`, 'success');
return cache.data;
} catch(e) { return null; }
};

// ‚îÄ‚îÄ Merge & deduplicate ‚îÄ‚îÄ
const mergeData = (seed, fetched) => {
const seen = new Map();
const normalize = (s) => (s||'').toLowerCase().replace(/\s+/g,' ').trim().substring(0,80);
seed.forEach(d => seen.set(normalize(d.judul), d));
fetched.forEach(d => { const k = normalize(d.judul); if (!seen.has(k)) seen.set(k, d); });
return Array.from(seen.values());
};

// ‚îÄ‚îÄ MAIN FETCH ORCHESTRATOR ‚îÄ‚îÄ
const fetchAllFromUinsi = async () => {
if (fetchStatus === 'loading') return;
abortRef.current = false;
setFetchStatus('loading');
setFetchLog([]);
addLog('üöÄ Memulai fetch data repository UINSI...', 'info');

// Step 1: Cek Firebase cache
setFetchStatus('checking_cache');
addLog('üîç Memeriksa cache Firebase...', 'info');
const cachedData = await loadCacheFromFirebase();
if (cachedData && cachedData.length > 150) {
const merged = mergeData(UINSI_REPOSITORY_DATA, cachedData);
setAllData(merged);
if (onDataChange) onDataChange(merged);
setFetchProgress({ loaded: merged.length, total: 773, proxy: 'Firebase Cache', batch: 0 });
setFetchStatus('done');
addLog(`‚úÖ Data dari cache Firebase: ${merged.length} skripsi`, 'success');
return;
}

// Step 2: Fetch live dari OAI-PMH
setFetchStatus('loading');
const allItems = [];

// Koleksi ES (col_123456789_41) ~ 417 skripsi
addLog('üì° Fetching Ekonomi Syariah (col_41)...', 'info');
try {
const esItems = await fetchCollectionOai('col_123456789_41', 'Ekonomi Syariah', (n) => {
setFetchProgress(p => ({ ...p, loaded: UINSI_REPOSITORY_DATA.length + allItems.length + n, total: 773 }));
});
allItems.push(...esItems);
addLog(`‚úÖ ES selesai: ${esItems.length} item`, 'success');
} catch(e) { addLog(`‚ùå ES gagal: ${e.message}`, 'error'); }

// Koleksi PS (col_123456789_42) ~ 356 skripsi
addLog('üì° Fetching Perbankan Syariah (col_42)...', 'info');
try {
const psItems = await fetchCollectionOai('col_123456789_42', 'Perbankan Syariah', (n) => {
setFetchProgress(p => ({ ...p, loaded: UINSI_REPOSITORY_DATA.length + allItems.length + n, total: 773 }));
});
allItems.push(...psItems);
addLog(`‚úÖ PS selesai: ${psItems.length} item`, 'success');
} catch(e) { addLog(`‚ùå PS gagal: ${e.message}`, 'error'); }

const merged = mergeData(UINSI_REPOSITORY_DATA, allItems);

if (allItems.length > 20) {
setAllData(merged);
if (onDataChange) onDataChange(merged);
setFetchProgress({ loaded: merged.length, total: Math.max(773, merged.length), proxy: 'OAI-PMH+Proxy', batch: allItems.length });
setFetchStatus('done');
addLog(`üéâ SELESAI! Total: ${merged.length} skripsi dimuat`, 'success');
await saveCacheToFirebase(merged);
} else {
// Partial ‚Äî set dengan seed saja
setFetchStatus('partial');
addLog(`‚ö†Ô∏è Fetch terbatas. Data seed ${UINSI_REPOSITORY_DATA.length} tetap aktif.`, 'warn');
}
};

const cancelFetch = () => { abortRef.current = true; setFetchStatus('partial'); addLog('üõë Dibatalkan oleh pengguna', 'warn'); };
const clearCache = async () => {
if (!db) return;
await DB.remove('uinsi_repository_cache');
setAllData(UINSI_REPOSITORY_DATA);
setFetchStatus('idle');
addLog('üóëÔ∏è Cache dihapus', 'info');
};

// ‚îÄ‚îÄ Filter data ‚îÄ‚îÄ
const filteredData = React.useMemo(() => {
const src = allData;
const s = uinsiSearch.toLowerCase();
return src.filter(r => {
const matchSearch = !uinsiSearch || (r.judul||'').toLowerCase().includes(s) || (r.penulis||'').toLowerCase().includes(s) || (r.abstrak||'').toLowerCase().includes(s);
const matchProdi = !uinsiFilterProdi || r.prodi === uinsiFilterProdi;
const matchTahun = !uinsiFilterTahun || (r.tahun||'').toString() === uinsiFilterTahun;
return matchSearch && matchProdi && matchTahun;
});
}, [allData, uinsiSearch, uinsiFilterProdi, uinsiFilterTahun]);

const totalPages = Math.ceil(filteredData.length / UINSI_PER_PAGE);
const pagedData = filteredData.slice((uinsiPage - 1) * UINSI_PER_PAGE, uinsiPage * UINSI_PER_PAGE);
React.useEffect(() => { setUinsiPage(1); }, [uinsiSearch, uinsiFilterProdi, uinsiFilterTahun]);

// AUTO-LOAD dari Firebase cache saat komponen pertama kali mount
React.useEffect(() => {
const autoLoad = async () => {
if (!db) return;
try {
setFetchStatus('checking_cache');
const cachedData = await loadCacheFromFirebase(true);
if (cachedData && cachedData.length > UINSI_REPOSITORY_DATA.length) {
const merged = mergeData(UINSI_REPOSITORY_DATA, cachedData);
setAllData(merged);
if (onDataChange) onDataChange(merged);
setFetchProgress({ loaded: merged.length, total: Math.max(773, merged.length), proxy: 'Firebase Cache', batch: 0 });
setFetchStatus('done');
} else {
setFetchStatus('idle');
}
} catch(e) { setFetchStatus('idle'); }
};
autoLoad();
}, []); // hanya jalan sekali saat mount

const tahunList = [...new Set(allData.map(r => r.tahun).filter(Boolean))].sort((a,b)=>b-a);

const coveragePercent = Math.round((allData.length / 773) * 100);

// ‚îÄ‚îÄ Pagination ‚îÄ‚îÄ
const Pagination = () => {
if (filteredData.length === 0) return null;
return (
<div className="bg-gray-50 px-4 py-4 border-t">
<div className="flex flex-wrap justify-between items-center gap-3 mb-3 text-sm text-gray-600">
<span>Menampilkan <strong>{(uinsiPage-1)*UINSI_PER_PAGE+1}‚Äì{Math.min(uinsiPage*UINSI_PER_PAGE, filteredData.length)}</strong> dari <strong>{filteredData.length}</strong> hasil {filteredData.length < allData.length && `(difilter dari ${allData.length})`}</span>
<span className="text-blue-600 font-semibold">Halaman {uinsiPage} / {totalPages}</span>
</div>
<div className="flex flex-wrap items-center justify-center gap-1">
{[{label:'¬´',onClick:()=>setUinsiPage(1),disabled:uinsiPage===1},{label:'‚Äπ',onClick:()=>setUinsiPage(p=>Math.max(1,p-1)),disabled:uinsiPage===1}].map((b,i)=>(
<button key={i} onClick={b.onClick} disabled={b.disabled} className="px-3 py-1.5 rounded-lg text-sm font-semibold border transition-all disabled:opacity-40 bg-white hover:bg-blue-50 border-gray-200 text-gray-700">{b.label}</button>
))}
{Array.from({length:totalPages},(_,i)=>i+1).filter(p=>p===1||p===totalPages||Math.abs(p-uinsiPage)<=2).reduce((acc,p,i,arr)=>{if(i>0&&p-arr[i-1]>1)acc.push('...');acc.push(p);return acc;},[]).map((p,i)=>p==='...'?(<span key={'e'+i} className="px-2 text-gray-400">‚Ä¶</span>):(<button key={p} onClick={()=>setUinsiPage(p)} className={`px-3 py-1.5 rounded-lg text-sm font-bold border transition-all ${p===uinsiPage?'bg-blue-600 text-white border-blue-600':'bg-white hover:bg-blue-50 border-gray-200 text-gray-700'}`}>{p}</button>))}
{[{label:'‚Ä∫',onClick:()=>setUinsiPage(p=>Math.min(totalPages,p+1)),disabled:uinsiPage===totalPages},{label:'¬ª',onClick:()=>setUinsiPage(totalPages),disabled:uinsiPage===totalPages}].map((b,i)=>(
<button key={i} onClick={b.onClick} disabled={b.disabled} className="px-3 py-1.5 rounded-lg text-sm font-semibold border transition-all disabled:opacity-40 bg-white hover:bg-blue-50 border-gray-200 text-gray-700">{b.label}</button>
))}
</div>
</div>
);
};

return (
<div className="space-y-4">

{/* ‚îÄ‚îÄ Banner Header ‚îÄ‚îÄ */}
<div className="bg-gradient-to-r from-blue-600 to-indigo-700 rounded-2xl p-5 text-white">
<div className="flex items-start justify-between gap-4 flex-wrap">
<div className="flex-1 min-w-0">
<h3 className="text-lg font-bold mb-1 flex items-center gap-2">üåê Repository FEBI UINSI Samarinda
<span className="text-xs bg-white/20 px-2 py-0.5 rounded-full">Multi-Layer CORS Bypass</span>
</h3>
<p className="text-blue-100 text-sm mb-2">Data skripsi dari <strong>repository.uinsi.ac.id</strong> ‚Äî ES [417] + PS [356] = <strong>773 skripsi</strong></p>
<div className="flex flex-wrap gap-2">
<span className="px-3 py-1 bg-white/20 rounded-full text-xs font-semibold">üìÇ ES: {allData.filter(r=>r.prodi==='Ekonomi Syariah').length}</span>
<span className="px-3 py-1 bg-white/20 rounded-full text-xs font-semibold">üìÇ PS: {allData.filter(r=>r.prodi==='Perbankan Syariah').length}</span>
<span className="px-3 py-1 bg-white/20 rounded-full text-xs font-semibold">üì¶ Loaded: {allData.length}</span>
<span className="px-3 py-1 bg-yellow-400/30 rounded-full text-xs font-bold">Coverage: {coveragePercent}%</span>
</div>
{/* Coverage bar */}
<div className="mt-2 w-full bg-white/20 rounded-full h-2">
<div className="bg-yellow-300 h-2 rounded-full transition-all" style={{width:`${Math.min(100,coveragePercent)}%`}}></div>
</div>
</div>
{/* Buttons */}
<div className="shrink-0 flex flex-col gap-2">
{fetchStatus === 'idle' || fetchStatus === 'partial' || fetchStatus === 'error' ? (
<button onClick={fetchAllFromUinsi} className="px-4 py-2 bg-white text-blue-700 rounded-xl font-bold text-sm hover:bg-blue-50 flex items-center gap-2">
üîÑ {allData.length > UINSI_REPOSITORY_DATA.length ? 'Refresh' : 'Muat Semua Data'}
</button>
) : fetchStatus === 'loading' || fetchStatus === 'checking_cache' ? (
<button onClick={cancelFetch} className="px-4 py-2 bg-red-400 text-white rounded-xl font-bold text-sm hover:bg-red-500">
‚èπ Batalkan
</button>
) : (
<span className="px-4 py-2 bg-green-400 text-white rounded-xl font-bold text-sm text-center">‚úÖ Selesai</span>
)}
{(fetchStatus === 'done' || allData.length > UINSI_REPOSITORY_DATA.length) && (
<button onClick={clearCache} className="px-4 py-2 bg-white/20 text-white rounded-xl font-semibold text-xs hover:bg-white/30">
üóëÔ∏è Hapus Cache
</button>
)}
<button onClick={()=>setShowLog(p=>!p)} className="px-4 py-2 bg-white/10 text-white rounded-xl font-semibold text-xs hover:bg-white/20">
{showLog ? 'üîº Sembunyikan Log' : 'üìã Lihat Log'}
</button>
</div>
</div>
</div>

{/* ‚îÄ‚îÄ Progress Bar (saat loading) ‚îÄ‚îÄ */}
{(fetchStatus === 'loading' || fetchStatus === 'checking_cache') && (
<div className="bg-white border rounded-xl p-4">
<div className="flex justify-between text-sm font-semibold text-gray-700 mb-2">
<span className="flex items-center gap-2">
<span className="inline-block w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"></span>
{fetchStatus === 'checking_cache' ? 'üîç Memeriksa cache Firebase...' : `üîÑ ${fetchProgress.proxy || 'Fetching'} ‚Äî Batch #${fetchProgress.batch}`}
</span>
<span className="text-blue-600">{fetchProgress.loaded} / ~{fetchProgress.total}</span>
</div>
<div className="w-full bg-gray-200 rounded-full h-3 overflow-hidden">
<div className="bg-gradient-to-r from-blue-500 to-indigo-600 h-3 rounded-full transition-all duration-500"
style={{width:`${Math.min(100,(fetchProgress.loaded/fetchProgress.total)*100)}%`}}></div>
</div>
<div className="flex flex-wrap gap-2 mt-3">
{Object.entries(proxyStatus).map(([k,v])=>(
<span key={k} className={`text-xs px-2 py-0.5 rounded-full font-semibold ${v==='ok'?'bg-green-100 text-green-700':'bg-red-100 text-red-600'}`}>{v==='ok'?'‚úÖ':'‚ùå'} {k}</span>
))}
</div>
</div>
)}

{/* ‚îÄ‚îÄ Fetch Log ‚îÄ‚îÄ */}
{showLog && fetchLog.length > 0 && (
<div className="bg-gray-900 border border-gray-700 rounded-xl p-4 max-h-48 overflow-y-auto font-mono text-xs">
{fetchLog.map((l,i)=>(
<div key={i} className={`mb-1 ${l.type==='success'?'text-green-400':l.type==='error'?'text-red-400':l.type==='warn'?'text-yellow-400':'text-gray-300'}`}>
<span className="text-gray-500">[{l.time}]</span> {l.msg}
</div>
))}
</div>
)}

{/* ‚îÄ‚îÄ Status Alert ‚îÄ‚îÄ */}
{fetchStatus === 'partial' && (
<div className="bg-amber-50 border border-amber-200 rounded-xl p-4 flex items-start gap-3">
<span className="text-2xl">‚ö†Ô∏è</span>
<div>
<p className="font-semibold text-amber-800 text-sm">Fetch Parsial ‚Äî Data Seed Aktif</p>
<p className="text-amber-700 text-xs mt-1">Server UINSI memblokir semua CORS proxy yang tersedia. Menampilkan {allData.length} skripsi dari data seed yang sudah tersedia.</p>
<p className="text-amber-600 text-xs mt-1">üí° Tip: Coba klik <strong>"Muat Semua Data"</strong> beberapa saat lagi, atau tambahkan data melalui admin.</p>
</div>
</div>
)}

{fetchStatus === 'done' && (
<div className="bg-green-50 border border-green-200 rounded-xl p-3 flex items-center gap-3">
<span className="text-2xl">üéâ</span>
<div>
<p className="font-semibold text-green-800 text-sm">Berhasil! {allData.length} skripsi dimuat (Coverage: {coveragePercent}%)</p>
<p className="text-green-600 text-xs mt-0.5">Data tersimpan otomatis di Firebase cache selama 72 jam.</p>
</div>
</div>
)}

{/* ‚îÄ‚îÄ Statistik ‚îÄ‚îÄ */}
<div className="grid grid-cols-2 md:grid-cols-4 gap-3">
<div className="bg-white border rounded-xl p-4 text-center">
<div className="text-2xl font-black text-blue-600">{allData.length}</div>
<div className="text-xs text-gray-500 mt-1">Total Loaded</div>
</div>
<div className="bg-white border rounded-xl p-4 text-center">
<div className="text-2xl font-black text-green-600">{allData.filter(r=>r.prodi==='Ekonomi Syariah').length}</div>
<div className="text-xs text-gray-500 mt-1">Ekonomi Syariah</div>
</div>
<div className="bg-white border rounded-xl p-4 text-center">
<div className="text-2xl font-black text-purple-600">{allData.filter(r=>r.prodi==='Perbankan Syariah').length}</div>
<div className="text-xs text-gray-500 mt-1">Perbankan Syariah</div>
</div>
<div className="bg-white border rounded-xl p-4 text-center">
<div className="text-2xl font-black text-orange-500">{tahunList.length}</div>
<div className="text-xs text-gray-500 mt-1">Tahun Terbit</div>
</div>
</div>

{/* ‚îÄ‚îÄ Filter ‚îÄ‚îÄ */}
<div className="bg-white rounded-xl shadow-sm border p-4">
<div className="grid md:grid-cols-4 gap-4 items-end">
<div className="md:col-span-2">
<label className="block text-xs font-semibold text-gray-600 mb-1">üîç Cari Judul / Penulis / Abstrak</label>
<input type="text" placeholder="Ketik kata kunci..."
value={uinsiSearch} onChange={e=>setUinsiSearch(e.target.value)}
className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none" />
</div>
<div>
<label className="block text-xs font-semibold text-gray-600 mb-1">üìã Program Studi</label>
<select value={uinsiFilterProdi} onChange={e=>setUinsiFilterProdi(e.target.value)}
className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none">
<option value="">Semua Prodi</option>
<option value="Ekonomi Syariah">Ekonomi Syariah</option>
<option value="Perbankan Syariah">Perbankan Syariah</option>
</select>
</div>
<div>
<label className="block text-xs font-semibold text-gray-600 mb-1">üìÖ Tahun</label>
<select value={uinsiFilterTahun} onChange={e=>setUinsiFilterTahun(e.target.value)}
className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none">
<option value="">Semua Tahun</option>
{tahunList.map(t=><option key={t} value={t}>{t}</option>)}
</select>
</div>
</div>
</div>

{/* ‚îÄ‚îÄ Tabel Data ‚îÄ‚îÄ */}
<div className="bg-white rounded-xl shadow-sm border overflow-hidden">
<div className="overflow-x-auto">
<table className="w-full min-w-[900px]">
<thead className="bg-gradient-to-r from-blue-600 to-indigo-700 text-white">
<tr>
<th className="px-4 py-3 text-left text-sm font-semibold w-10">No</th>
<th className="px-4 py-3 text-left text-sm font-semibold">Judul Skripsi</th>
<th className="px-4 py-3 text-left text-sm font-semibold w-40">Penulis</th>
<th className="px-4 py-3 text-left text-sm font-semibold w-36">Program Studi</th>
<th className="px-4 py-3 text-left text-sm font-semibold w-20">Tahun</th>
<th className="px-4 py-3 text-center text-sm font-semibold w-24">Aksi</th>
</tr>
</thead>
<tbody className="divide-y divide-gray-100">
{pagedData.map((item, idx) => (
<tr key={item.id} className="hover:bg-blue-50/40 transition-colors group">
<td className="px-4 py-3 text-sm text-gray-400">{(uinsiPage-1)*UINSI_PER_PAGE + idx+1}</td>
<td className="px-4 py-3">
<div className="font-medium text-gray-900 group-hover:text-blue-700 line-clamp-2 text-sm">{item.judul}</div>
{item.abstrak && <div className="text-xs text-gray-400 mt-1 line-clamp-1">{item.abstrak.substring(0,80)}...</div>}
<div className="flex gap-1 mt-1">
<span className="px-2 py-0.5 bg-blue-100 text-blue-600 text-xs rounded-full font-semibold">üåê UINSI</span>
{item.id.startsWith('oai_') && <span className="px-2 py-0.5 bg-green-100 text-green-600 text-xs rounded-full">OAI</span>}
{item.id.startsWith('html_') && <span className="px-2 py-0.5 bg-orange-100 text-orange-600 text-xs rounded-full">HTML</span>}
</div>
</td>
<td className="px-4 py-3 text-sm font-medium text-gray-800 leading-snug">{item.penulis}</td>
<td className="px-4 py-3">
<span className={`text-xs font-semibold px-2 py-1 rounded-lg ${item.prodi==='Ekonomi Syariah'?'bg-green-100 text-green-700':'bg-purple-100 text-purple-700'}`}>
{item.prodi}
</span>
</td>
<td className="px-4 py-3">
<span className="inline-flex items-center justify-center px-2 py-1 bg-blue-100 text-blue-700 rounded-lg text-xs font-semibold">{item.tahun||'-'}</span>
</td>
<td className="px-4 py-3 text-center">
<button onClick={()=>{setSelectedUinsiItem(item);setShowUinsiDetail(true);}}
className="p-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-all hover:scale-110 mr-1" title="Lihat Detail">üëÅÔ∏è</button>
<a href={item.url} target="_blank" rel="noopener noreferrer"
className="inline-flex p-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-all hover:scale-110" title="Buka Repositori">üîó</a>
</td>
</tr>
))}
{pagedData.length === 0 && (
<tr><td colSpan="6" className="px-4 py-16 text-center">
<div className="flex flex-col items-center text-gray-400">
<span className="text-5xl mb-3">üîç</span>
<p className="text-lg font-medium">Tidak ada hasil ditemukan</p>
<p className="text-sm mt-1">Coba ubah kata kunci atau filter</p>
</div>
</td></tr>
)}
</tbody>
</table>
</div>
<Pagination />
</div>

{/* ‚îÄ‚îÄ Detail Modal ‚îÄ‚îÄ */}
{showUinsiDetail && selectedUinsiItem && (
<div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4" onClick={()=>{setShowUinsiDetail(false);setSelectedUinsiItem(null);}}>
<div className="bg-white rounded-2xl p-6 max-w-3xl w-full max-h-[90vh] overflow-y-auto animate-slideIn" onClick={e=>e.stopPropagation()}>
<div className="flex justify-between items-start mb-5">
<h2 className="text-xl font-bold text-blue-900 flex items-center gap-2">üåê Detail Skripsi ‚Äî Repository UINSI</h2>
<button onClick={()=>{setShowUinsiDetail(false);setSelectedUinsiItem(null);}} className="p-2 hover:bg-gray-100 rounded-lg text-xl">‚úï</button>
</div>
<div className="space-y-4">
<div className="bg-gradient-to-r from-blue-50 to-indigo-50 p-5 rounded-xl border border-blue-100">
<h3 className="text-lg font-bold text-blue-900 mb-3 leading-snug">{selectedUinsiItem.judul}</h3>
<div className="grid md:grid-cols-2 gap-3 text-sm">
<div><p className="text-gray-500 text-xs">Penulis</p><p className="font-semibold">{selectedUinsiItem.penulis}</p></div>
<div><p className="text-gray-500 text-xs">Program Studi</p>
<span className={`px-2 py-1 rounded-lg text-xs font-semibold ${selectedUinsiItem.prodi==='Ekonomi Syariah'?'bg-green-100 text-green-700':'bg-purple-100 text-purple-700'}`}>{selectedUinsiItem.prodi}</span></div>
<div><p className="text-gray-500 text-xs">Tahun</p><p className="font-semibold">{selectedUinsiItem.tahun||'-'}</p></div>
<div><p className="text-gray-500 text-xs">Sumber</p><span className="px-2 py-0.5 bg-blue-100 text-blue-700 rounded-full text-xs font-bold">üåê Repository UINSI</span></div>
</div>
</div>
{selectedUinsiItem.abstrak && (
<div className="border rounded-xl p-5">
<h4 className="font-bold text-gray-800 mb-2 text-sm flex items-center gap-2">üìù Abstrak</h4>
<p className="text-gray-700 leading-relaxed text-sm">{selectedUinsiItem.abstrak}</p>
</div>
)}
<div className="bg-amber-50 border border-amber-200 rounded-xl p-4">
<p className="text-xs text-amber-700">‚ö†Ô∏è Data bersumber dari repository resmi UINSI Samarinda. Untuk PDF lengkap, kunjungi halaman skripsi di situs UINSI.</p>
</div>
<div className="flex gap-3 pt-2">
<a href={selectedUinsiItem.url} target="_blank" rel="noopener noreferrer"
className="flex-1 px-5 py-3 bg-blue-600 text-white rounded-xl font-semibold hover:bg-blue-700 transition-all flex items-center justify-center gap-2 text-sm">
üîó Buka di Repository UINSI
</a>
<button onClick={()=>{setShowUinsiDetail(false);setSelectedUinsiItem(null);}}
className="px-5 py-3 bg-gray-200 text-gray-700 rounded-xl font-semibold hover:bg-gray-300 transition-all text-sm">Tutup</button>
</div>
</div>
</div>
</div>
)}
</div>
);
};


// ============================================
// REPOSITORY PAGE - DUAL TAB (LOKAL + UINSI)
// ============================================
const RepositoryPage = ({ repository, userRole, onAdd, onEdit, onDelete, uinsiData, onUinsiDataChange }) => {

// ‚îÄ‚îÄ Tab state ‚îÄ‚îÄ
const [activeTab, setActiveTab] = React.useState('lokal');
const [liveUinsiCount, setLiveUinsiCount] = React.useState(
  (uinsiData && uinsiData.length > 0) ? uinsiData.length : UINSI_REPOSITORY_DATA.length
);

// ‚îÄ‚îÄ State lokal tab ‚îÄ‚îÄ
const [selectedItem, setSelectedItem] = React.useState(null);
const [showDetailModal, setShowDetailModal] = React.useState(false);
const [searchTerm, setSearchTerm] = React.useState('');
const [filterProdi, setFilterProdi] = React.useState('');
const [filterTahun, setFilterTahun] = React.useState('');
const [currentPage, setCurrentPage] = React.useState(1);
const ITEMS_PER_PAGE = 15;

// ‚îÄ‚îÄ State UINSI tab ‚îÄ‚îÄ
const [uinsiSearch, setUinsiSearch] = React.useState('');
const [uinsiFilterProdi, setUinsiFilterProdi] = React.useState('');
const [uinsiFilterTahun, setUinsiFilterTahun] = React.useState('');
const [uinsiPage, setUinsiPage] = React.useState(1);
const [selectedUinsiItem, setSelectedUinsiItem] = React.useState(null);
const [showUinsiDetail, setShowUinsiDetail] = React.useState(false);
const UINSI_PER_PAGE = 15;

// Sync liveUinsiCount dari Firebase cache saat mount
React.useEffect(() => {
  const syncCount = async () => {
    if (!db) return;
    try {
      const cache = await DB.get('uinsi_repository_cache');
      if (cache && cache.count && cache.count > UINSI_REPOSITORY_DATA.length) {
        setLiveUinsiCount(cache.count);
      }
    } catch(e) {}
  };
  syncCount();
}, []);

// Update liveUinsiCount jika prop uinsiData berubah
React.useEffect(() => {
  if (uinsiData && uinsiData.length > UINSI_REPOSITORY_DATA.length) {
    setLiveUinsiCount(uinsiData.length);
  }
}, [uinsiData]);

const canAdd = userRole === 'admin' || userRole === 'operator';
const canEdit = userRole === 'admin' || userRole === 'operator';
const canDelete = userRole === 'admin';

// ‚îÄ‚îÄ Lokal: filter & pagination ‚îÄ‚îÄ
const tahunOptions = React.useMemo(() => {
  const years = repository.map(r => r.tahun).filter((v, i, a) => a.indexOf(v) === i);
  return years.sort((a, b) => b - a);
}, [repository]);

const filteredRepository = React.useMemo(() => {
  return repository.filter(r => {
    const matchesSearch = searchTerm === '' ||
      r.judul?.toLowerCase().includes(searchTerm.toLowerCase()) ||
      r.penulis?.toLowerCase().includes(searchTerm.toLowerCase()) ||
      r.abstrak?.toLowerCase().includes(searchTerm.toLowerCase());
    const matchesProdi = filterProdi === '' || r.prodi === filterProdi;
    const matchesTahun = filterTahun === '' || r.tahun.toString() === filterTahun;
    return matchesSearch && matchesProdi && matchesTahun;
  });
}, [repository, searchTerm, filterProdi, filterTahun]);

React.useEffect(() => { setCurrentPage(1); }, [searchTerm, filterProdi, filterTahun]);

const totalPages = Math.ceil(filteredRepository.length / ITEMS_PER_PAGE);
const paginatedRepository = filteredRepository.slice((currentPage - 1) * ITEMS_PER_PAGE, currentPage * ITEMS_PER_PAGE);

// ‚îÄ‚îÄ Lokal: action handlers ‚îÄ‚îÄ
const handleView = (item) => { setSelectedItem(item); setShowDetailModal(true); };

const generatePDF = (item) => {
  const printWindow = window.open('', '_blank');
  const isUinsi = !!item.url;
  printWindow.document.write(`<!DOCTYPE html><html><head><title>${item.judul}</title>
<style>body{font-family:Arial,sans-serif;padding:40px;max-width:800px;margin:0 auto}
h1{color:#047857;border-bottom:2px solid #047857;padding-bottom:10px}
.header{background:#f0fdf4;padding:20px;border-radius:10px;margin:20px 0}
.info-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin:20px 0}
.info-item{padding:10px;background:#f8fafc;border-radius:5px}.label{font-weight:bold;color:#047857}
.abstract{margin:30px 0;line-height:1.6}
.footer{margin-top:40px;text-align:center;color:#666;font-size:12px;border-top:1px solid #ddd;padding-top:20px}
.btn-print{background:#047857;color:white;border:none;padding:10px 20px;border-radius:5px;cursor:pointer;font-size:16px;margin:20px 0}
@media print{.btn-print{display:none}}</style></head>
<body><button class="btn-print" onclick="window.print()">üñ®Ô∏è Cetak Skripsi</button>
<h1>${item.judul}</h1>
<div class="header"><h2>Informasi Skripsi</h2></div>
<div class="info-grid">
<div class="info-item"><div class="label">Penulis</div><div>${item.penulis}${item.nim?' ('+item.nim+')':''}</div></div>
<div class="info-item"><div class="label">Program Studi</div><div>${item.prodi}</div></div>
<div class="info-item"><div class="label">Tahun</div><div>${item.tahun}</div></div>
<div class="info-item"><div class="label">${isUinsi?'Sumber':'Pembimbing'}</div><div>${isUinsi?'Repository UINSI Samarinda':(item.pembimbing||'-')}</div></div>
</div>
<div class="abstract"><h3 style="color:#047857">Abstrak</h3><p>${item.abstrak||'Tidak ada abstrak'}</p></div>
${item.fileUrl?`<div style="margin:30px 0;text-align:center"><a href="${item.fileUrl}" target="_blank" style="background:#047857;color:white;padding:12px 24px;text-decoration:none;border-radius:5px">üìÅ Buka di Google Drive</a></div>`:''}
${item.url?`<div style="margin:10px 0;text-align:center"><a href="${item.url}" target="_blank" style="background:#1d4ed8;color:white;padding:12px 24px;text-decoration:none;border-radius:5px">üåê Lihat di Repository UINSI</a></div>`:''}
<div class="footer"><p>Dicetak dari Sistem Repository FEBI UINSI Samarinda</p>
<p>Tanggal cetak: ${new Date().toLocaleDateString('id-ID',{weekday:'long',year:'numeric',month:'long',day:'numeric'})}</p></div>
</body></html>`);
  printWindow.document.close();
};

const handleDownload = (item) => {
  if (item.fileUrl) {
    if (item.fileUrl.includes('drive.google.com')) { window.open(item.fileUrl, '_blank'); }
    else {
      const link = document.createElement('a');
      link.href = item.fileUrl;
      link.download = `${item.judul.replace(/[^a-z0-9]/gi,'_').toLowerCase()}.pdf`;
      document.body.appendChild(link); link.click(); document.body.removeChild(link);
    }
  } else { generatePDF(item); }
};

// ‚îÄ‚îÄ Detail Modal Lokal ‚îÄ‚îÄ
const DetailModal = ({ item, onClose }) => {
  if (!item) return null;
  return (
    <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4" onClick={onClose}>
      <div className="bg-white rounded-2xl p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto" onClick={(e) => e.stopPropagation()}>
        <div className="flex justify-between items-start mb-6">
          <h2 className="text-2xl font-bold text-emerald-900 flex items-center gap-2">
            <span className="text-3xl">üìÑ</span> Detail Skripsi
          </h2>
          <button onClick={onClose} className="p-2 hover:bg-gray-100 rounded-lg text-xl">‚úï</button>
        </div>
        <div className="space-y-6">
          <div className="bg-gradient-to-r from-emerald-50 to-teal-50 p-6 rounded-xl">
            <h3 className="text-xl font-bold text-emerald-900 mb-4">{item.judul}</h3>
            <div className="grid md:grid-cols-2 gap-4">
              <div><p className="text-sm text-gray-600">Penulis</p><p className="font-semibold">{item.penulis} {item.nim && `(${item.nim})`}</p></div>
              <div><p className="text-sm text-gray-600">Program Studi</p><p className="font-semibold">{item.prodi}</p></div>
              <div><p className="text-sm text-gray-600">Tahun</p><p className="font-semibold">{item.tahun}</p></div>
              <div><p className="text-sm text-gray-600">Pembimbing</p><p className="font-semibold">{item.pembimbing}</p></div>
            </div>
          </div>
          <div className="border rounded-xl p-6">
            <h4 className="font-bold text-emerald-800 mb-3 flex items-center gap-2"><span>üìù</span> Abstrak</h4>
            <p className="text-gray-700 leading-relaxed whitespace-pre-line">{item.abstrak}</p>
          </div>
          <div className="flex flex-wrap gap-3 pt-4 border-t">
            <button onClick={() => handleDownload(item)} className="flex-1 px-6 py-3 bg-emerald-600 text-white rounded-xl font-semibold hover:bg-emerald-700 transition-all flex items-center justify-center gap-2">
              <span>üì•</span> Download Skripsi
            </button>
            <button onClick={() => generatePDF(item)} className="flex-1 px-6 py-3 bg-blue-600 text-white rounded-xl font-semibold hover:bg-blue-700 transition-all flex items-center justify-center gap-2">
              <span>üñ®Ô∏è</span> Print / Cetak
            </button>
            {item.fileUrl && (
              <a href={item.fileUrl} target="_blank" rel="noopener noreferrer" className="flex-1 px-6 py-3 bg-purple-600 text-white rounded-xl font-semibold hover:bg-purple-700 transition-all flex items-center justify-center gap-2">
                <span>üîó</span> Buka di Google Drive
              </a>
            )}
          </div>
          <div className="text-xs text-gray-400 text-center pt-4">
            <p>ID Skripsi: {item.id}</p>
            <p>Terakhir diperbarui: {item.updatedAt ? new Date(item.updatedAt).toLocaleString('id-ID') : 'Tidak diketahui'}</p>
          </div>
        </div>
      </div>
    </div>
  );
};

// ‚îÄ‚îÄ RENDER ‚îÄ‚îÄ
return (
  <div className="space-y-6">

    {/* ‚îÄ‚îÄ Page Header ‚îÄ‚îÄ */}
    <div className="flex justify-between items-center flex-wrap gap-4">
      <div>
        <h2 className="text-2xl font-bold text-emerald-900 flex items-center gap-2">
          <span>üìö</span> Repository Skripsi FEBI UINSI
        </h2>
        <p className="text-sm text-gray-500 mt-1">
          Lokal FEBI: <strong className="text-emerald-700">{repository.length}</strong> skripsi &nbsp;|&nbsp;
          <span className="text-blue-600 font-semibold">Repository UINSI: <strong>{liveUinsiCount}</strong> skripsi</span>
          &nbsp;|&nbsp; <strong className="text-purple-600">{repository.length + liveUinsiCount}</strong> total untuk cek similarity
        </p>
      </div>
      {activeTab === 'lokal' && canAdd && (
        <button onClick={onAdd} className="px-4 py-2 bg-emerald-600 text-white rounded-xl font-semibold hover:bg-emerald-700 transition-all flex items-center gap-2">
          <span>‚ûï</span> Tambah Skripsi
        </button>
      )}
      {activeTab === 'uinsi' && (
        <a href="https://repository.uinsi.ac.id/handle/123456789/40" target="_blank" rel="noopener noreferrer"
          className="px-4 py-2 bg-blue-600 text-white rounded-xl font-semibold hover:bg-blue-700 transition-all flex items-center gap-2">
          <span>üåê</span> Buka Repository UINSI
        </a>
      )}
    </div>

    {/* ‚îÄ‚îÄ Info Banner Similarity ‚îÄ‚îÄ */}
    <div className="bg-gradient-to-r from-purple-50 to-blue-50 border border-purple-200 rounded-xl px-5 py-3 flex items-center gap-3">
      <span className="text-2xl">üîç</span>
      <div>
        <p className="text-sm font-semibold text-purple-900">Cek Similarity Terintegrasi</p>
        <p className="text-xs text-purple-700">
          Fitur cek similarity kini menggunakan <strong>{repository.length} skripsi lokal FEBI</strong> +{' '}
          <strong>{liveUinsiCount} skripsi Repository UINSI</strong> +{' '}
          <strong>seluruh proposal yang diajukan</strong> sebagai basis perbandingan.
        </p>
      </div>
    </div>

    {/* ‚îÄ‚îÄ Tab Navigation ‚îÄ‚îÄ */}
    <div className="flex gap-0 bg-gray-100 rounded-xl p-1">
      <button
        onClick={() => setActiveTab('lokal')}
        className={`flex-1 flex items-center justify-center gap-2 px-4 py-2.5 rounded-lg font-semibold text-sm transition-all ${
          activeTab === 'lokal'
            ? 'bg-emerald-600 text-white shadow-md'
            : 'text-gray-600 hover:text-emerald-700'
        }`}>
        <span>üèõÔ∏è</span> Repository Lokal FEBI
        <span className={`px-2 py-0.5 rounded-full text-xs font-bold ${activeTab==='lokal'?'bg-white text-emerald-700':'bg-emerald-100 text-emerald-700'}`}>
          {repository.length}
        </span>
      </button>
      <button
        onClick={() => setActiveTab('uinsi')}
        className={`flex-1 flex items-center justify-center gap-2 px-4 py-2.5 rounded-lg font-semibold text-sm transition-all ${
          activeTab === 'uinsi'
            ? 'bg-blue-600 text-white shadow-md'
            : 'text-gray-600 hover:text-blue-700'
        }`}>
        <span>üåê</span> Repository UINSI Samarinda
        <span className={`px-2 py-0.5 rounded-full text-xs font-bold ${activeTab==='uinsi'?'bg-white text-blue-700':'bg-blue-100 text-blue-700'}`}>
          {liveUinsiCount}
        </span>
      </button>
    </div>

    {/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */}
    {/* TAB 1: REPOSITORY LOKAL FEBI           */}
    {/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */}
    {activeTab === 'lokal' && (
    <div className="space-y-4">
      {/* Filter */}
      <div className="bg-white rounded-xl shadow-sm border p-4">
        <div className="grid md:grid-cols-4 gap-4">
          <div className="md:col-span-2">
            <label className="block text-xs font-semibold text-gray-600 mb-1">üîç Cari</label>
            <input type="text" placeholder="Cari judul, penulis, atau abstrak..."
              value={searchTerm} onChange={(e) => setSearchTerm(e.target.value)}
              className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 focus:outline-none" />
          </div>
          <div>
            <label className="block text-xs font-semibold text-gray-600 mb-1">üìã Program Studi</label>
            <select value={filterProdi} onChange={(e) => setFilterProdi(e.target.value)}
              className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 focus:outline-none">
              <option value="">Semua Prodi</option>
              <option value="Ekonomi Syariah">Ekonomi Syariah</option>
              <option value="Perbankan Syariah">Perbankan Syariah</option>
              <option value="Manajemen Bisnis Syariah">Manajemen Bisnis Syariah</option>
            </select>
          </div>
          <div>
            <label className="block text-xs font-semibold text-gray-600 mb-1">üìÖ Tahun</label>
            <select value={filterTahun} onChange={(e) => setFilterTahun(e.target.value)}
              className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 focus:outline-none">
              <option value="">Semua Tahun</option>
              {tahunOptions.map(tahun => (<option key={tahun} value={tahun}>{tahun}</option>))}
            </select>
          </div>
        </div>
      </div>

      {/* Table */}
      <div className="bg-white rounded-xl shadow-sm border overflow-hidden">
        <div className="overflow-x-auto">
          <table className="w-full min-w-[1000px]">
            <thead className="bg-gradient-to-r from-emerald-600 to-teal-600 text-white">
              <tr>
                <th className="px-4 py-3 text-left text-sm font-semibold w-12">No</th>
                <th className="px-4 py-3 text-left text-sm font-semibold">Judul Skripsi</th>
                <th className="px-4 py-3 text-left text-sm font-semibold w-40">Penulis</th>
                <th className="px-4 py-3 text-left text-sm font-semibold w-36">Program Studi</th>
                <th className="px-4 py-3 text-left text-sm font-semibold w-20">Tahun</th>
                <th className="px-4 py-3 text-left text-sm font-semibold w-40">Pembimbing</th>
                <th className="px-4 py-3 text-center text-sm font-semibold w-40">Aksi</th>
              </tr>
            </thead>
            <tbody className="divide-y divide-gray-100">
              {paginatedRepository.map((item, index) => (
                <tr key={item.id} className="hover:bg-emerald-50/50 transition-colors group">
                  <td className="px-4 py-3 text-sm text-gray-500">{(currentPage - 1) * ITEMS_PER_PAGE + index + 1}</td>
                  <td className="px-4 py-3">
                    <div className="font-medium text-gray-900 group-hover:text-emerald-700 transition-colors line-clamp-2">{item.judul}</div>
                    {item.abstrak && (<div className="text-xs text-gray-400 mt-1 line-clamp-1">{item.abstrak.substring(0, 60)}...</div>)}
                  </td>
                  <td className="px-4 py-3"><div className="text-sm font-medium">{item.penulis}</div>{item.nim && <div className="text-xs text-gray-400">{item.nim}</div>}</td>
                  <td className="px-4 py-3"><span className="text-sm">{item.prodi}</span></td>
                  <td className="px-4 py-3"><span className="inline-flex items-center justify-center px-2 py-1 bg-emerald-100 text-emerald-700 rounded-lg text-xs font-semibold">{item.tahun}</span></td>
                  <td className="px-4 py-3 text-sm">{item.pembimbing}</td>
                  <td className="px-4 py-3">
                    <div className="flex items-center justify-center gap-2">
                      <button onClick={() => handleView(item)} className="p-2 bg-emerald-100 text-emerald-700 rounded-lg hover:bg-emerald-200 transition-all transform hover:scale-110" title="Lihat Detail"><span className="text-lg">üëÅÔ∏è</span></button>
                      <button onClick={() => generatePDF(item)} className="p-2 bg-purple-100 text-purple-700 rounded-lg hover:bg-purple-200 transition-all transform hover:scale-110" title="Print"><span className="text-lg">üñ®Ô∏è</span></button>
                      {canEdit && (<button onClick={() => onEdit(item)} className="p-2 bg-amber-100 text-amber-700 rounded-lg hover:bg-amber-200 transition-all transform hover:scale-110" title="Edit"><span className="text-lg">‚úèÔ∏è</span></button>)}
                      {canDelete && (<button onClick={() => onDelete(item.id, item.judul)} className="p-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-all transform hover:scale-110" title="Hapus"><span className="text-lg">üóëÔ∏è</span></button>)}
                    </div>
                  </td>
                </tr>
              ))}
              {filteredRepository.length === 0 && (
                <tr><td colSpan="7" className="px-4 py-12 text-center text-gray-400">
                  <div className="flex flex-col items-center"><span className="text-6xl mb-4">üìö</span>
                    <p className="text-lg font-medium">Tidak ada skripsi ditemukan</p>
                    <p className="text-sm mt-1">Coba ubah filter pencarian Anda</p>
                  </div>
                </td></tr>
              )}
            </tbody>
          </table>
        </div>
        {filteredRepository.length > 0 && (
          <div className="bg-gray-50 px-4 py-3 border-t text-sm text-gray-600 flex justify-between items-center">
            <span>Menampilkan <strong>{Math.min((currentPage-1)*ITEMS_PER_PAGE+1,filteredRepository.length)}‚Äì{Math.min(currentPage*ITEMS_PER_PAGE,filteredRepository.length)}</strong> dari <strong>{filteredRepository.length}</strong> skripsi</span>
            <span className="text-emerald-600">üìä Halaman {currentPage} dari {totalPages}</span>
          </div>
        )}
      </div>

      <Pagination currentPage={currentPage} totalPages={totalPages} onPageChange={setCurrentPage} />

      {showDetailModal && (
        <DetailModal item={selectedItem} onClose={() => { setShowDetailModal(false); setSelectedItem(null); }} />
      )}
    </div>
    )}

    {/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */}
    {/* TAB 2: REPOSITORY UINSI SAMARINDA      */}
    {/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */}
    {activeTab === 'uinsi' && (
      <UinsiRepositoryTab
        uinsiSearch={uinsiSearch} setUinsiSearch={setUinsiSearch}
        uinsiFilterProdi={uinsiFilterProdi} setUinsiFilterProdi={setUinsiFilterProdi}
        uinsiFilterTahun={uinsiFilterTahun} setUinsiFilterTahun={setUinsiFilterTahun}
        uinsiPage={uinsiPage} setUinsiPage={setUinsiPage}
        selectedUinsiItem={selectedUinsiItem} setSelectedUinsiItem={setSelectedUinsiItem}
        showUinsiDetail={showUinsiDetail} setShowUinsiDetail={setShowUinsiDetail}
        UINSI_PER_PAGE={UINSI_PER_PAGE}
        onDataChange={onUinsiDataChange}
      />
    )}

  </div>
);
};

// ============================================
// KELOLA MAHASISWA PAGE - DENGAN PAGINATION
// ============================================
const KelolaMahasiswaPage = ({ mahasiswa, userRole, onAdd, onEdit, onDelete }) => {
const [currentPage, setCurrentPage] = React.useState(1);
const [searchTerm, setSearchTerm] = React.useState('');
const [filterProdi, setFilterProdi] = React.useState('');
const [filterSemester, setFilterSemester] = React.useState('');
const ITEMS_PER_PAGE = 15;

const calculateSemesterFromNIM = (nim) => {
if (!nim || nim.length < 2) return 1;
const tahunDuaDigit = nim.substring(0, 2);
const angkatan = parseInt(tahunDuaDigit);
if (isNaN(angkatan) || angkatan < 10 || angkatan > 99) return 1;
const currentYear = new Date().getFullYear();
const tahunPenuh = 2000 + angkatan;
const bulanSekarang = new Date().getMonth() + 1;
let semester = (currentYear - tahunPenuh) * 2 + 1;
if (bulanSekarang >= 1 && bulanSekarang <= 6) semester += 1;
return Math.max(1, Math.min(16, semester));
};

const canAdd = userRole === 'admin' || userRole === 'operator';
const canEdit = userRole === 'admin' || userRole === 'operator';
const canDelete = userRole === 'admin';

// Statistik
const totalMhs = mahasiswa.length;
const esCount = mahasiswa.filter(m => m.prodi === 'Ekonomi Syariah').length;
const psCount = mahasiswa.filter(m => m.prodi === 'Perbankan Syariah').length;
const mbsCount = mahasiswa.filter(m => m.prodi === 'Manajemen Bisnis Syariah').length;
const warningCount = mahasiswa.filter(m => calculateSemesterFromNIM(m.nim) >= 11).length;
const avgSemester = mahasiswa.length > 0
  ? Math.round(mahasiswa.reduce((acc, m) => acc + calculateSemesterFromNIM(m.nim), 0) / mahasiswa.length)
  : 0;

// Filter
const filteredMahasiswa = React.useMemo(() => {
let filtered = [...mahasiswa];
if (searchTerm) {
  filtered = filtered.filter(m =>
    m.nim?.toLowerCase().includes(searchTerm.toLowerCase()) ||
    m.nama?.toLowerCase().includes(searchTerm.toLowerCase()) ||
    m.whatsapp?.includes(searchTerm)
  );
}
if (filterProdi) {
  filtered = filtered.filter(m => m.prodi === filterProdi);
}
if (filterSemester === 'normal') {
  filtered = filtered.filter(m => calculateSemesterFromNIM(m.nim) < 11);
} else if (filterSemester === 'warning') {
  filtered = filtered.filter(m => calculateSemesterFromNIM(m.nim) >= 11);
} else if (filterSemester === 'early') {
  filtered = filtered.filter(m => calculateSemesterFromNIM(m.nim) <= 4);
}
return filtered;
}, [mahasiswa, searchTerm, filterProdi, filterSemester]);

React.useEffect(() => { setCurrentPage(1); }, [searchTerm, filterProdi, filterSemester]);

const totalPages = Math.ceil(filteredMahasiswa.length / ITEMS_PER_PAGE);
const paginatedMahasiswa = filteredMahasiswa.slice(
(currentPage - 1) * ITEMS_PER_PAGE,
currentPage * ITEMS_PER_PAGE
);

const resetFilter = () => { setSearchTerm(''); setFilterProdi(''); setFilterSemester(''); };
const isFiltering = searchTerm || filterProdi || filterSemester;

return (
<div className="space-y-6">
{/* Header */}
<div className="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
<div>
<h2 className="text-2xl font-bold text-emerald-900 flex items-center gap-2">
<span>üë•</span> Kelola Mahasiswa
</h2>
<p className="text-sm text-gray-600 mt-1">
Total {filteredMahasiswa.length} mahasiswa {isFiltering && `(dari ${totalMhs} total)`}
</p>
</div>
{canAdd && (
<button onClick={onAdd} className="px-4 py-2 bg-emerald-600 text-white rounded-xl font-semibold hover:bg-emerald-700 transition-all flex items-center gap-2 shadow-lg">
<span>‚ûï</span> Tambah Mahasiswa
</button>
)}
</div>

{/* ‚îÄ‚îÄ Statistik Mahasiswa ‚îÄ‚îÄ */}
<div className="grid grid-cols-2 md:grid-cols-4 gap-4">
{/* Card 1 ‚Äì Total Mahasiswa */}
<div className="relative overflow-hidden bg-gradient-to-br from-emerald-500 to-teal-600 rounded-2xl shadow-lg p-5 text-white">
<div className="absolute -top-4 -right-4 w-20 h-20 bg-white/10 rounded-full"></div>
<div className="absolute -bottom-6 -right-2 w-16 h-16 bg-white/10 rounded-full"></div>
<p className="text-sm font-medium opacity-90 mb-1">üë• Total Mahasiswa</p>
<p className="text-4xl font-black">{totalMhs}</p>
<p className="text-xs opacity-75 mt-1">Terdaftar aktif</p>
<div className="mt-3 h-1.5 bg-white/20 rounded-full overflow-hidden">
<div className="h-full bg-white/60 rounded-full" style={{width:'100%'}}></div>
</div>
</div>
{/* Card 2 ‚Äì Distribusi Prodi */}
<div className="relative overflow-hidden bg-gradient-to-br from-blue-500 to-indigo-600 rounded-2xl shadow-lg p-5 text-white">
<div className="absolute -top-4 -right-4 w-20 h-20 bg-white/10 rounded-full"></div>
<div className="absolute -bottom-6 -right-2 w-16 h-16 bg-white/10 rounded-full"></div>
<p className="text-sm font-medium opacity-90 mb-1">üéì Distribusi Prodi</p>
<p className="text-4xl font-black">{[...new Set(mahasiswa.map(m=>m.prodi).filter(Boolean))].length}<span className="text-lg"> prodi</span></p>
<div className="mt-2 space-y-0.5">
{[['ES', esCount], ['PS', psCount], ['MBS', mbsCount]].map(([abbr, count]) => (
<div key={abbr} className="flex justify-between items-center">
<span className="text-xs opacity-80">{abbr}</span>
<div className="flex items-center gap-1">
<div className="h-1.5 bg-white/20 rounded-full overflow-hidden" style={{width:'50px'}}>
<div className="h-full bg-white/70 rounded-full" style={{width: totalMhs > 0 ? `${Math.round(count/totalMhs*100)}%` : '0%'}}></div>
</div>
<span className="text-xs font-bold">{count}</span>
</div>
</div>
))}
</div>
</div>
{/* Card 3 ‚Äì Rata-rata Semester */}
<div className="relative overflow-hidden bg-gradient-to-br from-purple-500 to-violet-600 rounded-2xl shadow-lg p-5 text-white">
<div className="absolute -top-4 -right-4 w-20 h-20 bg-white/10 rounded-full"></div>
<div className="absolute -bottom-6 -right-2 w-16 h-16 bg-white/10 rounded-full"></div>
<p className="text-sm font-medium opacity-90 mb-1">üìÖ Rata-rata Semester</p>
<p className="text-4xl font-black">{avgSemester}<span className="text-lg"> sem</span></p>
<p className="text-xs opacity-75 mt-1">dari seluruh mahasiswa</p>
<div className="mt-3 h-1.5 bg-white/20 rounded-full overflow-hidden">
<div className="h-full bg-white/60 rounded-full" style={{width:`${Math.min(avgSemester/16*100,100)}%`}}></div>
</div>
</div>
{/* Card 4 ‚Äì Peringatan Semester */}
<div className="relative overflow-hidden bg-gradient-to-br from-amber-400 to-orange-500 rounded-2xl shadow-lg p-5 text-white">
<div className="absolute -top-4 -right-4 w-20 h-20 bg-white/10 rounded-full"></div>
<div className="absolute -bottom-6 -right-2 w-16 h-16 bg-white/10 rounded-full"></div>
<p className="text-sm font-medium opacity-90 mb-1">‚ö†Ô∏è Peringatan Semester</p>
<p className="text-4xl font-black">{warningCount}</p>
<p className="text-xs opacity-75 mt-1">Semester ‚â• 11 (perlu perhatian)</p>
<div className="mt-3 h-1.5 bg-white/20 rounded-full overflow-hidden">
<div className="h-full bg-white/60 rounded-full" style={{width: totalMhs > 0 ? `${Math.round(warningCount/totalMhs*100)}%` : '0%'}}></div>
</div>
</div>
</div>

{/* ‚îÄ‚îÄ Filter & Pencarian ‚îÄ‚îÄ */}
<div className="bg-white rounded-2xl shadow-sm border p-5">
<div className="flex items-center justify-between mb-4">
<h3 className="text-sm font-bold text-gray-700 flex items-center gap-2">
<span className="w-6 h-6 bg-emerald-100 text-emerald-700 rounded-full flex items-center justify-center text-xs">üîç</span>
Filter & Pencarian
</h3>
{isFiltering && (
<button onClick={resetFilter} className="text-xs text-red-500 hover:text-red-700 flex items-center gap-1 px-2 py-1 bg-red-50 rounded-lg hover:bg-red-100 transition-all">
‚úï Reset Filter
</button>
)}
</div>
<div className="grid grid-cols-1 md:grid-cols-3 gap-4">
<div>
<label className="block text-xs font-semibold text-gray-600 mb-1">üîç Cari NIM / Nama / WhatsApp</label>
<input
type="text"
placeholder="Ketik NIM, nama, atau nomor WA..."
value={searchTerm}
onChange={(e) => setSearchTerm(e.target.value)}
className="w-full px-4 py-2.5 border-2 border-gray-200 rounded-xl focus:border-emerald-500 focus:outline-none text-sm transition-colors"
/>
</div>
<div>
<label className="block text-xs font-semibold text-gray-600 mb-1">üéì Program Studi</label>
<select
value={filterProdi}
onChange={(e) => setFilterProdi(e.target.value)}
className="w-full px-4 py-2.5 border-2 border-gray-200 rounded-xl focus:border-emerald-500 focus:outline-none text-sm transition-colors"
>
<option value="">Semua Program Studi</option>
<option value="Ekonomi Syariah">Ekonomi Syariah</option>
<option value="Perbankan Syariah">Perbankan Syariah</option>
<option value="Manajemen Bisnis Syariah">Manajemen Bisnis Syariah</option>
</select>
</div>
<div>
<label className="block text-xs font-semibold text-gray-600 mb-1">üìÖ Filter Semester</label>
<select
value={filterSemester}
onChange={(e) => setFilterSemester(e.target.value)}
className="w-full px-4 py-2.5 border-2 border-gray-200 rounded-xl focus:border-emerald-500 focus:outline-none text-sm transition-colors"
>
<option value="">Semua Semester</option>
<option value="early">Semester Awal (1-4)</option>
<option value="normal">Normal (Sem &lt; 11)</option>
<option value="warning">‚ö†Ô∏è Peringatan (Sem ‚â• 11)</option>
</select>
</div>
</div>
{isFiltering && (
<div className="mt-3 flex flex-wrap gap-2">
{searchTerm && <span className="text-xs bg-emerald-100 text-emerald-700 px-2 py-1 rounded-full">üîç "{searchTerm}"</span>}
{filterProdi && <span className="text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded-full">üéì {filterProdi}</span>}
{filterSemester && <span className="text-xs bg-purple-100 text-purple-700 px-2 py-1 rounded-full">üìÖ {filterSemester === 'warning' ? 'Semester ‚â• 11' : filterSemester === 'early' ? 'Semester 1-4' : 'Normal'}</span>}
<span className="text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded-full">Menampilkan {filteredMahasiswa.length} dari {totalMhs} data</span>
</div>
)}
</div>

{/* ‚îÄ‚îÄ Tabel ‚îÄ‚îÄ */}
<div className="bg-white rounded-2xl shadow-sm border overflow-x-auto">
<table className="w-full min-w-max">
<thead className="bg-gradient-to-r from-emerald-600 to-teal-600 text-white">
<tr>
<th className="px-6 py-3 text-left text-sm font-semibold">No</th>
<th className="px-6 py-3 text-left text-sm font-semibold">NIM</th>
<th className="px-6 py-3 text-left text-sm font-semibold">Nama</th>
<th className="px-6 py-3 text-left text-sm font-semibold">Program Studi</th>
<th className="px-6 py-3 text-left text-sm font-semibold">Semester</th>
<th className="px-6 py-3 text-left text-sm font-semibold">WhatsApp</th>
<th className="px-6 py-3 text-left text-sm font-semibold">Aksi</th>
</tr>
</thead>
<tbody className="divide-y divide-gray-100">
{paginatedMahasiswa.map((m, index) => {
const semesterFromNIM = calculateSemesterFromNIM(m.nim);
const isWarning = semesterFromNIM >= 11;
return (
<tr key={m.id} className={`hover:bg-emerald-50/40 transition-colors ${isWarning ? 'bg-amber-50/30' : ''}`}>
<td className="px-6 py-4 text-sm text-gray-500">
{(currentPage - 1) * ITEMS_PER_PAGE + index + 1}
</td>
<td className="px-6 py-4 font-mono text-sm font-semibold text-gray-700">{m.nim}</td>
<td className="px-6 py-4">
<p className="font-semibold text-gray-900">{m.nama}</p>
</td>
<td className="px-6 py-4">
<span className={`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold ${
m.prodi === 'Ekonomi Syariah' ? 'bg-emerald-100 text-emerald-700' :
m.prodi === 'Perbankan Syariah' ? 'bg-blue-100 text-blue-700' :
'bg-purple-100 text-purple-700'
}`}>
{m.prodi}
</span>
</td>
<td className="px-6 py-4">
<div className="flex items-center gap-2">
<span className={`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-bold ${isWarning ? 'bg-amber-100 text-amber-700 border border-amber-200' : 'bg-emerald-100 text-emerald-700'}`}>
Sem {semesterFromNIM}
{isWarning && <span className="ml-1">‚ö†Ô∏è</span>}
</span>
</div>
</td>
<td className="px-6 py-4 text-sm text-gray-600">
<a href={`https://wa.me/${m.whatsapp}`} target="_blank" className="hover:text-emerald-600 transition-colors flex items-center gap-1">
<span className="text-green-500">üì±</span> {m.whatsapp}
</a>
</td>
<td className="px-6 py-4">
<div className="flex gap-2">
{canEdit && (
<button onClick={() => onEdit(m)} className="px-3 py-1.5 bg-blue-50 text-blue-600 border border-blue-200 rounded-lg hover:bg-blue-100 text-xs font-semibold transition-all">‚úèÔ∏è Edit</button>
)}
{canDelete && (
<button onClick={() => onDelete(m.id, m.nama)} className="px-3 py-1.5 bg-red-50 text-red-600 border border-red-200 rounded-lg hover:bg-red-100 text-xs font-semibold transition-all">üóëÔ∏è Hapus</button>
)}
</div>
</td>
</tr>
);
})}
{filteredMahasiswa.length === 0 && (
<tr>
<td colSpan="7" className="px-6 py-16 text-center text-gray-400">
<p className="text-5xl mb-3">{isFiltering ? 'üîç' : 'üë•'}</p>
<p className="text-base font-semibold">{isFiltering ? 'Tidak ada mahasiswa yang cocok dengan filter' : 'Belum ada data mahasiswa'}</p>
{isFiltering && <button onClick={resetFilter} className="mt-2 text-sm text-emerald-600 hover:underline">Reset filter</button>}
</td>
</tr>
)}
</tbody>
</table>
</div>

{/* Pagination */}
<Pagination
currentPage={currentPage}
totalPages={totalPages}
onPageChange={setCurrentPage}
/>
</div>
);
};

// ============================================
// KELOLA DOSEN PAGE - DENGAN PAGINATION
// ============================================

const KelolaDosenPage = ({ dosen, userRole, onAdd, onEdit, onDelete }) => {
const [currentPage, setCurrentPage] = React.useState(1);
const [searchTerm, setSearchTerm] = React.useState('');
const [filterKeahlian, setFilterKeahlian] = React.useState('');
const ITEMS_PER_PAGE = 15;

const canAdd = userRole === 'admin' || userRole === 'operator';
const canEdit = userRole === 'admin' || userRole === 'operator';
const canDelete = userRole === 'admin';

// Statistik
const totalDosen = dosen.length;
const keahlianList = [...new Set(dosen.map(d => d.keahlian).filter(Boolean))].sort();
const keahlianCount = keahlianList.reduce((acc, k) => {
  acc[k] = dosen.filter(d => d.keahlian === k).length;
  return acc;
}, {});
const topKeahlian = keahlianList.sort((a, b) => (keahlianCount[b]||0) - (keahlianCount[a]||0))[0] || '-';

// Dosen dengan WA
const dosenWithWA = dosen.filter(d => d.whatsapp && d.whatsapp.trim() !== '').length;

// Filter
const filteredDosen = React.useMemo(() => {
let filtered = [...dosen];
if (searchTerm) {
  filtered = filtered.filter(d =>
    d.nip?.toLowerCase().includes(searchTerm.toLowerCase()) ||
    d.nama?.toLowerCase().includes(searchTerm.toLowerCase()) ||
    d.keahlian?.toLowerCase().includes(searchTerm.toLowerCase()) ||
    d.whatsapp?.includes(searchTerm)
  );
}
if (filterKeahlian) {
  filtered = filtered.filter(d => d.keahlian === filterKeahlian);
}
return filtered;
}, [dosen, searchTerm, filterKeahlian]);

React.useEffect(() => { setCurrentPage(1); }, [searchTerm, filterKeahlian]);

const totalPages = Math.ceil(filteredDosen.length / ITEMS_PER_PAGE);
const paginatedDosen = filteredDosen.slice(
(currentPage - 1) * ITEMS_PER_PAGE,
currentPage * ITEMS_PER_PAGE
);

const resetFilter = () => { setSearchTerm(''); setFilterKeahlian(''); };
const isFiltering = searchTerm || filterKeahlian;

// Color palette for keahlian badges
const keahlianColors = [
'bg-emerald-100 text-emerald-700',
'bg-blue-100 text-blue-700',
'bg-purple-100 text-purple-700',
'bg-amber-100 text-amber-700',
'bg-rose-100 text-rose-700',
'bg-teal-100 text-teal-700',
];
const getKeahlianColor = (k) => keahlianColors[keahlianList.indexOf(k) % keahlianColors.length] || 'bg-gray-100 text-gray-700';

return (
<div className="space-y-6">
{/* Header */}
<div className="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
<div>
<h2 className="text-2xl font-bold text-emerald-900 flex items-center gap-2">
<span>üë®‚Äçüè´</span> Kelola Dosen
</h2>
<p className="text-sm text-gray-600 mt-1">
Total {filteredDosen.length} dosen {isFiltering && `(dari ${totalDosen} total)`}
</p>
</div>
{canAdd && (
<button onClick={onAdd} className="px-4 py-2 bg-emerald-600 text-white rounded-xl font-semibold hover:bg-emerald-700 transition-all flex items-center gap-2 shadow-lg">
<span>‚ûï</span> Tambah Dosen
</button>
)}
</div>

{/* ‚îÄ‚îÄ Statistik Dosen ‚îÄ‚îÄ */}
<div className="grid grid-cols-2 md:grid-cols-4 gap-4">
{/* Card 1 ‚Äì Total Dosen */}
<div className="relative overflow-hidden bg-gradient-to-br from-teal-500 to-emerald-600 rounded-2xl shadow-lg p-5 text-white">
<div className="absolute -top-4 -right-4 w-20 h-20 bg-white/10 rounded-full"></div>
<div className="absolute -bottom-6 -right-2 w-16 h-16 bg-white/10 rounded-full"></div>
<p className="text-sm font-medium opacity-90 mb-1">üë®‚Äçüè´ Total Dosen</p>
<p className="text-4xl font-black">{totalDosen}</p>
<p className="text-xs opacity-75 mt-1">Dosen aktif terdaftar</p>
<div className="mt-3 h-1.5 bg-white/20 rounded-full overflow-hidden">
<div className="h-full bg-white/60 rounded-full" style={{width:'100%'}}></div>
</div>
</div>
{/* Card 2 ‚Äì Bidang Keahlian */}
<div className="relative overflow-hidden bg-gradient-to-br from-blue-500 to-cyan-600 rounded-2xl shadow-lg p-5 text-white">
<div className="absolute -top-4 -right-4 w-20 h-20 bg-white/10 rounded-full"></div>
<div className="absolute -bottom-6 -right-2 w-16 h-16 bg-white/10 rounded-full"></div>
<p className="text-sm font-medium opacity-90 mb-1">üî¨ Bidang Keahlian</p>
<p className="text-4xl font-black">{keahlianList.length}<span className="text-lg"> bidang</span></p>
<p className="text-xs opacity-75 mt-1">Terbanyak: <strong>{topKeahlian}</strong></p>
<div className="mt-2 h-1.5 bg-white/20 rounded-full overflow-hidden">
<div className="h-full bg-white/60 rounded-full" style={{width: keahlianList.length > 0 ? '70%' : '0%'}}></div>
</div>
</div>
{/* Card 3 ‚Äì Rasio Mahasiswa/Dosen (estimasi) */}
<div className="relative overflow-hidden bg-gradient-to-br from-purple-500 to-violet-600 rounded-2xl shadow-lg p-5 text-white">
<div className="absolute -top-4 -right-4 w-20 h-20 bg-white/10 rounded-full"></div>
<div className="absolute -bottom-6 -right-2 w-16 h-16 bg-white/10 rounded-full"></div>
<p className="text-sm font-medium opacity-90 mb-1">üìä Distribusi per Bidang</p>
{keahlianList.slice(0, 3).map((k, i) => (
<div key={k} className="flex justify-between items-center mt-1">
<span className="text-xs opacity-80 truncate max-w-[110px]">{k}</span>
<span className="text-xs font-bold bg-white/20 rounded-full px-2 ml-1">{keahlianCount[k]}</span>
</div>
))}
{keahlianList.length > 3 && <p className="text-xs opacity-60 mt-1">+{keahlianList.length - 3} bidang lainnya</p>}
</div>
{/* Card 4 ‚Äì Kontak Tersedia */}
<div className="relative overflow-hidden bg-gradient-to-br from-rose-400 to-pink-500 rounded-2xl shadow-lg p-5 text-white">
<div className="absolute -top-4 -right-4 w-20 h-20 bg-white/10 rounded-full"></div>
<div className="absolute -bottom-6 -right-2 w-16 h-16 bg-white/10 rounded-full"></div>
<p className="text-sm font-medium opacity-90 mb-1">üì± Kontak Tersedia</p>
<p className="text-4xl font-black">{dosenWithWA}</p>
<p className="text-xs opacity-75 mt-1">dari {totalDosen} dosen memiliki WA</p>
<div className="mt-3 h-1.5 bg-white/20 rounded-full overflow-hidden">
<div className="h-full bg-white/60 rounded-full" style={{width: totalDosen > 0 ? `${Math.round(dosenWithWA/totalDosen*100)}%` : '0%'}}></div>
</div>
</div>
</div>

{/* ‚îÄ‚îÄ Filter & Pencarian ‚îÄ‚îÄ */}
<div className="bg-white rounded-2xl shadow-sm border p-5">
<div className="flex items-center justify-between mb-4">
<h3 className="text-sm font-bold text-gray-700 flex items-center gap-2">
<span className="w-6 h-6 bg-teal-100 text-teal-700 rounded-full flex items-center justify-center text-xs">üîç</span>
Filter & Pencarian
</h3>
{isFiltering && (
<button onClick={resetFilter} className="text-xs text-red-500 hover:text-red-700 flex items-center gap-1 px-2 py-1 bg-red-50 rounded-lg hover:bg-red-100 transition-all">
‚úï Reset Filter
</button>
)}
</div>
<div className="grid grid-cols-1 md:grid-cols-2 gap-4">
<div>
<label className="block text-xs font-semibold text-gray-600 mb-1">üîç Cari NIP / Nama / Keahlian</label>
<input
type="text"
placeholder="Ketik NIP, nama dosen, atau bidang keahlian..."
value={searchTerm}
onChange={(e) => setSearchTerm(e.target.value)}
className="w-full px-4 py-2.5 border-2 border-gray-200 rounded-xl focus:border-teal-500 focus:outline-none text-sm transition-colors"
/>
</div>
<div>
<label className="block text-xs font-semibold text-gray-600 mb-1">üî¨ Bidang Keahlian</label>
<select
value={filterKeahlian}
onChange={(e) => setFilterKeahlian(e.target.value)}
className="w-full px-4 py-2.5 border-2 border-gray-200 rounded-xl focus:border-teal-500 focus:outline-none text-sm transition-colors"
>
<option value="">Semua Bidang Keahlian</option>
{keahlianList.map(k => (
<option key={k} value={k}>{k} ({keahlianCount[k]} dosen)</option>
))}
</select>
</div>
</div>
{isFiltering && (
<div className="mt-3 flex flex-wrap gap-2">
{searchTerm && <span className="text-xs bg-teal-100 text-teal-700 px-2 py-1 rounded-full">üîç "{searchTerm}"</span>}
{filterKeahlian && <span className="text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded-full">üî¨ {filterKeahlian}</span>}
<span className="text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded-full">Menampilkan {filteredDosen.length} dari {totalDosen} data</span>
</div>
)}
</div>

{/* ‚îÄ‚îÄ Tabel ‚îÄ‚îÄ */}
<div className="bg-white rounded-2xl shadow-sm border overflow-x-auto">
<table className="w-full min-w-max">
<thead className="bg-gradient-to-r from-teal-600 to-emerald-600 text-white">
<tr>
<th className="px-6 py-3 text-left text-sm font-semibold">No</th>
<th className="px-6 py-3 text-left text-sm font-semibold">NIP</th>
<th className="px-6 py-3 text-left text-sm font-semibold">Nama</th>
<th className="px-6 py-3 text-left text-sm font-semibold">Bidang Keahlian</th>
<th className="px-6 py-3 text-left text-sm font-semibold">WhatsApp</th>
<th className="px-6 py-3 text-left text-sm font-semibold">Aksi</th>
</tr>
</thead>
<tbody className="divide-y divide-gray-100">
{paginatedDosen.map((d, index) => (
<tr key={d.id} className="hover:bg-teal-50/30 transition-colors">
<td className="px-6 py-4 text-sm text-gray-500">
{(currentPage - 1) * ITEMS_PER_PAGE + index + 1}
</td>
<td className="px-6 py-4 font-mono text-xs font-semibold text-gray-600">{d.nip}</td>
<td className="px-6 py-4">
<div className="flex items-center gap-3">
<div className="w-8 h-8 bg-gradient-to-br from-teal-400 to-emerald-500 rounded-full flex items-center justify-center text-white text-xs font-bold flex-shrink-0">
{d.nama?.charAt(0)?.toUpperCase() || '?'}
</div>
<span className="font-semibold text-gray-900">{d.nama}</span>
</div>
</td>
<td className="px-6 py-4">
<span className={`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold ${getKeahlianColor(d.keahlian)}`}>
{d.keahlian}
</span>
</td>
<td className="px-6 py-4 text-sm text-gray-600">
{d.whatsapp ? (
<a href={`https://wa.me/${d.whatsapp}`} target="_blank" className="hover:text-teal-600 transition-colors flex items-center gap-1">
<span className="text-green-500">üì±</span> {d.whatsapp}
</a>
) : (
<span className="text-gray-400 italic text-xs">‚Äî tidak tersedia ‚Äî</span>
)}
</td>
<td className="px-6 py-4">
<div className="flex gap-2">
{canEdit && (
<button onClick={() => onEdit(d)} className="px-3 py-1.5 bg-blue-50 text-blue-600 border border-blue-200 rounded-lg hover:bg-blue-100 text-xs font-semibold transition-all">‚úèÔ∏è Edit</button>
)}
{canDelete && (
<button onClick={() => onDelete(d.id, d.nama)} className="px-3 py-1.5 bg-red-50 text-red-600 border border-red-200 rounded-lg hover:bg-red-100 text-xs font-semibold transition-all">üóëÔ∏è Hapus</button>
)}
</div>
</td>
</tr>
))}
{filteredDosen.length === 0 && (
<tr>
<td colSpan="6" className="px-6 py-16 text-center text-gray-400">
<p className="text-5xl mb-3">{isFiltering ? 'üîç' : 'üë®‚Äçüè´'}</p>
<p className="text-base font-semibold">{isFiltering ? 'Tidak ada dosen yang cocok dengan filter' : 'Belum ada data dosen'}</p>
{isFiltering && <button onClick={resetFilter} className="mt-2 text-sm text-teal-600 hover:underline">Reset filter</button>}
</td>
</tr>
)}
</tbody>
</table>
</div>

{/* Pagination */}
<Pagination
currentPage={currentPage}
totalPages={totalPages}
onPageChange={setCurrentPage}
/>
</div>
);
};

// ============================================
// KELOLA OPERATOR PAGE - DENGAN PAGINATION
// ============================================

const KelolaOperatorPage = ({ operator, userRole, onAdd, onEdit, onDelete }) => {
const [currentPage, setCurrentPage] = React.useState(1);
const ITEMS_PER_PAGE = 15;

const canAdd = userRole === 'admin'; // Only admin can add/edit/delete operator
const canEdit = userRole === 'admin';
const canDelete = userRole === 'admin'; // Only admin can delete

const totalPages = Math.ceil(operator.length / ITEMS_PER_PAGE);
const paginatedOperator = operator.slice(
(currentPage - 1) * ITEMS_PER_PAGE,
currentPage * ITEMS_PER_PAGE
);

return (
<div className="space-y-6">
<div className="flex justify-between items-center">
<h2 className="text-2xl font-bold text-emerald-900">üë§ Kelola Operator</h2>
{canAdd && (
<button onClick={onAdd} className="px-4 py-2 bg-emerald-600 text-white rounded-xl font-semibold hover:bg-emerald-700">
‚ûï Tambah Operator
</button>
)}
</div>
<div className="bg-white rounded-xl shadow-sm border overflow-x-auto">
<table className="w-full min-w-max">
<thead className="bg-emerald-600 text-white">
<tr>
<th className="px-6 py-3 text-left">No</th>
<th className="px-6 py-3 text-left">Username</th>
<th className="px-6 py-3 text-left">Nama</th>
<th className="px-6 py-3 text-left">WhatsApp</th>
<th className="px-6 py-3 text-left">Status</th>
<th className="px-6 py-3 text-left">Aksi</th>
</tr>
</thead>
<tbody>
{paginatedOperator.map((op, index) => (
<tr key={op.id} className="border-b hover:bg-gray-50">
<td className="px-6 py-4 text-sm text-gray-500">
{(currentPage - 1) * ITEMS_PER_PAGE + index + 1}
</td>
<td className="px-6 py-4">{op.username}</td>
<td className="px-6 py-4">{op.nama}</td>
<td className="px-6 py-4">{op.whatsapp || '-'}</td>
<td className="px-6 py-4">
<span className="inline-block px-2 py-1 bg-green-100 text-green-700 rounded text-xs font-semibold">
{op.status || 'aktif'}
</span>
</td>
<td className="px-6 py-4">
{canEdit && (
<button onClick={() => onEdit(op)} className="px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 mr-2">Edit</button>
)}
{canDelete && (
<button onClick={() => onDelete(op.id, op.nama)} className="px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700">Hapus</button>
)}
</td>
</tr>
))}
{operator.length === 0 && (
<tr>
<td colSpan="6" className="px-6 py-12 text-center text-gray-400">
<p className="text-6xl mb-4">üë§</p>
<p className="text-lg">Belum ada data operator</p>
</td>
</tr>
)}
</tbody>
</table>
</div>

{/* Pagination */}
<Pagination 
currentPage={currentPage}
totalPages={totalPages}
onPageChange={setCurrentPage}
/>
</div>
);
};

// ============================================
// SETTINGS PAGE
// ============================================
const SettingsPage = ({ userRole }) => {
return (
<div className="space-y-6">
<h2 className="text-2xl font-bold text-emerald-900">‚öôÔ∏è Pengaturan Sistem</h2>
<div className="bg-white rounded-xl shadow-sm border p-6">
<h3 className="text-lg font-bold text-gray-900 mb-4">Pengaturan Firebase</h3>
<div className="space-y-4">
<div>
<label className="block text-sm font-semibold text-gray-700 mb-2">Database URL</label>
<input type="text" value="https://febi-uinsi-dashboard-ca039-default-rtdb.asia-southeast1.firebasedatabase.app" readOnly className="w-full px-4 py-2 border rounded-lg bg-gray-50" />
</div>
<div>
<label className="block text-sm font-semibold text-gray-700 mb-2">Project ID</label>
<input type="text" value="febi-uinsi-dashboard-ca039" readOnly className="w-full px-4 py-2 border rounded-lg bg-gray-50" />
</div>
<div className="p-4 bg-emerald-50 rounded-lg">
<p className="text-sm text-emerald-700">‚úÖ Database terhubung dan berfungsi normal</p>
</div>
</div>
</div>
<div className="bg-white rounded-xl shadow-sm border p-6">
<h3 className="text-lg font-bold text-gray-900 mb-4">Informasi Sistem</h3>
<div className="space-y-2 text-sm text-gray-600">
<p>‚Ä¢ Versi Dashboard: 8.0.0 (Integrated Repository)</p>
<p>‚Ä¢ Database: Firebase Realtime Database</p>
<p>‚Ä¢ Real-time Sync: Aktif</p>
<p>‚Ä¢ Last Updated: {new Date().toLocaleDateString('id-ID')}</p>
<p>‚Ä¢ Fitur: Advanced Similarity Checker (5 Algoritma), Auto-Create Bimbingan untuk Pembimbing 1 & 2, Early Warning, WhatsApp Integration, Timeline Bimbingan 10 Pertemuan, Edit Profil, Dual Pembimbing</p>
</div>
</div>
</div>
);
};

// ============================================
// MODAL COMPONENT - DIPERBAIKI LENGKAP (TERMASUK OPERATOR)
// ============================================
const Modal = ({ type, item, onSave, onClose, onCheckSimilarity, similarityResult, dosenList, mahasiswaList, currentUser, userRole }) => {
const [formData, setFormData] = React.useState(item || {});
const [isSaving, setIsSaving] = React.useState(false);
const [showPassword, setShowPassword] = React.useState(false);

React.useEffect(() => {
if (item) {
setFormData(item);
} else if (type === 'bimbingan') {
// Bimbingan: mulai kosong agar admin/operator bisa memilih mahasiswa & dosen
setFormData({
nim: '',
mahasiswaNama: '',
prodi: '',
dosenNama: '',
pembimbing1: '',
pembimbing2: '',
pembimbingKe: 1,
judul: '',
progress: 0,
status: 'berlangsung',
catatan: '',
lastUpdate: new Date().toISOString().split('T')[0],
});
} else {
setFormData({
nim: currentUser?.nim || '',
mahasiswaNama: currentUser?.nama || '',
prodi: currentUser?.prodi || '',
whatsapp: currentUser?.whatsapp || ''
});
}
}, [item, type, currentUser]);

const handleSubmit = async (e) => {
e.preventDefault();
// Validasi berdasarkan tipe
if (type === 'mahasiswa' && (!formData.nim || !formData.nama || !formData.prodi || !formData.whatsapp)) {
alert('Harap lengkapi semua field wajib untuk mahasiswa!');
return;
}
if (type === 'dosen' && (!formData.nip || !formData.nama || !formData.keahlian || !formData.whatsapp)) {
alert('Harap lengkapi semua field wajib untuk dosen!');
return;
}
if (type === 'operator' && (!formData.username || !formData.nama)) {
alert('Harap lengkapi semua field wajib untuk operator!');
return;
}
if (type === 'proposals' && (!formData.judul || !formData.mahasiswaNama || !formData.pembimbing1 || !formData.abstrak)) {
alert('Harap lengkapi semua field wajib untuk proposal!');
return;
}
if (type === 'bimbingan') {
const dosenUtama = formData.pembimbing1 || formData.dosenNama;
const nimMhs = formData.nim;
const namaMhs = formData.mahasiswaNama || (mahasiswaList||[]).find(m=>m.nim===formData.nim)?.nama;
if (!nimMhs || !dosenUtama || !formData.judul) {
alert('Harap lengkapi:\n‚Ä¢ Mahasiswa (NIM)\n‚Ä¢ Pembimbing 1\n‚Ä¢ Judul Skripsi');
return;
}
// Auto-fill mahasiswaNama & dosenNama sebelum simpan
if (!formData.mahasiswaNama && namaMhs) formData.mahasiswaNama = namaMhs;
if (!formData.dosenNama) formData.dosenNama = dosenUtama;
}
if (type === 'repository' && (!formData.judul || !formData.penulis || !formData.prodi || !formData.tahun || !formData.abstrak)) {
alert('Harap lengkapi semua field wajib untuk repository!');
return;
}
setIsSaving(true);
try { 
await onSave(type, formData); 
} catch (err) { 
console.error('Save error:', err); 
} finally { 
setIsSaving(false); 
}
};

const renderForm = () => {
switch(type) {
case 'mahasiswa':
return (
<>
<div className="form-section">
<h3 className="text-lg font-bold text-gray-800 mb-3">Data Mahasiswa <span className="required-star">*</span></h3>
<input type="text" placeholder="NIM (masukkan NIM anda secara lengkap)" value={formData.nim || ''} onChange={(e) => setFormData({...formData, nim: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 mb-3" required />
<input type="text" placeholder="Nama Lengkap" value={formData.nama || ''} onChange={(e) => setFormData({...formData, nama: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 mb-3" required />
<select value={formData.prodi || ''} onChange={(e) => setFormData({...formData, prodi: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 mb-3" required>
<option value="">Pilih Program Studi</option>
<option value="Ekonomi Syariah">Ekonomi Syariah</option>
<option value="Perbankan Syariah">Perbankan Syariah</option>
<option value="Manajemen Bisnis Syariah">Manajemen Bisnis Syariah</option>
</select>
<input type="tel" placeholder="Nomor WhatsApp" value={formData.whatsapp || ''} onChange={(e) => setFormData({...formData, whatsapp: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 mb-3" required />
{!item && <input type="password" placeholder="Password" value={formData.password || ''} onChange={(e) => setFormData({...formData, password: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 mb-3" required />}
{item && (
<div className="mb-3">
<label className="block text-sm font-semibold text-gray-700 mb-1">Password</label>
<div className="relative">
<input
type={showPassword ? 'text' : 'password'}
value={formData.password || ''}
onChange={(e) => setFormData({...formData, password: e.target.value})}
className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 pr-10"
placeholder="Kosongkan jika tidak ingin mengubah"
/>
<button
type="button"
onClick={() => setShowPassword(!showPassword)}
className="absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-emerald-600"
>
{showPassword ? 'üëÅÔ∏è' : 'üëÅÔ∏è‚Äçüó®Ô∏è'}
</button>
</div>
<p className="text-xs text-gray-500 mt-1">Kosongkan jika tidak ingin mengubah password</p>
</div>
)}
</div>
<div className="bg-blue-50 p-4 rounded-lg">
<p className="text-sm text-blue-700 flex items-start">
<span className="text-xl mr-2">‚ÑπÔ∏è</span>
<strong>Catatan:</strong> Password hanya diperlukan saat registrasi awal. Untuk edit data, password bisa dikosongkan jika tidak ingin diubah.
</p>
</div>
</>
);
case 'dosen':
return (
<>
<div className="form-section">
<h3 className="text-lg font-bold text-gray-800 mb-3">Data Dosen <span className="required-star">*</span></h3>
<input type="text" placeholder="NIP" value={formData.nip || ''} onChange={(e) => setFormData({...formData, nip: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 mb-3" required />
<input type="text" placeholder="Nama Lengkap" value={formData.nama || ''} onChange={(e) => setFormData({...formData, nama: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 mb-3" required />
<input type="text" placeholder="Bidang Keahlian" value={formData.keahlian || ''} onChange={(e) => setFormData({...formData, keahlian: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 mb-3" required />
<input type="tel" placeholder="Nomor WhatsApp" value={formData.whatsapp || ''} onChange={(e) => setFormData({...formData, whatsapp: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 mb-3" required />
{!item && <input type="password" placeholder="Password" value={formData.password || ''} onChange={(e) => setFormData({...formData, password: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 mb-3" required />}
{item && (
<div className="mb-3">
<label className="block text-sm font-semibold text-gray-700 mb-1">Password</label>
<div className="relative">
<input
type={showPassword ? 'text' : 'password'}
value={formData.password || ''}
onChange={(e) => setFormData({...formData, password: e.target.value})}
className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 pr-10"
placeholder="Kosongkan jika tidak ingin mengubah"
/>
<button
type="button"
onClick={() => setShowPassword(!showPassword)}
className="absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-emerald-600"
>
{showPassword ? 'üëÅÔ∏è' : 'üëÅÔ∏è‚Äçüó®Ô∏è'}
</button>
</div>
<p className="text-xs text-gray-500 mt-1">Kosongkan jika tidak ingin mengubah password</p>
</div>
)}
</div>
<div className="bg-blue-50 p-4 rounded-lg">
<p className="text-sm text-blue-700 flex items-start">
<span className="text-xl mr-2">‚ÑπÔ∏è</span>
<strong>Catatan:</strong> Password hanya diperlukan saat registrasi awal. Untuk edit data, password bisa dikosongkan jika tidak ingin diubah.
</p>
</div>
</>
);
case 'operator':
return (
<>
<div className="form-section">
<h3 className="text-lg font-bold text-gray-800 mb-3">Data Operator <span className="required-star">*</span></h3>
<input type="text" placeholder="Username" value={formData.username || ''} onChange={(e) => setFormData({...formData, username: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 mb-3" required />
<input type="text" placeholder="Nama Lengkap" value={formData.nama || ''} onChange={(e) => setFormData({...formData, nama: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 mb-3" required />
<input type="tel" placeholder="Nomor WhatsApp" value={formData.whatsapp || ''} onChange={(e) => setFormData({...formData, whatsapp: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 mb-3" />
{!item && <input type="password" placeholder="Password" value={formData.password || ''} onChange={(e) => setFormData({...formData, password: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 mb-3" required />}
{item && (
<div className="mb-3">
<label className="block text-sm font-semibold text-gray-700 mb-1">Password</label>
<div className="relative">
<input
type={showPassword ? 'text' : 'password'}
value={formData.password || ''}
onChange={(e) => setFormData({...formData, password: e.target.value})}
className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 pr-10"
placeholder="Kosongkan jika tidak ingin mengubah"
/>
<button
type="button"
onClick={() => setShowPassword(!showPassword)}
className="absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-emerald-600"
>
{showPassword ? 'üëÅÔ∏è' : 'üëÅÔ∏è‚Äçüó®Ô∏è'}
</button>
</div>
<p className="text-xs text-gray-500 mt-1">Kosongkan jika tidak ingin mengubah password</p>
</div>
)}
</div>
<div className="bg-yellow-50 p-4 rounded-lg">
<p className="text-sm text-yellow-700 flex items-start">
<span className="text-xl mr-2">‚ö†Ô∏è</span>
<strong>Catatan:</strong> Operator memiliki akses penuh seperti admin, namun tidak bisa menghapus data.
</p>
</div>
</>
);
case 'proposals':
return (
<>
<div className="form-section">
<h3 className="text-lg font-bold text-gray-800 mb-3">Data Mahasiswa <span className="required-star">*</span></h3>
<input type="text" placeholder="NIM Mahasiswa" value={formData.nim || currentUser?.nim || ''} onChange={(e) => setFormData({...formData, nim: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 mb-3" required readOnly={userRole !== 'admin' && userRole !== 'operator'} />
<input type="text" placeholder="Nama Mahasiswa" value={formData.mahasiswaNama || currentUser?.nama || ''} onChange={(e) => setFormData({...formData, mahasiswaNama: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 mb-3" required readOnly={userRole !== 'admin' && userRole !== 'operator'} />
<select value={formData.prodi || currentUser?.prodi || ''} onChange={(e) => setFormData({...formData, prodi: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 mb-3" required readOnly={userRole !== 'admin' && userRole !== 'operator'}>
<option value="">Pilih Program Studi</option>
<option value="Ekonomi Syariah">Ekonomi Syariah</option>
<option value="Perbankan Syariah">Perbankan Syariah</option>
<option value="Manajemen Bisnis Syariah">Manajemen Bisnis Syariah</option>
</select>
<input type="tel" placeholder="Nomor WhatsApp" value={formData.whatsapp || currentUser?.whatsapp || ''} onChange={(e) => setFormData({...formData, whatsapp: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 mb-3" required readOnly={userRole !== 'admin' && userRole !== 'operator'} />
</div>
<div className="form-section">
<h3 className="text-lg font-bold text-gray-800 mb-3">Pembimbing <span className="required-star">*</span></h3>
<select value={formData.pembimbing1 || ''} onChange={(e) => setFormData({...formData, pembimbing1: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 mb-3" required>
<option value="">Pilih Pembimbing 1</option>
{dosenList.map(d => <option key={d.id} value={d.nama}>{d.nama} - {d.keahlian}</option>)}
</select>
<select value={formData.pembimbing2 || ''} onChange={(e) => setFormData({...formData, pembimbing2: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 mb-3">
<option value="">Pilih Pembimbing 2</option>
<option value="-">Tidak Ada</option>
{dosenList.map(d => <option key={d.id} value={d.nama}>{d.nama} - {d.keahlian}</option>)}
</select>
</div>
<div className="form-section">
<h3 className="text-lg font-bold text-gray-800 mb-3">Judul Proposal <span className="required-star">*</span></h3>
<input type="text" placeholder="Judul Proposal" value={formData.judul || ''} onChange={(e) => setFormData({...formData, judul: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 mb-3" required />
{onCheckSimilarity && (
<div className="mb-3">
<button type="button" onClick={() => onCheckSimilarity(formData.judul)} className="w-full px-4 py-2 bg-gradient-to-r from-blue-600 to-cyan-600 text-white rounded-lg hover:from-blue-700 hover:to-cyan-700 font-semibold transition-all">
üîç Cek Similarity (Advanced 5-Algoritma)
</button>
</div>
)}
{similarityResult && (() => {
// ‚îÄ‚îÄ helper: label risiko ‚îÄ‚îÄ
const getLabelRisiko = (score) => {
if (score >= 85) return { label: 'KRITIS - DITOLAK', warna: '#dc2626', bg: '#fee2e2', border: '#ef4444' };
if (score >= 70) return { label: 'TINGGI - PERLU REVISI BESAR', warna: '#b45309', bg: '#fef3c7', border: '#f59e0b' };
if (score >= 50) return { label: 'SEDANG - PERLU MODIFIKASI', warna: '#854d0e', bg: '#fef9c3', border: '#eab308' };
if (score >= 25) return { label: 'RENDAH - MASIH PERLU PENYESUAIAN', warna: '#065f46', bg: '#dcfce7', border: '#10b981' };
return { label: 'AMAN - LOLOS UJI SIMILARITY', warna: '#042f2e', bg: '#ccfbf1', border: '#14b8a6' };
};
// ‚îÄ‚îÄ fungsi cetak ‚îÄ‚îÄ
const handleCetakSimilarity = () => {
const now = new Date();
const tglCetak = now.toLocaleDateString('id-ID', { day: 'numeric', month: 'long', year: 'numeric' });
const jamCetak = now.toLocaleTimeString('id-ID', { hour: '2-digit', minute: '2-digit' });
const risikoInfo = getLabelRisiko(parseFloat(similarityResult.highestSimilarity));
const printWindow = window.open('', '_blank', 'width=1000,height=800');

// build tabel baris hasil similarity
const buildRows = () => {
if (!similarityResult.results || similarityResult.results.length === 0) {
return '<tr><td colspan="7" style="text-align:center;color:#6b7280;padding:20px;">Tidak ada kemiripan terdeteksi (&lt; ambang batas 25%)</td></tr>';
}
return similarityResult.results.map((r, i) => {
const getRisikoRow = (sc) => {
if (sc >= 85) return { label: 'KRITIS', color: '#dc2626', bg: '#fee2e2' };
if (sc >= 70) return { label: 'TINGGI', color: '#b45309', bg: '#fef3c7' };
if (sc >= 50) return { label: 'SEDANG', color: '#854d0e', bg: '#fef9c3' };
if (sc >= 25) return { label: 'RENDAH', color: '#065f46', bg: '#dcfce7' };
return { label: 'AMAN', color: '#042f2e', bg: '#ccfbf1' };
};
const ri = getRisikoRow(r.similarityScore);
const sumber = r.sourceLabel || (r.type === 'proposal' ? 'Proposal' : r.isFromUinsi ? 'Repository UINSI' : 'Repository Lokal');
const details = r.similarityDetails || {};
const cosine = details.cosine !== undefined ? details.cosine + '%' : '-';
const jaccard = details.jaccardBigram !== undefined ? details.jaccardBigram + '%' : '-';
const leven = details.levenshtein !== undefined ? details.levenshtein + '%' : '-';
const semantic = details.semantic !== undefined ? details.semantic + '%' : '-';
return `
<tr>
<td style="text-align:center;font-weight:600;color:#374151">${i + 1}</td>
<td style="font-size:11px;line-height:1.5;padding:8px 6px">${r.title || '-'}</td>
<td style="font-size:11px;color:#4b5563">${r.author || '-'}<br><span style="color:#6b7280;font-size:10px">${r.prodi || ''}</span></td>
<td style="text-align:center;font-size:11px;color:#374151">${r.tahun || '-'}</td>
<td style="text-align:center;font-size:11px;color:#6b7280">${sumber}</td>
<td style="text-align:center">
<span style="font-size:14px;font-weight:800;color:${ri.color}">${r.similarityScore}%</span>
<div style="font-size:9px;margin-top:2px;color:#9ca3af">Cos:${cosine} Jac:${jaccard}<br>Lev:${leven} Sem:${semantic}</div>
</td>
<td style="text-align:center">
<span style="background:${ri.bg};color:${ri.color};border:1.5px solid ${ri.color};padding:3px 8px;border-radius:12px;font-size:10px;font-weight:700">${ri.label}</span>
</td>
</tr>
`;
}).join('');
};

// build algoritma detail section
const buildAlgoDetail = () => {
if (!similarityResult.results || !similarityResult.results[0]) return '';
const d = similarityResult.results[0].similarityDetails || {};
const algoRows = [
{ name: 'Cosine Similarity', key: 'cosine', bobot: '30%', desc: 'Kesamaan vektor kata berbobot TF' },
{ name: 'Jaccard Bigram', key: 'jaccardBigram', bobot: '25%', desc: 'Irisan pasangan kata 2-gram' },
{ name: 'Jaccard Trigram', key: 'jaccardTrigram', bobot: '20%', desc: 'Irisan pasangan kata 3-gram' },
{ name: 'Levenshtein', key: 'levenshtein', bobot: '15%', desc: 'Jarak edit karakter string' },
{ name: 'Semantic Match', key: 'semantic', bobot: '10%', desc: 'Pencocokan semantik kata kunci berbobot' },
];
return algoRows.map(a => {
const val = d[a.key] !== undefined ? parseFloat(d[a.key]) : null;
const bar = val !== null ? Math.round(val) : 0;
const barColor = bar >= 50 ? '#dc2626' : bar >= 25 ? '#f59e0b' : '#10b981';
return `
<tr>
<td style="font-weight:600;font-size:11px;padding:7px 8px">${a.name}</td>
<td style="font-size:10px;color:#6b7280;padding:7px 8px">${a.desc}</td>
<td style="text-align:center;font-size:10px;color:#374151;padding:7px 8px">${a.bobot}</td>
<td style="padding:7px 8px">
<div style="display:flex;align-items:center;gap:6px">
<div style="flex:1;height:10px;background:#e5e7eb;border-radius:5px;overflow:hidden">
<div style="width:${bar}%;height:100%;background:${barColor};border-radius:5px"></div>
</div>
<span style="font-size:11px;font-weight:700;color:${barColor};min-width:35px">${val !== null ? val + '%' : '-'}</span>
</div>
</td>
</tr>
`;
}).join('');
};

// determine status color
const statusBg = risikoInfo.bg;
const statusBorder = risikoInfo.border;
const statusColor = risikoInfo.warna;

printWindow.document.write(`<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Hasil Uji Similarity - ${formData.mahasiswaNama || formData.nim || 'Mahasiswa'}</title>
<style>
  * { margin:0; padding:0; box-sizing:border-box; }
  body { font-family:'Times New Roman', serif; background:#fff; color:#1f2937; }
  .print-btn { position:fixed; top:16px; right:16px; z-index:9999; display:flex; gap:8px; }
  .print-btn button { padding:8px 18px; border:none; border-radius:8px; font-size:13px; font-weight:600; cursor:pointer; font-family:Arial,sans-serif; }
  .btn-print { background:#047857; color:#fff; }
  .btn-print:hover { background:#065f46; }
  .btn-close { background:#6b7280; color:#fff; }
  .btn-close:hover { background:#374151; }
  .page { max-width:820px; margin:0 auto; padding:20px 30px 40px; }

  /* ‚îÄ‚îÄ KOP ‚îÄ‚îÄ */
  .kop { display:flex; align-items:center; gap:20px; padding-bottom:12px; border-bottom:4px double #047857; margin-bottom:18px; }
  .kop-logo { width:72px; height:72px; background:linear-gradient(135deg,#047857,#065f46); border-radius:14px; display:flex; align-items:center; justify-content:center; font-size:36px; flex-shrink:0; }
  .kop-text { flex:1; }
  .kop-text h1 { font-size:16px; font-weight:700; color:#047857; letter-spacing:0.5px; margin-bottom:2px; }
  .kop-text h2 { font-size:13px; font-weight:600; color:#065f46; margin-bottom:2px; }
  .kop-text h3 { font-size:12px; color:#374151; }
  .kop-text p { font-size:10px; color:#6b7280; margin-top:3px; border-top:1px solid #d1fae5; padding-top:3px; }
  .doc-title { text-align:center; margin:14px 0; }
  .doc-title h2 { font-size:15px; font-weight:700; text-transform:uppercase; letter-spacing:1px; color:#047857; }
  .doc-title .no-doc { font-size:10px; color:#6b7280; margin-top:3px; }

  /* ‚îÄ‚îÄ IDENTITAS ‚îÄ‚îÄ */
  .section { margin-bottom:14px; }
  .section-title { font-size:12px; font-weight:700; text-transform:uppercase; color:#047857; background:#f0fdf4; padding:5px 10px; border-left:4px solid #047857; margin-bottom:8px; letter-spacing:0.5px; }
  .id-table { width:100%; border-collapse:collapse; font-size:11.5px; }
  .id-table td { padding:5px 8px; vertical-align:top; }
  .id-table td:first-child { width:160px; font-weight:600; color:#374151; }
  .id-table td:nth-child(2) { width:10px; color:#374151; }
  .id-table tr:nth-child(even) { background:#f9fafb; }

  /* ‚îÄ‚îÄ VERDICT BADGE ‚îÄ‚îÄ */
  .verdict-box { border:2px solid ${statusBorder}; background:${statusBg}; border-radius:10px; padding:12px 16px; margin-bottom:14px; display:flex; align-items:center; gap:16px; }
  .verdict-score { font-size:42px; font-weight:900; color:${statusColor}; line-height:1; }
  .verdict-score span { font-size:18px; }
  .verdict-info h3 { font-size:14px; font-weight:700; color:${statusColor}; margin-bottom:4px; }
  .verdict-info p { font-size:11px; color:#374151; line-height:1.5; }
  .verdict-info .rekomendasi { margin-top:5px; font-size:11px; color:#1f2937; background:rgba(255,255,255,0.7); padding:4px 8px; border-radius:6px; }

  /* ‚îÄ‚îÄ HASIL TABLE ‚îÄ‚îÄ */
  table.hasil { width:100%; border-collapse:collapse; font-size:11px; margin-top:6px; }
  table.hasil th { background:#047857; color:#fff; padding:7px 6px; text-align:center; font-size:10.5px; font-weight:600; }
  table.hasil td { padding:7px 6px; border-bottom:1px solid #e5e7eb; vertical-align:top; }
  table.hasil tr:nth-child(even) { background:#f9fafb; }
  table.hasil tr:hover { background:#f0fdf4; }
  table.hasil td:first-child { text-align:center; }

  /* ‚îÄ‚îÄ ALGO TABLE ‚îÄ‚îÄ */
  table.algo { width:100%; border-collapse:collapse; font-size:11px; margin-top:6px; }
  table.algo th { background:#1e40af; color:#fff; padding:7px 8px; text-align:left; font-size:10.5px; font-weight:600; }
  table.algo td { padding:6px 8px; border-bottom:1px solid #e5e7eb; vertical-align:middle; }
  table.algo tr:nth-child(even) { background:#f8fafc; }

  /* ‚îÄ‚îÄ BATAS TOLERANSI ‚îÄ‚îÄ */
  .tolerance-bar { margin:10px 0; }
  .tol-label { font-size:10px; color:#6b7280; margin-bottom:4px; display:flex; justify-content:space-between; }
  .tol-track { height:18px; background:#e5e7eb; border-radius:9px; overflow:hidden; position:relative; }
  .tol-fill { height:100%; border-radius:9px; display:flex; align-items:center; justify-content:flex-end; padding-right:6px; font-size:10px; font-weight:700; color:#fff; transition:width 0.3s; }
  .tol-limit { position:absolute; top:0; bottom:0; left:25%; width:2px; background:#dc2626; }
  .tol-limit-label { position:absolute; top:-14px; left:24%; font-size:9px; color:#dc2626; font-weight:600; }

  /* ‚îÄ‚îÄ KETERANGAN ‚îÄ‚îÄ */
  .keterangan-box { background:#fffbeb; border:1px solid #fbbf24; border-radius:8px; padding:10px 12px; margin-bottom:14px; }
  .keterangan-box h4 { font-size:11px; font-weight:700; color:#92400e; margin-bottom:5px; }
  .keterangan-box ul { margin-left:16px; }
  .keterangan-box li { font-size:10.5px; color:#374151; margin-bottom:2px; }

  /* ‚îÄ‚îÄ FOOTER TTD ‚îÄ‚îÄ */
  .footer-wrap { display:flex; justify-content:space-between; align-items:flex-end; margin-top:20px; padding-top:14px; border-top:1px solid #d1d5db; }
  .footer-left { font-size:10px; color:#6b7280; line-height:1.7; max-width:60%; }
  .ttd-box { text-align:center; min-width:210px; }
  .ttd-place-date { font-size:11px; color:#374151; font-weight:600; margin-bottom:6px; }
  .ttd-title { font-size:10.5px; color:#374151; font-weight:600; margin-bottom:3px; }
  .ttd-name-wrap { margin-top:60px; text-align:center; }
  .ttd-line { border-top:1.5px solid #374151; width:190px; margin:0 auto; padding-top:4px; }
  .ttd-unit { font-size:11px; font-weight:700; color:#047857; }
  .ttd-instansi { font-size:10px; color:#374151; }

  /* ‚îÄ‚îÄ CAP ‚îÄ‚îÄ */
  .watermark-safe { position:fixed; top:50%; left:50%; transform:translate(-50%,-50%) rotate(-30deg); font-size:80px; font-weight:900; color:rgba(16,185,129,0.06); pointer-events:none; z-index:0; white-space:nowrap; }

  @media print {
    .print-btn { display:none; }
    body { -webkit-print-color-adjust:exact; print-color-adjust:exact; }
    .page { padding:10px 20px; }
    .watermark-safe { position:fixed; }
  }
</style>
</head>
<body>
<div class="watermark-safe">FEBI UINSI SAMARINDA</div>

<div class="print-btn no-print">
  <button class="btn-print" onclick="window.print()">üñ®Ô∏è Cetak</button>
  <button class="btn-close" onclick="window.close()">‚úï Tutup</button>
</div>

<div class="page">

  <!-- KOP SURAT -->
  <div class="kop">
    <div class="kop-logo">üéì</div>
    <div class="kop-text">
      <h1>HASIL UJI SIMILARITY JUDUL SKRIPSI</h1>
      <h2>FAKULTAS EKONOMI DAN BISNIS ISLAM (FEBI)</h2>
      <h3>UNIVERSITAS ISLAM NEGERI SULTAN IDU SAMARINDA</h3>
      <p>Jl. H.A.M. Rifadin, Samarinda Seberang, Kota Samarinda, Kalimantan Timur 75131 &nbsp;|&nbsp; febi.uinsi.ac.id</p>
    </div>
  </div>

  <div class="doc-title">
    <h2>Laporan Hasil Uji Kemiripan Judul Skripsi</h2>
    <div class="no-doc">No. Dok: FEBI-SIM-${now.getFullYear()}-${String(now.getMonth()+1).padStart(2,'0')}${String(now.getDate()).padStart(2,'0')}-${String(Math.floor(Math.random()*9000)+1000)}</div>
  </div>

  <!-- IDENTITAS MAHASISWA -->
  <div class="section">
    <div class="section-title">A. Identitas Mahasiswa</div>
    <table class="id-table">
      <tr><td>Nama Mahasiswa</td><td>:</td><td><strong>${formData.mahasiswaNama || currentUser?.nama || '-'}</strong></td></tr>
      <tr><td>NIM</td><td>:</td><td>${formData.nim || currentUser?.nim || '-'}</td></tr>
      <tr><td>Program Studi</td><td>:</td><td>${formData.prodi || currentUser?.prodi || '-'}</td></tr>
      <tr><td>Nomor WhatsApp</td><td>:</td><td>${formData.whatsapp || currentUser?.whatsapp || '-'}</td></tr>
      <tr><td>Dosen Pembimbing 1</td><td>:</td><td>${formData.pembimbing1 || '-'}</td></tr>
      <tr><td>Dosen Pembimbing 2</td><td>:</td><td>${formData.pembimbing2 && formData.pembimbing2 !== '-' ? formData.pembimbing2 : '-'}</td></tr>
      <tr><td>Tanggal Pengajuan</td><td>:</td><td>${now.toLocaleDateString('id-ID',{weekday:'long',day:'numeric',month:'long',year:'numeric'})}</td></tr>
    </table>
  </div>

  <!-- JUDUL PROPOSAL -->
  <div class="section">
    <div class="section-title">B. Judul Proposal yang Diajukan</div>
    <div style="background:#f0fdf4;border:1px solid #d1fae5;border-radius:8px;padding:10px 14px;font-size:12px;font-weight:600;color:#065f46;line-height:1.6">
      "${formData.judul || '-'}"
    </div>
  </div>

  <!-- VERDICT UTAMA -->
  <div class="section">
    <div class="section-title">C. Hasil Uji Similarity (Skor Keseluruhan)</div>
    <div class="verdict-box">
      <div>
        <div class="verdict-score">${similarityResult.highestSimilarity}<span>%</span></div>
        <div style="font-size:10px;color:${statusColor};margin-top:3px;text-align:center">Skor Tertinggi</div>
      </div>
      <div class="verdict-info" style="flex:1">
        <h3>STATUS: ${risikoInfo.label}</h3>
        <p>Batas toleransi maksimal similarity: <strong>25%</strong> &nbsp;|&nbsp; Total judul yang dibandingkan: <strong>${similarityResult.totalMatches || 0} judul terdeteksi mirip</strong></p>
        <div class="rekomendasi">üí° ${similarityResult.recommendation || 'Tidak ada rekomendasi'}</div>
      </div>
    </div>

    <!-- Progress Bar Batas Toleransi -->
    <div class="tolerance-bar">
      <div class="tol-label">
        <span>0%</span>
        <span style="color:#dc2626;font-weight:600">‚¨Ü Batas Maks 25%</span>
        <span>50%</span>
        <span>75%</span>
        <span>100%</span>
      </div>
      <div class="tol-track">
        <div class="tol-fill" style="width:${Math.min(similarityResult.highestSimilarity,100)}%;background:${statusColor}">
          ${similarityResult.highestSimilarity}%
        </div>
        <div class="tol-limit"></div>
        <div class="tol-limit-label">25%</div>
      </div>
    </div>
  </div>

  <!-- TABEL DETAIL HASIL -->
  <div class="section">
    <div class="section-title">D. Tabel Detail Hasil Perbandingan Judul</div>
    <table class="hasil">
      <thead>
        <tr>
          <th style="width:30px">No</th>
          <th style="width:30%">Judul yang Mirip</th>
          <th style="width:18%">Penulis / Prodi</th>
          <th style="width:6%">Tahun</th>
          <th style="width:14%">Sumber</th>
          <th style="width:15%">Skor Similarity</th>
          <th style="width:13%">Peringkat Risiko</th>
        </tr>
      </thead>
      <tbody>
        ${buildRows()}
      </tbody>
    </table>
    ${(!similarityResult.results || similarityResult.results.length === 0) ? `
    <div style="text-align:center;padding:12px;background:#f0fdf4;border-radius:8px;margin-top:8px">
      <span style="font-size:24px">‚úÖ</span>
      <p style="font-size:12px;color:#047857;font-weight:600;margin-top:4px">Judul Lolos Uji Similarity ‚Äî Tidak ada kemiripan signifikan terdeteksi</p>
    </div>` : ''}
  </div>

  <!-- DETAIL ALGORITMA -->
  ${similarityResult.results && similarityResult.results[0] ? `
  <div class="section">
    <div class="section-title">E. Rincian Skor per Algoritma (Judul Paling Mirip)</div>
    <p style="font-size:10.5px;color:#4b5563;margin-bottom:6px">
      Judul pembanding: <em>"${(similarityResult.results[0] && similarityResult.results[0].title) || '-'}"</em>
    </p>
    <table class="algo">
      <thead>
        <tr>
          <th style="width:22%">Algoritma</th>
          <th style="width:32%">Deskripsi</th>
          <th style="width:10%">Bobot</th>
          <th>Visualisasi & Skor</th>
        </tr>
      </thead>
      <tbody>
        ${buildAlgoDetail()}
      </tbody>
    </table>
    <p style="font-size:10px;color:#6b7280;margin-top:5px">
      * Skor akhir = rata-rata berbobot dari 5 algoritma di atas. Bobot mencerminkan kontribusi tiap algoritma terhadap skor final.
    </p>
  </div>
  ` : ''}

  <!-- KETERANGAN SKALA PENILAIAN -->
  <div class="section">
    <div class="section-title">F. Keterangan Skala Penilaian Similarity</div>
    <table style="width:100%;border-collapse:collapse;font-size:10.5px">
      <thead>
        <tr>
          <th style="background:#374151;color:#fff;padding:6px 8px;text-align:center;width:12%">Rentang Skor</th>
          <th style="background:#374151;color:#fff;padding:6px 8px;text-align:center;width:20%">Peringkat Risiko</th>
          <th style="background:#374151;color:#fff;padding:6px 8px;text-align:left">Interpretasi & Tindakan</th>
          <th style="background:#374151;color:#fff;padding:6px 8px;text-align:center;width:12%">Status</th>
        </tr>
      </thead>
      <tbody>
        <tr style="background:#fef2f2">
          <td style="text-align:center;font-weight:700;color:#dc2626;padding:6px 8px">‚â• 85%</td>
          <td style="text-align:center;padding:6px 8px"><span style="background:#fee2e2;color:#dc2626;border:1.5px solid #ef4444;padding:2px 8px;border-radius:10px;font-size:10px;font-weight:700">KRITIS</span></td>
          <td style="padding:6px 8px;font-size:10px;color:#374151">Judul sangat mirip dengan karya yang sudah ada. Wajib melakukan reformulasi total terhadap variabel, objek, dan pendekatan penelitian.</td>
          <td style="text-align:center;font-weight:700;color:#dc2626;padding:6px 8px">DITOLAK</td>
        </tr>
        <tr style="background:#fffbeb">
          <td style="text-align:center;font-weight:700;color:#b45309;padding:6px 8px">70% ‚Äì 84%</td>
          <td style="text-align:center;padding:6px 8px"><span style="background:#fef3c7;color:#b45309;border:1.5px solid #f59e0b;padding:2px 8px;border-radius:10px;font-size:10px;font-weight:700">TINGGI</span></td>
          <td style="padding:6px 8px;font-size:10px;color:#374151">Kemiripan signifikan. Diperlukan modifikasi besar pada variabel penelitian, lokasi/objek studi, dan kerangka teori yang digunakan.</td>
          <td style="text-align:center;font-weight:700;color:#b45309;padding:6px 8px">REVISI BESAR</td>
        </tr>
        <tr style="background:#fefce8">
          <td style="text-align:center;font-weight:700;color:#854d0e;padding:6px 8px">50% ‚Äì 69%</td>
          <td style="text-align:center;padding:6px 8px"><span style="background:#fef9c3;color:#854d0e;border:1.5px solid #eab308;padding:2px 8px;border-radius:10px;font-size:10px;font-weight:700">SEDANG</span></td>
          <td style="padding:6px 8px;font-size:10px;color:#374151">Terdapat kemiripan frasa kunci. Disarankan modifikasi pada judul dengan memperjelas fokus, variabel, atau konteks penelitian.</td>
          <td style="text-align:center;font-weight:700;color:#854d0e;padding:6px 8px">REVISI</td>
        </tr>
        <tr style="background:#f0fdf4">
          <td style="text-align:center;font-weight:700;color:#065f46;padding:6px 8px">25% ‚Äì 49%</td>
          <td style="text-align:center;padding:6px 8px"><span style="background:#dcfce7;color:#065f46;border:1.5px solid #10b981;padding:2px 8px;border-radius:10px;font-size:10px;font-weight:700">RENDAH</span></td>
          <td style="padding:6px 8px;font-size:10px;color:#374151">Kemiripan masih terdeteksi namun dalam batas wajar. Dapat dipertimbangkan untuk diterima dengan penyesuaian minor.</td>
          <td style="text-align:center;font-weight:700;color:#065f46;padding:6px 8px">PERLU CEK</td>
        </tr>
        <tr style="background:#f0fdfa">
          <td style="text-align:center;font-weight:700;color:#0f766e;padding:6px 8px">&lt; 25%</td>
          <td style="text-align:center;padding:6px 8px"><span style="background:#ccfbf1;color:#0f766e;border:1.5px solid #14b8a6;padding:2px 8px;border-radius:10px;font-size:10px;font-weight:700">AMAN</span></td>
          <td style="padding:6px 8px;font-size:10px;color:#374151">Judul lolos uji similarity. Tingkat kemiripan di bawah ambang batas toleransi 25% yang ditetapkan FEBI UINSI Samarinda.</td>
          <td style="text-align:center;font-weight:700;color:#0f766e;padding:6px 8px">LOLOS</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- FOOTER: Tempat+Tanggal & TTD -->
  <div class="footer-wrap">
    <div class="footer-left">
      <strong>Keterangan:</strong><br>
      Laporan ini digenerate secara otomatis oleh Sistem Informasi Bimbingan Skripsi FEBI UINSI Samarinda.<br>
      Basis data pembanding mencakup repository lokal FEBI, repository UINSI Samarinda, dan proposal yang telah diajukan.<br>
      Dokumen ini sah sebagai bukti uji kemiripan judul skripsi di lingkungan FEBI UINSI Samarinda.<br>
      Dicetak pada: ${tglCetak}, pukul ${jamCetak} WITA
    </div>
    <div class="ttd-box">
      <div class="ttd-place-date">Samarinda, ${tglCetak}</div>
      <div class="ttd-title">Tika Parlina, M.M.</div>
      <div class="ttd-name-wrap">
        <div class="ttd-line">
          <div class="ttd-unit">Unit Penjaminan Mutu</div>
          <div class="ttd-instansi">FEBI UINSI Samarinda</div>
        </div>
      </div>
    </div>
  </div>

</div>
</body>
</html>`);
printWindow.document.close();
setTimeout(() => printWindow.focus(), 300);
};

return (
<div className={`p-4 rounded-xl mb-3 border-2 ${
similarityResult.status === 'Ditolak' ? 'bg-red-50 border-red-300' :
similarityResult.status === 'Diperbaiki' ? 'bg-yellow-50 border-yellow-300' :
'bg-green-50 border-green-300'
}`}>
<div className="mb-3">
<p className="font-bold text-sm mb-1">üìä Hasil Analisis Similarity:</p>
<p className="text-3xl font-black text-emerald-900">{similarityResult.highestSimilarity}%</p>
<p className={`similarity-badge ${
similarityResult.highestSimilarity >= 85 ? 'similarity-critical' :
similarityResult.highestSimilarity >= 70 ? 'similarity-high' :
similarityResult.highestSimilarity >= 50 ? 'similarity-medium' :
similarityResult.highestSimilarity >= 30 ? 'similarity-low' :
'similarity-safe'
}`}>
{similarityResult.status.toUpperCase()}
</p>
</div>
{similarityResult.results[0] && (
<div className="mb-3">
<h4 className="font-bold text-xs text-gray-600 mb-2">üîç Detail Metrik Similarity:</h4>
<div className="grid grid-cols-2 gap-2 text-xs">
<div className="metric-card bg-white p-2 rounded-lg">
<span className="algorithm-badge algo-cosine">Cosine</span>
<p className="text-lg font-bold text-blue-600">{similarityResult.results[0].similarityDetails.cosine}%</p>
</div>
<div className="metric-card bg-white p-2 rounded-lg">
<span className="algorithm-badge algo-jaccard">Jaccard Bi</span>
<p className="text-lg font-bold text-green-600">{similarityResult.results[0].similarityDetails.jaccardBigram}%</p>
</div>
<div className="metric-card bg-white p-2 rounded-lg">
<span className="algorithm-badge algo-jaccard">Jaccard Tri</span>
<p className="text-lg font-bold text-emerald-600">{similarityResult.results[0].similarityDetails.jaccardTrigram}%</p>
</div>
<div className="metric-card bg-white p-2 rounded-lg">
<span className="algorithm-badge algo-levenshtein">Levenshtein</span>
<p className="text-lg font-bold text-amber-600">{similarityResult.results[0].similarityDetails.levenshtein}%</p>
</div>
</div>
</div>
)}
<div className="mb-3 p-3 bg-blue-50 rounded-lg">
<p className="text-sm font-semibold text-blue-800">üí° Rekomendasi:</p>
<p className="text-sm text-blue-700">{similarityResult.recommendation}</p>
</div>
{similarityResult.results.length > 0 && (
<div className="mt-3">
<p className="font-semibold text-sm mb-2">üìã Judul yang Terdeteksi Mirip:</p>
{similarityResult.results.slice(0, 2).map((item, idx) => {
const highlight = similarityChecker.highlightMatchingTerms(formData.judul, item.title);
return (
<div key={idx} className="bg-white p-3 rounded-lg mb-2 border border-gray-200">
<p className="text-xs font-medium text-gray-600 mb-1">
{item.sourceLabel || (item.type === 'proposal' ? 'üìù Proposal' : item.isFromUinsi ? 'üåê Repository UINSI' : 'üèõÔ∏è Repository Lokal')} ‚Ä¢ {item.tahun}
</p>
<div dangerouslySetInnerHTML={{ __html: highlight.new }} className="text-sm font-semibold mb-1" />
<p className="text-xs text-gray-600">{item.author} ‚Ä¢ {item.prodi}</p>
<div className="mt-2 flex justify-between items-center">
<span className={`similarity-badge ${
item.similarityScore >= 85 ? 'similarity-critical' :
item.similarityScore >= 70 ? 'similarity-high' :
item.similarityScore >= 50 ? 'similarity-medium' :
item.similarityScore >= 30 ? 'similarity-low' :
'similarity-safe'
}`}>
{item.similarityScore}%
</span>
</div>
</div>
);
})}
</div>
)}
{/* ‚îÄ‚îÄ TOMBOL CETAK ‚îÄ‚îÄ */}
<div className="mt-4 pt-3 border-t border-gray-200">
<button
type="button"
onClick={handleCetakSimilarity}
className="w-full flex items-center justify-center gap-2 px-4 py-3 bg-gradient-to-r from-emerald-700 to-teal-700 text-white rounded-xl font-bold text-sm hover:from-emerald-800 hover:to-teal-800 transition-all shadow-md hover:shadow-lg transform hover:scale-[1.01]"
>
<span className="text-lg">üñ®Ô∏è</span>
Cetak Hasil Similarity
<span className="text-xs opacity-80 ml-1">(Laporan Resmi FEBI UINSI)</span>
</button>
</div>
</div>
);
})()}
</div>

<div className="form-section">
<h3 className="text-lg font-bold text-gray-800 mb-3">Abstrak <span className="required-star">*</span></h3>
<textarea placeholder="Abstrak (min. 150 karakter)" value={formData.abstrak || ''} onChange={(e) => setFormData({...formData, abstrak: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 mb-3 h-32" required minLength="150" />
</div>
{(userRole === 'admin' || userRole === 'operator') && (
<div className="form-section">
<h3 className="text-lg font-bold text-gray-800 mb-3">Validasi Admin/Operator</h3>
<select value={formData.status || 'Menunggu'} onChange={(e) => setFormData({...formData, status: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 mb-3">
<option value="Menunggu">Menunggu</option>
<option value="Diterima">Diterima</option>
<option value="Diperbaiki">Diperbaiki</option>
<option value="Ditolak">Ditolak</option>
</select>
<textarea placeholder="Catatan Validasi" value={formData.catatan || ''} onChange={(e) => setFormData({...formData, catatan: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 mb-3 h-24" />
</div>
)}
</>
);
case 'bimbingan':
return (
<>
{/* ‚îÄ‚îÄ SEKSI 1: Data Mahasiswa ‚îÄ‚îÄ */}
<div className="form-section">
<h3 className="text-lg font-bold text-gray-800 mb-3 flex items-center gap-2">
<span className="w-6 h-6 bg-emerald-100 text-emerald-700 rounded-full flex items-center justify-center text-xs font-black">1</span>
Data Mahasiswa <span className="required-star">*</span>
</h3>
{(userRole === 'admin' || userRole === 'operator') ? (
<>
<label className="text-xs font-semibold text-gray-500 mb-1 block">Pilih Mahasiswa</label>
<select
value={formData.nim || ''}
onChange={(e) => {
const selectedMhs = mahasiswaList.find(m => m.nim === e.target.value);
setFormData({
...formData,
nim: e.target.value,
mahasiswaNama: selectedMhs ? selectedMhs.nama : formData.mahasiswaNama,
prodi: selectedMhs ? selectedMhs.prodi : formData.prodi,
});
}}
className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 focus:outline-none mb-2"
required>
<option value="">‚Äî Pilih Mahasiswa ‚Äî</option>
{(mahasiswaList || []).map(m => (
<option key={m.id || m.nim} value={m.nim}>{m.nim} ‚Äî {m.nama} ({m.prodi})</option>
))}
</select>
<div className="grid grid-cols-2 gap-2 mb-0">
<div>
<label className="text-xs font-semibold text-gray-500 mb-1 block">NIM</label>
<input type="text" readOnly value={formData.nim || ''} className="w-full px-3 py-2 bg-gray-50 border-2 border-gray-200 rounded-lg text-sm text-gray-600 cursor-not-allowed" placeholder="Otomatis terisi"/>
</div>
<div>
<label className="text-xs font-semibold text-gray-500 mb-1 block">Program Studi</label>
<input type="text" readOnly value={formData.prodi || ''} className="w-full px-3 py-2 bg-gray-50 border-2 border-gray-200 rounded-lg text-sm text-gray-600 cursor-not-allowed" placeholder="Otomatis terisi"/>
</div>
</div>
</>
) : (
<>
<label className="text-xs font-semibold text-gray-500 mb-1 block">NIM Mahasiswa</label>
<input type="text" readOnly value={formData.nim || currentUser?.nim || ''} className="w-full px-4 py-2 bg-gray-50 border-2 border-gray-200 rounded-lg focus:border-emerald-500 mb-2 text-gray-600 cursor-not-allowed" />
<label className="text-xs font-semibold text-gray-500 mb-1 block">Nama Mahasiswa</label>
<input type="text" readOnly value={formData.mahasiswaNama || currentUser?.nama || ''} className="w-full px-4 py-2 bg-gray-50 border-2 border-gray-200 rounded-lg focus:border-emerald-500 mb-2 text-gray-600 cursor-not-allowed" />
</>
)}
</div>

{/* ‚îÄ‚îÄ SEKSI 2: Dosen Pembimbing ‚îÄ‚îÄ */}
<div className="form-section">
<h3 className="text-lg font-bold text-gray-800 mb-3 flex items-center gap-2">
<span className="w-6 h-6 bg-blue-100 text-blue-700 rounded-full flex items-center justify-center text-xs font-black">2</span>
Dosen Pembimbing <span className="required-star">*</span>
</h3>

{/* Pembimbing 1 */}
<label className="text-xs font-semibold text-gray-600 mb-1 block">
<span className="inline-flex items-center gap-1">
<span className="w-4 h-4 bg-emerald-500 text-white rounded-full text-[10px] flex items-center justify-center font-black">1</span>
Pembimbing 1 <span className="text-red-500">*</span>
</span>
</label>
<select
value={formData.pembimbing1 || formData.dosenNama || ''}
onChange={(e) => {
const val = e.target.value;
setFormData({
...formData,
pembimbing1: val,
dosenNama: formData.pembimbingKe === 2 ? formData.dosenNama : val,
});
}}
className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 focus:outline-none mb-3"
required>
<option value="">‚Äî Pilih Pembimbing 1 ‚Äî</option>
{(dosenList || []).map(d => (
<option key={d.id || d.nip} value={d.nama}>{d.nama} ‚Äî {d.keahlian}</option>
))}
</select>

{/* Pembimbing 2 */}
<label className="text-xs font-semibold text-gray-600 mb-1 block">
<span className="inline-flex items-center gap-1">
<span className="w-4 h-4 bg-blue-400 text-white rounded-full text-[10px] flex items-center justify-center font-black">2</span>
Pembimbing 2 <span className="text-gray-400 font-normal">(opsional)</span>
</span>
</label>
<select
value={formData.pembimbing2 || ''}
onChange={(e) => {
const val = e.target.value;
setFormData({
...formData,
pembimbing2: val,
});
}}
className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 focus:outline-none mb-3">
<option value="">‚Äî Tidak Ada Pembimbing 2 ‚Äî</option>
{(dosenList || []).filter(d => d.nama !== (formData.pembimbing1 || formData.dosenNama)).map(d => (
<option key={d.id || d.nip} value={d.nama}>{d.nama} ‚Äî {d.keahlian}</option>
))}
</select>

{/* Sebagai Pembimbing Ke */}
<label className="text-xs font-semibold text-gray-600 mb-1 block">Posisi / Urutan Pembimbing pada Record Ini</label>
<div className="grid grid-cols-2 gap-2 mb-1">
<button
type="button"
onClick={() => setFormData({...formData, pembimbingKe: 1, dosenNama: formData.pembimbing1 || formData.dosenNama || ''})}
className={`flex items-center justify-center gap-2 px-4 py-2.5 rounded-xl border-2 text-sm font-semibold transition-all ${(formData.pembimbingKe || 1) === 1 ? 'bg-emerald-600 text-white border-emerald-600 shadow-md' : 'bg-white text-gray-600 border-gray-200 hover:border-emerald-300'}`}>
<span className="w-5 h-5 rounded-full border-2 border-current flex items-center justify-center text-[10px] font-black">1</span>
Pembimbing 1
</button>
<button
type="button"
onClick={() => setFormData({...formData, pembimbingKe: 2, dosenNama: formData.pembimbing2 || ''})}
className={`flex items-center justify-center gap-2 px-4 py-2.5 rounded-xl border-2 text-sm font-semibold transition-all ${(formData.pembimbingKe || 1) === 2 ? 'bg-blue-600 text-white border-blue-600 shadow-md' : 'bg-white text-gray-600 border-gray-200 hover:border-blue-300'}`}>
<span className="w-5 h-5 rounded-full border-2 border-current flex items-center justify-center text-[10px] font-black">2</span>
Pembimbing 2
</button>
</div>
<p className="text-[11px] text-gray-400 mt-1">Record bimbingan ini akan tercatat atas nama <strong className="text-gray-600">{(formData.pembimbingKe || 1) === 1 ? (formData.pembimbing1 || formData.dosenNama || '‚Äî') : (formData.pembimbing2 || '‚Äî')}</strong> sebagai Pembimbing {formData.pembimbingKe || 1}.</p>
</div>

{/* ‚îÄ‚îÄ SEKSI 3: Judul Skripsi ‚îÄ‚îÄ */}
<div className="form-section">
<h3 className="text-lg font-bold text-gray-800 mb-3 flex items-center gap-2">
<span className="w-6 h-6 bg-violet-100 text-violet-700 rounded-full flex items-center justify-center text-xs font-black">3</span>
Judul Skripsi <span className="required-star">*</span>
</h3>
<textarea
placeholder="Masukkan judul skripsi mahasiswa..."
value={formData.judul || ''}
onChange={(e) => setFormData({...formData, judul: e.target.value})}
className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 focus:outline-none mb-1 h-20 resize-none"
required />
<p className="text-[11px] text-gray-400">Tulis judul lengkap sesuai proposal yang sudah disetujui.</p>
</div>

{/* ‚îÄ‚îÄ SEKSI 4: Progress & Status ‚îÄ‚îÄ */}
<div className="form-section">
<h3 className="text-lg font-bold text-gray-800 mb-3 flex items-center gap-2">
<span className="w-6 h-6 bg-amber-100 text-amber-700 rounded-full flex items-center justify-center text-xs font-black">4</span>
Progress &amp; Status Bimbingan <span className="required-star">*</span>
</h3>
<div className="flex items-center gap-3 mb-2">
<label className="text-xs font-semibold text-gray-600 whitespace-nowrap">Progress Saat Ini</label>
<input type="range" min="0" max="100" step="5"
value={formData.progress || 0}
onChange={(e) => setFormData({...formData, progress: parseInt(e.target.value)})}
className="flex-1 accent-emerald-600" />
<span className="text-base font-black text-emerald-600 w-12 text-right">{formData.progress || 0}%</span>
</div>
<div className="w-full bg-gray-200 rounded-full h-3 overflow-hidden mb-3">
<div className="bg-gradient-to-r from-emerald-500 to-teal-500 h-3 rounded-full transition-all duration-300" style={{width: `${formData.progress || 0}%`}}></div>
</div>
<div className="grid grid-cols-2 gap-3">
<div>
<label className="text-xs font-semibold text-gray-600 mb-1 block">Status Bimbingan</label>
<select value={formData.status || 'berlangsung'} onChange={(e) => setFormData({...formData, status: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 focus:outline-none">
<option value="berlangsung">üü¢ Berlangsung</option>
<option value="selesai">üîµ Selesai</option>
</select>
</div>
<div>
<label className="text-xs font-semibold text-gray-600 mb-1 block">Tanggal Update</label>
<input type="date" value={formData.lastUpdate || new Date().toISOString().split('T')[0]} onChange={(e) => setFormData({...formData, lastUpdate: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 focus:outline-none" />
</div>
</div>
</div>

{/* ‚îÄ‚îÄ SEKSI 5: Catatan ‚îÄ‚îÄ */}
<div className="form-section">
<h3 className="text-lg font-bold text-gray-800 mb-3 flex items-center gap-2">
<span className="w-6 h-6 bg-gray-100 text-gray-600 rounded-full flex items-center justify-center text-xs font-black">5</span>
Catatan Bimbingan <span className="text-gray-400 text-xs font-normal">(opsional)</span>
</h3>
<textarea placeholder="Catatan perkembangan, instruksi, atau keterangan lainnya..." value={formData.catatan || ''} onChange={(e) => setFormData({...formData, catatan: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 focus:outline-none mb-1 h-24 resize-none" />
<p className="text-[11px] text-gray-400">Catatan ini hanya terlihat oleh admin, operator, dan dosen pembimbing.</p>
</div>
</>
);
case 'repository':
return (
<>
<div className="form-section">
<h3 className="text-lg font-bold text-gray-800 mb-3">Data Penulis <span className="required-star">*</span></h3>
<input type="text" placeholder="NIM Penulis" value={formData.nim || ''} onChange={(e) => setFormData({...formData, nim: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 mb-3" required />
<input type="text" placeholder="Nama Penulis" value={formData.penulis || ''} onChange={(e) => setFormData({...formData, penulis: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 mb-3" required />
<select value={formData.prodi || ''} onChange={(e) => setFormData({...formData, prodi: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 mb-3" required>
<option value="">Pilih Program Studi</option>
<option value="Ekonomi Syariah">Ekonomi Syariah</option>
<option value="Perbankan Syariah">Perbankan Syariah</option>
<option value="Manajemen Bisnis Syariah">Manajemen Bisnis Syariah</option>
</select>
</div>
<div className="form-section">
<h3 className="text-lg font-bold text-gray-800 mb-3">Judul Skripsi <span className="required-star">*</span></h3>
<input type="text" placeholder="Judul Skripsi" value={formData.judul || ''} onChange={(e) => setFormData({...formData, judul: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 mb-3" required />
</div>
<div className="form-section">
<h3 className="text-lg font-bold text-gray-800 mb-3">Abstrak <span className="required-star">*</span></h3>
<textarea placeholder="Abstrak" value={formData.abstrak || ''} onChange={(e) => setFormData({...formData, abstrak: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 mb-3 h-32" required />
</div>
<div className="form-section">
<h3 className="text-lg font-bold text-gray-800 mb-3">Informasi Tambahan <span className="required-star">*</span></h3>
<input type="number" placeholder="Tahun" value={formData.tahun || new Date().getFullYear()} onChange={(e) => setFormData({...formData, tahun: parseInt(e.target.value)})} className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 mb-3" min="2000" max="2100" required />
<input type="text" placeholder="Nama Pembimbing" value={formData.pembimbing || ''} onChange={(e) => setFormData({...formData, pembimbing: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 mb-3" required />
<input type="url" placeholder="URL File Upload (Google Drive)" value={formData.fileUrl || ''} onChange={(e) => setFormData({...formData, fileUrl: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-emerald-500 mb-3" />
</div>
</>
);
default:
return (
<div className="text-center py-8 text-gray-500">
<p className="text-lg font-medium">Form untuk tipe "{type}" tidak ditemukan</p>
<p className="mt-2">Silakan hubungi administrator sistem</p>
</div>
);
}
};
return (
<div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4" onClick={onClose}>
<div className="bg-white rounded-2xl p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto" onClick={(e) => e.stopPropagation()}>
<h2 className="text-2xl font-bold text-emerald-900 mb-4 flex items-center">
{item ? '‚úèÔ∏è Edit Data' : '‚ûï Tambah Data Baru'}
<span className="ml-3 px-3 py-1 bg-emerald-100 text-emerald-700 rounded-full text-sm font-medium">
{type === 'mahasiswa' ? 'Mahasiswa' : 
 type === 'dosen' ? 'Dosen' : 
 type === 'operator' ? 'Operator' : 
 type === 'proposals' ? 'Proposal' : 
 type === 'bimbingan' ? 'Bimbingan' : 
 type === 'repository' ? 'Repository' : type}
</span>
</h2>
<form onSubmit={handleSubmit}>
{renderForm()}
<div className="flex gap-3 mt-6 pt-6 border-t border-gray-200">
<button type="submit" disabled={isSaving} className="flex-1 px-6 py-3 bg-emerald-600 text-white rounded-xl font-semibold hover:bg-emerald-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all">
{isSaving ? (
<div className="flex items-center justify-center">
<div className="w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"></div>
Menyimpan...
</div>
) : 'üíæ Simpan Data'}
</button>
<button type="button" onClick={onClose} disabled={isSaving} className="px-6 py-3 bg-gray-200 text-gray-700 rounded-xl font-semibold hover:bg-gray-300 disabled:opacity-50 transition-all">
Batal
</button>
</div>
</form>
</div>
</div>
);
};

// ============================================
// MAIN APP COMPONENT - DENGAN WORKFLOW INTEGRATION
// ============================================
const App = () => {
const [currentUser, setCurrentUser] = React.useState(null);
const [userRole, setUserRole] = React.useState(null);
const [showAuthModal, setShowAuthModal] = React.useState(false);
const [activeMenu, setActiveMenu] = React.useState('dashboard');
const [sidebarOpen, setSidebarOpen] = React.useState(false);
const [mahasiswa, setMahasiswa] = React.useState({});
const [dosen, setDosen] = React.useState({});
const [proposals, setProposals] = React.useState({});
const [bimbingan, setBimbingan] = React.useState({});
const [repository, setRepository] = React.useState({});
const [operator, setOperator] = React.useState({});
const [kalenderAkademik, setKalenderAkademik] = React.useState(null); // null = belum load dari Firebase
// State data UINSI repository (seed 170 + live dari Firebase cache / OAI-PMH)
const [uinsiRepository, setUinsiRepository] = React.useState(UINSI_REPOSITORY_DATA);
const [toast, setToast] = React.useState({ show: false, msg: '', type: 'info' });
const [showModal, setShowModal] = React.useState(false);
const [modalType, setModalType] = React.useState('');
const [editingItem, setEditingItem] = React.useState(null);
const [similarityResult, setSimilarityResult] = React.useState(null);
const [systemReady, setSystemReady] = React.useState(false);
const [initError, setInitError] = React.useState(null);
const [loadingProgress, setLoadingProgress] = React.useState(0);
const [dataInitialized, setDataInitialized] = React.useState(false);
const [showProfileModal, setShowProfileModal] = React.useState(false);
const [showProfileMenu, setShowProfileMenu] = React.useState(false);

// Load user from localStorage dengan progress simulation
React.useEffect(() => {
// Simulasi progress loading
const progressInterval = setInterval(() => {
setLoadingProgress(prev => {
if (prev >= 100) {
clearInterval(progressInterval);
return 100;
}
return prev + 10;
});
}, 150);

const loadData = async () => {
try {
const savedUser = localStorage.getItem('currentUser');
if (savedUser) {
try {
const user = JSON.parse(savedUser);
setCurrentUser(user);
setUserRole(user.role);
} catch (e) {
console.error('Error parsing user data:', e);
localStorage.removeItem('currentUser');
setShowAuthModal(true);
}
} else {
setShowAuthModal(true);
}

// Cek koneksi Firebase
if (!db) {
setInitError('Gagal terhubung ke Firebase. Periksa koneksi internet Anda.');
} else {
// Test koneksi dengan membaca root
await db.ref().once('value');
console.log('‚úÖ Firebase connection test successful');
}

setSystemReady(true);
} catch (error) {
console.error('Initialization error:', error);
setInitError('Gagal menginisialisasi sistem: ' + error.message);
} finally {
clearInterval(progressInterval);
setLoadingProgress(100);
}
};

loadData();

return () => clearInterval(progressInterval);
}, []);

// Initialize with dummy data if Firebase is empty
React.useEffect(() => {
if (!currentUser || !db || dataInitialized) return;

const initializeData = async () => {
try {
// Cek apakah data sudah ada
const proposalsSnapshot = await DB.get('proposals');
const dosenSnapshot = await DB.get('dosen');
const mahasiswaSnapshot = await DB.get('mahasiswa');
const bimbinganSnapshot = await DB.get('bimbingan');
const operatorSnapshot = await DB.get('operator');
const repositorySnapshot = await DB.get('repository');

// Jika data kosong, isi dengan dummy data
if (!proposalsSnapshot || Object.keys(proposalsSnapshot).length === 0) {
console.log('üìù Mengisi data proposal dummy...');
for (const proposal of dummyProposals) {
await DB.push('proposals', proposal);
}
}

if (!dosenSnapshot || Object.keys(dosenSnapshot).length === 0) {
console.log('üë®‚Äçüè´ Mengisi data dosen dummy...');
for (const d of dummyDosen) {
await DB.push('dosen', d);
}
}

if (!mahasiswaSnapshot || Object.keys(mahasiswaSnapshot).length === 0) {
console.log('üë• Mengisi data mahasiswa dummy...');
for (const m of dummyMahasiswa) {
await DB.push('mahasiswa', m);
}
}

if (!bimbinganSnapshot || Object.keys(bimbinganSnapshot).length === 0) {
console.log('üìã Mengisi data bimbingan dummy...');
for (const b of dummyBimbingan) {
await DB.push('bimbingan', b);
}
}

if (!operatorSnapshot || Object.keys(operatorSnapshot).length === 0) {
console.log('üë§ Mengisi data operator dummy...');
for (const op of dummyOperator) {
await DB.push('operator', op);
}
}

if (!repositorySnapshot || Object.keys(repositorySnapshot).length === 0) {
console.log('üìö Mengisi data repository dummy...');
for (const repo of dummyRepository) {
await DB.push('repository', repo);
}
}

setDataInitialized(true);
console.log('‚úÖ Data dummy berhasil diinisialisasi');
} catch (error) {
console.error('Error initializing dummy data:', error);
}
};

initializeData();
}, [currentUser, dataInitialized]);

// Real-time data listeners
React.useEffect(() => {
if (!currentUser || !db) return;
const unsub1 = DB.listen('mahasiswa', (data) => setMahasiswa(data || {}));
const unsub2 = DB.listen('dosen', (data) => setDosen(data || {}));
const unsub3 = DB.listen('proposals', (data) => setProposals(data || {}));
const unsub4 = DB.listen('bimbingan', (data) => setBimbingan(data || {}));
const unsub5 = DB.listen('repository', (data) => setRepository(data || {}));
const unsub6 = DB.listen('operator', (data) => setOperator(data || {}));
const unsub7 = DB.listen('kalender_akademik', (data) => setKalenderAkademik(data || null));
return () => { unsub1(); unsub2(); unsub3(); unsub4(); unsub5(); unsub6(); unsub7(); };
}, [currentUser]);

// Auto-load UINSI repository cache dari Firebase saat login
// Sehingga cek similarity langsung pakai data lengkap tanpa perlu klik manual
React.useEffect(() => {
if (!currentUser || !db) return;
const loadUinsiCache = async () => {
try {
const cache = await DB.get('uinsi_repository_cache');
if (cache && cache.data && Array.isArray(cache.data) && cache.data.length > UINSI_REPOSITORY_DATA.length) {
// Merge dengan seed data + deduplikasi
const seen = new Map();
const norm = (s) => (s||'').toLowerCase().replace(/\s+/g,' ').trim().substring(0,80);
UINSI_REPOSITORY_DATA.forEach(d => seen.set(norm(d.judul), d));
cache.data.forEach(d => { const k = norm(d.judul); if (!seen.has(k)) seen.set(k, d); });
const merged = Array.from(seen.values());
setUinsiRepository(merged);
console.log(`‚úÖ UINSI cache loaded: ${merged.length} skripsi ‚Üí siap untuk cek similarity`);
}
} catch(e) { console.log('UINSI cache auto-load:', e.message); }
};
loadUinsiCache();
}, [currentUser]);

// Convert objects to arrays
const mahasiswaArr = React.useMemo(() => Object.entries(mahasiswa).map(([id, data]) => ({ id, ...data })), [mahasiswa]);
const dosenArr = React.useMemo(() => Object.entries(dosen).map(([id, data]) => ({ id, ...data })), [dosen]);
const proposalsArr = React.useMemo(() => Object.entries(proposals).map(([id, data]) => ({ id, ...data })), [proposals]);
const bimbinganArr = React.useMemo(() => Object.entries(bimbingan).map(([id, data]) => ({ id, ...data })), [bimbingan]);
const repositoryArr = React.useMemo(() => Object.entries(repository).map(([id, data]) => ({ id, ...data })), [repository]);
const operatorArr = React.useMemo(() => Object.entries(operator).map(([id, data]) => ({ id, ...data })), [operator]);

// Debug log untuk memantau data
React.useEffect(() => {
console.log('üìä Data saat ini:');
console.log('- Mahasiswa:', mahasiswaArr.length);
console.log('- Dosen:', dosenArr.length);
console.log('- Proposals:', proposalsArr.length);
console.log('- Bimbingan:', bimbinganArr.length);
console.log('- Repository:', repositoryArr.length);
console.log('- Operator:', operatorArr.length);
console.log('- User Role:', userRole);
}, [mahasiswaArr, dosenArr, proposalsArr, bimbinganArr, repositoryArr, operatorArr, userRole]);

// Filter: Proposal approved tapi belum ada di bimbingan (untuk kedua pembimbing)
const pendingBimbingan = React.useMemo(() =>
proposalsArr.filter(p => {
if (p.status !== 'Diterima') return false;
const hasBimbingan1 = bimbinganArr.some(b => b.nim === p.nim && b.judul === p.judul && b.dosenNama === p.pembimbing1);
const hasBimbingan2 = !p.pembimbing2 || p.pembimbing2 === '-' || bimbinganArr.some(b => b.nim === p.nim && b.judul === p.judul && b.dosenNama === p.pembimbing2);
return !hasBimbingan1 || !hasBimbingan2;
}), [proposalsArr, bimbinganArr]
);

const showToast = (msg, type = 'success') => {
setToast({ show: true, msg, type });
setTimeout(() => setToast({ show: false, msg: '', type: 'info' }), 3000);
};

const handleLogin = (user, role) => {
setCurrentUser(user);
setUserRole(role);
localStorage.setItem('currentUser', JSON.stringify(user));
setShowAuthModal(false);
showToast(`Selamat datang, ${user.nama}!`);
};

const handleLogout = () => {
if (confirm('Yakin ingin keluar?')) {
setCurrentUser(null);
setUserRole(null);
localStorage.removeItem('currentUser');
setShowAuthModal(true);
setActiveMenu('dashboard');
}
};

const handleAdd = (type) => {
setModalType(type);
setEditingItem(null);
setSimilarityResult(null);
setShowModal(true);
};

const handleEdit = (type, item) => {
setModalType(type);
setEditingItem(item);
setSimilarityResult(null);
setShowModal(true);
};

const handleDelete = async (type, id, name) => {
// Operator tidak bisa hapus, tapi pengecekan sudah dilakukan di tombol
if (userRole === 'operator' && type !== 'proposals') { // Operator hanya bisa edit, tidak hapus
showToast('Operator tidak memiliki izin hapus!', 'error');
return;
}
if (!confirm(`Hapus "${name}"?`)) return;
try {
const success = await DB.remove(`${type}/${id}`);
showToast(success ? 'Data berhasil dihapus!' : 'Gagal menghapus data!', success ? 'success' : 'error');
} catch (err) {
console.error('Delete error:', err);
showToast('Error: ' + err.message, 'error');
}
};

// CRITICAL: Save dengan auto-create bimbingan untuk kedua pembimbing
const handleSave = async (type, data) => {
if (!data) {
showToast('Data tidak valid!', 'error');
return false;
}
try {
if (editingItem) {
// Jika status berubah menjadi "Diterima"
if (type === 'proposals' && data.status === 'Diterima' && editingItem.status !== 'Diterima') {
const success = await DB.set(`proposals/${editingItem.id}`, {
...data, updatedAt: new Date().toISOString()
});
if (success) {
// Trigger auto-create bimbingan untuk kedua pembimbing
await createBimbinganFromProposal(data, editingItem.id);
alert('‚úÖ Proposal disetujui!\n\nSistem otomatis membuat record bimbingan untuk:\n‚Ä¢ Pembimbing 1: ' + data.pembimbing1 + '\n' + (data.pembimbing2 && data.pembimbing2 !== '-' ? '‚Ä¢ Pembimbing 2: ' + data.pembimbing2 + '\n' : '') + '\nDosen pembimbing dapat langsung memulai proses bimbingan.');
setShowModal(false);
return true;
}
} else {
// Hapus password jika kosong (tidak diubah)
if (data.password === '') {
delete data.password;
}
const result = await DB.set(`${type}/${editingItem.id}`, { ...data, updatedAt: new Date().toISOString() });
if (result) showToast('Data berhasil diupdate!', 'success');
else showToast('Gagal mengupdate data!', 'error');
setShowModal(false);
return result;
}
} else {
const defaultFields = {};
if (type === 'proposals' && !data.status) defaultFields.status = 'Menunggu';
if (type === 'proposals' && !data.tahun) defaultFields.tahun = new Date().getFullYear().toString();
if (type === 'proposals' && !data.tanggalPengajuan) defaultFields.tanggalPengajuan = new Date().toISOString().split('T')[0];
if (type === 'bimbingan') {
// Pastikan dosenNama terisi dari pembimbing1 atau pembimbing2 sesuai pembimbingKe
const ke = data.pembimbingKe || 1;
if (ke === 1 && data.pembimbing1 && !data.dosenNama) defaultFields.dosenNama = data.pembimbing1;
if (ke === 2 && data.pembimbing2 && !data.dosenNama) defaultFields.dosenNama = data.pembimbing2;
if (!data.dosenNama && !defaultFields.dosenNama) defaultFields.dosenNama = data.pembimbing1 || '';
// Pastikan mahasiswaNama terisi
if (!data.mahasiswaNama && data.nim) {
const mhs = (mahasiswaArr || []).find(m => m.nim === data.nim);
if (mhs) defaultFields.mahasiswaNama = mhs.nama;
}
if (!data.lastUpdate) defaultFields.lastUpdate = new Date().toISOString().split('T')[0];
if (!data.progress && data.progress !== 0) defaultFields.progress = 0;
if (!data.status) defaultFields.status = 'berlangsung';
if (!data.pembimbingKe) defaultFields.pembimbingKe = 1;
}
const newId = await DB.push(type, { ...defaultFields, ...data, createdAt: new Date().toISOString() });
if (newId) showToast('Data berhasil ditambahkan!', 'success');
else showToast('Gagal menambahkan data!', 'error');
setShowModal(false);
return !!newId;
}
} catch (err) {
console.error('Save error:', err);
showToast('Error: ' + (err.message || 'Terjadi kesalahan tidak diketahui'), 'error');
setShowModal(false);
return false;
} finally {
setEditingItem(null);
setSimilarityResult(null);
}
};

// Handle save profile
const handleSaveKalender = async (data) => {
try {
const ok = await DB.set('kalender_akademik', { ...data, updatedAt: new Date().toISOString(), updatedBy: currentUser?.nama || 'Admin' });
if (ok) showToast('Kalender Akademik berhasil disimpan! ‚úÖ', 'success');
else showToast('Gagal menyimpan kalender!', 'error');
return ok;
} catch (err) {
console.error('Kalender save error:', err);
showToast('Error menyimpan kalender: ' + err.message, 'error');
return false;
}
};

const handleSaveProfile = async (updatedUser) => {
try {
// Hapus password jika kosong (tidak diubah)
if (updatedUser.password === '') {
delete updatedUser.password;
}

// Tentukan path berdasarkan role
let path = '';
if (userRole === 'mahasiswa') path = `mahasiswa/${currentUser.id}`;
else if (userRole === 'dosen') path = `dosen/${currentUser.id}`;
else if (userRole === 'operator') path = `operator/${currentUser.id}`;
else if (userRole === 'admin') path = `admin/${currentUser.id}`;

if (path) {
await DB.set(path, { ...updatedUser, updatedAt: new Date().toISOString() });
// Update current user
const newUser = { ...currentUser, ...updatedUser };
setCurrentUser(newUser);
localStorage.setItem('currentUser', JSON.stringify(newUser));
showToast('Profil berhasil diperbarui!', 'success');
setShowProfileModal(false);
}
} catch (err) {
console.error('Profile update error:', err);
showToast('Gagal memperbarui profil: ' + err.message, 'error');
}
};

const handleCheckSimilarity = async (judul) => {
if (!judul?.trim()) {
showToast('Masukkan judul proposal terlebih dahulu!', 'error');
return;
}
if (judul.trim().length < 15) {
showToast('Judul terlalu pendek! Minimal 15 karakter untuk analisis akurat.', 'error');
return;
}
try {
// ‚îÄ‚îÄ Gabungkan repository lokal (Firebase) + repository UINSI (cache/seed) ‚îÄ‚îÄ
// untuk cek similarity yang komprehensif
const combinedRepo = { ...repository };
uinsiRepository.forEach((item, idx) => {
const key = `uinsi_${item.id || idx}`;
combinedRepo[key] = {
judul: item.judul,
penulis: item.penulis,
prodi: item.prodi || '',
tahun: item.tahun || '',
pembimbing: item.pembimbing || '-',
abstrak: item.abstrak || '',
_sourceType: 'uinsi',
_sourceUrl: item.url || ''
};
});
const totalSources = proposalsArr ? proposalsArr.length : 0;
const totalRepo = Object.keys(combinedRepo).length;
const result = checkProposalSimilarityAdvanced(judul, proposals, combinedRepo);
// Tandai hasil mana yang dari UINSI
result.results = (result.results || []).map(r => ({
...r,
isFromUinsi: r.id && r.id.toString().startsWith('uinsi_'),
sourceLabel: (r.id && r.id.toString().startsWith('uinsi_')) ? 'üåê Repository UINSI' : (r.type === 'proposal' ? 'üìù Proposal' : 'üèõÔ∏è Repository Lokal')
}));
setSimilarityResult(result);
showToast(`Similarity check selesai! (${result.highestSimilarity}%) ‚Äî ${totalRepo} skripsi + ${totalSources} proposal dicek`, 'success');
} catch (err) {
console.error('Similarity check error:', err);
showToast('Error saat cek similarity: ' + err.message, 'error');
}
};

const sendWhatsAppWarning = (whatsapp, message) => {
if (!whatsapp || !message) {
showToast('Data WhatsApp tidak lengkap!', 'error');
return;
}
const cleanWA = whatsapp.replace(/\D/g, '');
if (cleanWA.length < 10) {
showToast('Nomor WhatsApp tidak valid!', 'error');
return;
}
const url = `https://wa.me/62${cleanWA.replace(/^0+/, '')}?text=${encodeURIComponent(message)}`;
window.open(url, '_blank');
showToast('Pesan WhatsApp terbuka di tab baru!', 'success');
};

// Mulai bimbingan manual (untuk dosen) - dengan parameter pembimbingKe
const handleMulaiBimbingan = async (proposal, pembimbingKe = 1) => {
if (!currentUser || userRole !== 'dosen') {
showToast('Hanya dosen yang dapat memulai bimbingan', 'error');
return;
}

const dosenNama = pembimbingKe === 1 ? proposal.pembimbing1 : proposal.pembimbing2;

// Validasi apakah dosen ini adalah pembimbing yang sesuai
if (currentUser.nama !== dosenNama) {
showToast('Anda bukan pembimbing untuk proposal ini!', 'error');
return;
}

// Cek duplikasi
const exists = bimbinganArr.some(b => 
b.nim === proposal.nim && 
b.judul === proposal.judul && 
b.dosenNama === dosenNama
);

if (exists) {
showToast('Bimbingan untuk proposal ini sudah aktif!', 'info');
setActiveMenu('bimbingan');
return;
}

if (confirm(`Mulai bimbingan sebagai Pembimbing ${pembimbingKe} untuk:\n${proposal.mahasiswaNama}\n${proposal.judul}`)) {
const bimbinganData = {
nim: proposal.nim,
mahasiswaNama: proposal.mahasiswaNama,
dosenNama: currentUser.nama,
pembimbingKe: pembimbingKe,
judul: proposal.judul,
prodi: proposal.prodi,
whatsapp: proposal.whatsapp,
progress: 0,
status: 'berlangsung',
catatan: `Dimulai oleh ${currentUser.nama} sebagai Pembimbing ${pembimbingKe} pada ${new Date().toLocaleDateString('id-ID')}`,
lastUpdate: new Date().toISOString().split('T')[0],
proposalId: proposal.id,
createdAt: new Date().toISOString(),
meetings: []
};
const newId = await DB.push('bimbingan', bimbinganData);
if (newId) {
showToast(`‚úÖ Bimbingan (Pembimbing ${pembimbingKe}) berhasil dimulai!\n\nAnda dapat memantau progress melalui menu "Proses Bimbingan".`, 'success');
setActiveMenu('bimbingan');
}
}
};

const handleNavigate = (menu) => {
setActiveMenu(menu);
};

// Expose functions to window for global access
React.useEffect(() => {
window.handleMulaiBimbingan = handleMulaiBimbingan;
window.setActiveMenu = setActiveMenu;
return () => {
delete window.handleMulaiBimbingan;
delete window.setActiveMenu;
};
}, [handleMulaiBimbingan]);

// Render loading state dengan progress
if (!systemReady) {
return (
<div className="loading-screen">
<div className="loading-spinner"></div>
<div className="mt-6 w-64 h-2 bg-gray-700 rounded-full overflow-hidden">
<div 
className="h-full bg-gradient-to-r from-emerald-500 to-teal-500 transition-all duration-300"
style={{ width: `${loadingProgress}%` }}
></div>
</div>
<p className="mt-6 text-xl font-bold text-white">
{initError ? 'Error' : 'Menginisialisasi Sistem Bimbingan Terintegrasi...'}
</p>
<p className="mt-2 text-gray-300">
{initError ? initError : loadingProgress < 100 ? 'Menghubungkan proposal ‚Üí bimbingan ‚Üí repository' : 'Sistem siap...'}
</p>
{initError && (
<button 
onClick={() => window.location.reload()} 
className="mt-6 px-6 py-3 bg-emerald-600 text-white rounded-xl font-semibold hover:bg-emerald-700"
>
üîÑ Muat Ulang
</button>
)}
</div>
);
}
// Render auth modal if not logged in
if (!currentUser) {
return <AuthModal onLogin={handleLogin} onClose={() => {}} />;
}
// Sidebar component
const renderSidebar = () => {
const menus = [
{ id: 'dashboard', label: 'Dashboard', emoji: 'üè†', roles: ['mahasiswa', 'dosen', 'admin', 'operator'] },
{ id: 'proposal', label: 'Pengajuan Proposal', emoji: 'üìù', roles: ['mahasiswa', 'admin', 'operator'] },
{ id: 'bimbingan', label: 'Proses Bimbingan', emoji: 'üìã', roles: ['mahasiswa', 'dosen', 'admin', 'operator'] },
{ id: 'warning', label: 'Early Warning', emoji: '‚ö†Ô∏è', roles: ['mahasiswa', 'dosen', 'admin', 'operator'] },
{ id: 'repository', label: 'Repository Skripsi', emoji: 'üìö', roles: ['mahasiswa', 'dosen', 'admin', 'operator'] },
{ id: 'kelola-mhs', label: 'Kelola Mahasiswa', emoji: 'üë•', roles: ['admin', 'operator'] },
{ id: 'kelola-dsn', label: 'Kelola Dosen', emoji: 'üë®‚Äçüè´', roles: ['admin', 'operator'] },
{ id: 'kelola-op', label: 'Kelola Operator', emoji: 'üë§', roles: ['admin'] }, // Hanya admin yang bisa melihat dan mengelola operator
{ id: 'settings', label: 'Pengaturan', emoji: '‚öôÔ∏è', roles: ['admin', 'operator'] },
];
return (
<>
{sidebarOpen && <div className="fixed inset-0 bg-black/50 z-40 lg:hidden" onClick={() => setSidebarOpen(false)}/>}
<aside className={`fixed top-0 left-0 h-full w-64 bg-gradient-to-b from-emerald-900 to-slate-950 z-50 transform transition-all duration-300 lg:translate-x-0 ${sidebarOpen ? 'translate-x-0' : '-translate-x-full'}`}>
<div className="p-4 border-b border-emerald-700/50">
<div className="flex items-center gap-3">
<Logo size="sm" showText={false}/>
<div>
<h2 className="text-white font-bold text-sm">FEBI UINSI</h2>
<p className="text-emerald-300 text-xs">SAMARINDA</p>
</div>
</div>
</div>
<nav className="p-3 space-y-1 overflow-y-auto h-[calc(100%-180px)]">
{menus.filter(m => m.roles.includes(userRole)).map(m => (
<button key={m.id} onClick={() => { setActiveMenu(m.id); setSidebarOpen(false); }} className={`w-full flex items-center gap-3 px-3 py-2.5 rounded-xl transition-all ${activeMenu === m.id ? 'bg-gradient-to-r from-emerald-600 to-teal-600 text-white shadow-lg' : 'text-emerald-100 hover:bg-emerald-800/50'}`}>
<span className="text-lg">{m.emoji}</span>
<span className="text-sm font-medium">{m.label}</span>
</button>
))}
</nav>
<div className="absolute bottom-0 left-0 right-0 p-3 border-t border-emerald-700/50 bg-emerald-950/50">
<div className="mb-3 px-3 py-2 bg-emerald-800/30 rounded-lg">
<p className="text-white text-sm font-medium truncate">{currentUser?.nama}</p>
<p className="text-xs capitalize text-emerald-300">
{userRole}
</p>
</div>
<button onClick={handleLogout} className="w-full flex items-center gap-3 px-3 py-2.5 rounded-xl text-red-300 hover:bg-red-900/30">
<span>üö™</span>
<span className="text-sm font-medium">Keluar</span>
</button>
</div>
</aside>
</>
);
};
// Header component
const renderHeader = () => (
<header className="bg-white/80 backdrop-blur-md border-b border-emerald-100 px-4 py-3 flex items-center justify-between sticky top-0 z-30">
<div className="flex items-center gap-4">
<button onClick={() => setSidebarOpen(!sidebarOpen)} className="lg:hidden p-2 rounded-xl hover:bg-emerald-50 text-emerald-700 text-xl">‚ò∞</button>
<h1 className="text-lg font-bold text-emerald-900">
{activeMenu === 'dashboard' ? 'Dashboard Utama' :
activeMenu === 'proposal' ? 'Pengajuan Proposal Skripsi' :
activeMenu === 'bimbingan' ? 'Manajemen Bimbingan' :
activeMenu === 'warning' ? 'Sistem Early Warning' :
activeMenu === 'repository' ? 'Repository Skripsi' :
activeMenu === 'kelola-mhs' ? 'Administrasi Mahasiswa' :
activeMenu === 'kelola-dsn' ? 'Administrasi Dosen' :
activeMenu === 'kelola-op' ? 'Administrasi Operator' :
activeMenu === 'settings' ? 'Pengaturan Sistem' : 'Dashboard FEBI'}
</h1>
</div>
<div className="flex items-center gap-3 relative">
<div className="flex items-center gap-2 px-3 py-2 bg-emerald-50 rounded-xl cursor-pointer hover:bg-emerald-100 transition-all" onClick={() => setShowProfileMenu(!showProfileMenu)}>
<div className="w-9 h-9 bg-emerald-600 rounded-full flex items-center justify-center text-white font-bold">
{currentUser?.nama?.charAt(0).toUpperCase()}
</div>
<div className="hidden sm:block">
<p className="text-sm font-medium text-emerald-900">{currentUser?.nama}</p>
<p className="text-xs capitalize text-emerald-700">
{userRole}
</p>
</div>
</div>

{/* Profile Menu Dropdown */}
{showProfileMenu && (
<div className="profile-menu">
<div className="profile-menu-item" onClick={() => { setShowProfileModal(true); setShowProfileMenu(false); }}>
<span className="text-xl">üë§</span>
<div>
<p className="font-medium text-sm">Edit Profil</p>
<p className="text-xs text-gray-500">Perbarui data diri dan password</p>
</div>
</div>
<div className="profile-menu-item" onClick={() => { handleLogout(); setShowProfileMenu(false); }}>
<span className="text-xl">üö™</span>
<div>
<p className="font-medium text-sm">Keluar</p>
<p className="text-xs text-gray-500">Akhiri sesi</p>
</div>
</div>
</div>
)}
</div>
</header>
);
// Content router
const renderContent = () => {
switch(activeMenu) {
case 'dashboard':
return <DashboardPage
mahasiswaArr={mahasiswaArr}
dosenArr={dosenArr}
proposalsArr={proposalsArr}
repositoryArr={repositoryArr}
bimbinganArr={bimbinganArr}
pendingBimbingan={pendingBimbingan}
userRole={userRole}
currentUser={currentUser}
onNavigate={handleNavigate}
kalenderAkademik={kalenderAkademik}
onSaveKalender={handleSaveKalender}
/>;
case 'proposal':
return <ProposalPage
proposals={proposalsArr}
userRole={userRole}
currentUser={currentUser}
onAdd={() => handleAdd('proposals')}
onEdit={(item) => handleEdit('proposals', item)}
onDelete={(id, name) => handleDelete('proposals', id, name)}
dosenList={dosenArr}
mahasiswaList={mahasiswaArr}
onCheckSimilarity={handleCheckSimilarity}
similarityResult={similarityResult}
onMulaiBimbingan={handleMulaiBimbingan}
bimbinganArr={bimbinganArr}
onNavigate={handleNavigate}
/>;
case 'bimbingan':
return <BimbinganPage
bimbingan={bimbinganArr}
userRole={userRole}
currentUser={currentUser}
onAdd={() => handleAdd('bimbingan')}
onEdit={(item) => handleEdit('bimbingan', item)}
onDelete={(id, name) => handleDelete('bimbingan', id, name)}
mahasiswaList={mahasiswaArr}
dosenList={dosenArr}
proposalsList={proposalsArr}
onNavigate={handleNavigate}
onAddMeeting={() => {}} // Akan di-handle di dalam BimbinganPage
onEditMeeting={() => {}}
onDeleteMeeting={() => {}}
/>;
case 'warning':
return <EarlyWarningPage
bimbingan={bimbinganArr}
mahasiswa={mahasiswaArr}
currentUser={currentUser}
userRole={userRole}
onSendWhatsApp={sendWhatsAppWarning}
onNavigate={handleNavigate}
/>;
case 'repository':
return <RepositoryPage
repository={repositoryArr}
userRole={userRole}
onAdd={() => handleAdd('repository')}
onEdit={(item) => handleEdit('repository', item)}
onDelete={(id, name) => handleDelete('repository', id, name)}
uinsiData={uinsiRepository}
onUinsiDataChange={(data) => setUinsiRepository(data)}
/>;
case 'kelola-mhs':
return <KelolaMahasiswaPage
mahasiswa={mahasiswaArr}
userRole={userRole}
onAdd={() => handleAdd('mahasiswa')}
onEdit={(item) => handleEdit('mahasiswa', item)}
onDelete={(id, name) => handleDelete('mahasiswa', id, name)}
/>;
case 'kelola-dsn':
return <KelolaDosenPage
dosen={dosenArr}
userRole={userRole}
onAdd={() => handleAdd('dosen')}
onEdit={(item) => handleEdit('dosen', item)}
onDelete={(id, name) => handleDelete('dosen', id, name)}
/>;
case 'kelola-op':
return <KelolaOperatorPage
operator={operatorArr}
userRole={userRole}
onAdd={() => handleAdd('operator')}
onEdit={(item) => handleEdit('operator', item)}
onDelete={(id, name) => handleDelete('operator', id, name)}
/>;
case 'settings':
return <SettingsPage userRole={userRole} />;
default:
return <DashboardPage
mahasiswaArr={mahasiswaArr}
dosenArr={dosenArr}
proposalsArr={proposalsArr}
repositoryArr={repositoryArr}
bimbinganArr={bimbinganArr}
pendingBimbingan={pendingBimbingan}
userRole={userRole}
currentUser={currentUser}
onNavigate={handleNavigate}
kalenderAkademik={kalenderAkademik}
onSaveKalender={handleSaveKalender}
/>;
}
};
return (
<ErrorBoundary>
<div className="min-h-screen bg-gradient-to-br from-slate-50 via-emerald-50/30 to-teal-50/30">
{renderSidebar()}
<div className="lg:ml-64 flex flex-col min-h-screen">
{renderHeader()}
<main className="flex-1 p-4 md:p-6">
{renderContent()}
</main>
</div>
{showModal && (
<Modal
type={modalType}
item={editingItem}
onSave={handleSave}
onClose={() => { setShowModal(false); setEditingItem(null); setSimilarityResult(null); }}
onCheckSimilarity={modalType === 'proposals' ? handleCheckSimilarity : null}
similarityResult={similarityResult}
dosenList={dosenArr}
mahasiswaList={mahasiswaArr}
currentUser={currentUser}
userRole={userRole}
/>
)}
{showProfileModal && (
<ProfileModal
user={currentUser}
userRole={userRole}
onClose={() => setShowProfileModal(false)}
onSave={handleSaveProfile}
/>
)}
{toast.show && (
<div className={`fixed bottom-6 right-6 px-5 py-3 rounded-xl shadow-2xl z-50 animate-fadeIn flex items-center gap-2 ${
toast.type === 'success' ? 'bg-emerald-500 text-white' : 'bg-red-500 text-white'
}`}>
{toast.type === 'success' ? '‚úÖ' : '‚ùå'}
<span>{toast.msg}</span>
</div>
)}
</div>
</ErrorBoundary>
);
};
// Render application
ReactDOM.render(
<React.StrictMode>
<App />
</React.StrictMode>,
document.getElementById('root')
);
console.log('‚úÖ Dashboard FEBI v8.0.0 (DENGAN PAGINATION 15 BARIS) loaded successfully!');
console.log('üîê Authentication system active');
console.log('üîç ADVANCED SIMILARITY CHECKER (5 Algoritma Hybrid) - OPERATIONAL');
console.log('üìä Cosine ‚Ä¢ Jaccard Bigram/Trigram ‚Ä¢ Levenshtein ‚Ä¢ Semantic Matching');
console.log('üîÑ WORKFLOW INTEGRATION: Auto-create bimbingan untuk Pembimbing 1 & 2');
console.log('‚ö†Ô∏è Early Warning System dengan WhatsApp integration');
console.log('‚úÖ SEMUA MODAL BERFUNGSI: Mahasiswa, Dosen, Proposal, Bimbingan, Repository, Operator');
console.log('üìä BIMBINGAN PAGE: Timeline 10 pertemuan dengan visual progress, dual pembimbing berdampingan');
console.log('‚úÖ EDIT PROFIL: Semua user dapat mengedit profil termasuk password');
console.log('‚úÖ Loading System: Progress bar, error handling, koneksi stabil');
console.log('‚úÖ Data Inisialisasi: Data dummy otomatis terisi jika database kosong');
console.log('‚úÖ Early Warning: Perhitungan semester real-time berdasarkan NIM dan bulan berjalan (Jan-Jun=Genap, Jul-Des=Ganjil)');
console.log('‚úÖ SEMUA PAGE: userRole didefinisikan dengan benar, tidak ada error ReferenceError');
console.log('‚úÖ TANDA TANGAN CETAK: Nama dan NIP/NIM terisi otomatis sesuai data');
console.log('‚úÖ DUAL PEMBIMBING: Pembimbing 2 mendapat hak yang sama, tampilan berdampingan untuk mahasiswa');
console.log('‚úÖ PAGINATION: Semua halaman utama memiliki pagination 15 baris per halaman dengan navigasi Prev/Next');
console.log('‚úÖ REPOSITORY UINSI: Tab Repository UINSI Samarinda terintegrasi (170 seed + live OAI-PMH + Firebase cache)');
console.log('‚úÖ SIMILARITY TERINTEGRASI: Cek similarity kini mencakup Proposal + Repository Lokal + Repository UINSI Samarinda');
console.log('‚úÖ CORS PROXY CASCADE: 8 proxy fallback untuk fetch live dari repository.uinsi.ac.id');
</script>
</body>
</html>
